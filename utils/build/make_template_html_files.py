# Need to generate template.htm.ts files from template.htm. Doing this because
# html-loader gave me problems. Run from the main directory (parent of src).

import subprocess

out = (
    subprocess.check_output('find . -name "*.template.htm"', shell=True)
    .decode("utf-8")
    .strip()
    .split("\n")
)

for flnm in out:
    with open(flnm, "r") as f:
        html = f.readlines()
    html = [l.strip() for l in html]
    html = "\n".join(html)
    while "\n\n" in html:
        html = html.replace("\n\n", "\n")
    html = html.replace("\n", " ")

    html = (
        "// DO NOT EDIT THIS FILE. EDIT "
        + flnm + "\n"
        + "export var templateHtml = `" + html + "`;"
    )

    with open(flnm + ".ts", "w") as f:
        f.write(html)
