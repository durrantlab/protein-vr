/*
 almond 0.3.3 Copyright jQuery Foundation and other contributors.
 Released under MIT license, http://github.com/requirejs/almond/LICENSE
*/
var D="function"==typeof Object.defineProperties?Object.defineProperty:function(A,y,m){A!=Array.prototype&&A!=Object.prototype&&(A[y]=m.value)},E="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function F(A){if(A){for(var y=E,m=["Math","sign"],u=0;u<m.length-1;u++){var a=m[u];a in y||(y[a]={});y=y[a]}m=m[m.length-1];u=y[m];A=A(u);A!=u&&null!=A&&D(y,m,{configurable:!0,writable:!0,value:A})}}
F(function(A){return A?A:function(y){y=Number(y);return 0===y||isNaN(y)?y:0<y?1:-1}});
(function(){var A,y,m;(function(u){function a(a,b){var t,c;b=b&&b.split("/");var e=f.map,h=e&&e["*"]||{};if(a){a=a.split("/");var d=a.length-1;f.$a&&z.test(a[d])&&(a[d]=a[d].replace(z,""));"."===a[0].charAt(0)&&b&&(d=b.slice(0,b.length-1),a=d.concat(a));for(d=0;d<a.length;d++){var B=a[d];"."===B?(a.splice(d,1),--d):".."===B&&0!==d&&(1!==d||".."!==a[2])&&".."!==a[d-1]&&0<d&&(a.splice(d-1,2),d-=2)}a=a.join("/")}if((b||h)&&e){B=a.split("/");for(d=B.length;0<d;--d){var p=B.slice(0,d).join("/");if(b)for(c=
b.length;0<c;--c)if(t=e[b.slice(0,c).join("/")])if(t=t[p]){var n=t;var q=d;break}if(n)break;if(!l&&h&&h[p]){var l=h[p];var k=d}}!n&&l&&(n=l,q=k);n&&(B.splice(0,q,n),a=B.join("/"))}return a}function c(a,b){return function(){var t=w.call(arguments,0);"string"!==typeof t[0]&&1===t.length&&t.push(null);return l.apply(u,t.concat([a,b]))}}function d(t){return function(b){return a(b,t)}}function b(a){return function(t){e[a]=t}}function r(a){if(n.call(h,a)){var t=h[a];delete h[a];v[a]=!0;C.apply(u,t)}if(!n.call(e,
a)&&!n.call(v,a))throw Error("No "+a);return e[a]}function k(a){var b=a?a.indexOf("!"):-1;if(-1<b){var t=a.substring(0,b);a=a.substring(b+1,a.length)}return[t,a]}function x(a){return function(){return f&&f.P&&f.P[a]||{}}}var l,e={},h={},f={},v={},n=Object.prototype.hasOwnProperty,w=[].slice,z=/\.js$/;var q=function(b,c){b=k(b);var e=b[0];c=c[1];b=b[1];if(e){e=a(e,c);var h=r(e)}e?h&&h.normalize?b=h.normalize(b,d(c)):b=a(b,c):(b=a(b,c),b=k(b),e=b[0],b=b[1],e&&(h=r(e)));return{ha:e?e+"!"+b:b,n:b,ab:e,
p:h}};var p={Oa:function(a){return c(a)},H:function(a){var b=e[a];return"undefined"!==typeof b?b:e[a]={}},Ma:function(a){return{id:a,uri:"",H:e[a],P:x(a)}}};var C=function(a,d,l,C){var t,B=[];var f=typeof l;var x=(C=C||a)?k(C):[];if("undefined"===f||"function"===f){d=!d.length&&l.length?["require","exports","module"]:d;for(t=0;t<d.length;t+=1){var z=q(d[t],x);f=z.ha;if("require"===f)B[t]=p.Oa(a);else if("exports"===f){B[t]=p.H(a);var G=!0}else if("module"===f)var w=B[t]=p.Ma(a);else if(n.call(e,f)||
n.call(h,f)||n.call(v,f))B[t]=r(f);else if(z.p)z.p.load(z.n,c(C,!0),b(f),{}),B[t]=e[f];else throw Error(a+" missing "+f);}d=l?l.apply(e[a],B):void 0;a&&(w&&w.H!==u&&w.H!==e[a]?e[a]=w.H:d===u&&G||(e[a]=d))}else a&&(e[a]=l)};A=y=l=function(a,b,d,c,e){if("string"===typeof a)return p[a]?p[a](b):r(q(a,b?k(b):[]).ha);if(!a.splice){f=a;f.Aa&&l(f.Aa,f.Ya);if(!b)return;b.splice?(a=b,b=d,d=null):a=u}b=b||function(){};"function"===typeof d&&(d=c,c=e);c?C(u,a,b,d):setTimeout(function(){C(u,a,b,d)},4);return l};
l.P=function(a){return l(a)};A.g=e;m=function(a,b,d){if("string"!==typeof a)throw Error("See almond README: incorrect module build, no module name");b.splice||(d=b,b=[]);n.call(e,a)||n.call(h,a)||(h[a]=[a,b,d])};m.g={jQuery:!0}})();m("external/almond",function(){});m("Scene/Vars",["require","exports"],function(u,a){Object.defineProperty(a,"__esModule",{value:!0});a.fa=11;a.W=1.5;a.ea=1;a.qa=2E3;a.V=1.2;a.sa=2.5;a.ra=.1;a.ta=.01;a.wa=500;a.va=750;a.L=.1;a.da=15;a.ua=.05;a.pa=/iPad|iPhone|iPod/.test(navigator.userAgent)&&
!window.MSStream;a.c=function(){a.canvas=document.getElementById("renderCanvas");a.s=new BABYLON.Engine(a.canvas,!0);BABYLON.Database.IDBStorageEnabled=!0;a.a=new BABYLON.Scene(a.s);window.scene=a.a};a.Ba=function(){if(void 0===a.O){var c=new BABYLON.Ray(a.a.activeCamera.position,new BABYLON.Vector3(0,-1,0),50);c=a.a.pickWithRay(c,function(a){return"ground"===a.name});a.O=c.distance}};a.Qa=function(c){a.O=c};a.Ta=function(c){var d={createDeviceOrientationCamera:!0};a.a.getEngine().getCaps().multiview&&
(d.useMultiview=!0);a.f=a.a.createDefaultVRExperience(d);document.getElementById("babylonVRiconbtn").style.opacity="0.0";document.getElementById("babylonVRiconbtn").style.filter="alpha(opacity=0)";window.vrHelper=a.f;a.b=c;a.b.ma=!0}});m("Scene/jQuery",["require","exports"],function(u,a){Object.defineProperty(a,"__esModule",{value:!0});a.jQuery=function(a){return new c(a)};var c=function(){function a(a){this.element=void 0;if("string"===typeof a)if("#"===a.charAt(0))this.element=document.getElementById(a.substr(1));
else if("."===a.charAt(0))this.element=document.getElementsByClassName(a.substr(1));else if("body"===a)this.element=document.body;else throw Error("Selector not recognized: "+a);else this.element=a;null===this.element&&console.warn("Selector not found/recognized: "+a)}a.prototype.Ja=function(a){this.element&&this.element.addEventListener("keypress",a)};a.prototype.click=function(a){if(this.element)this.on("click",a)};a.prototype.show=function(){this.element&&(this.element.style.display="inline-block")};
a.prototype.Ia=function(){this.element&&(this.element.style.display="none")};a.prototype.on=function(a,c){this.element&&this.element.addEventListener(a,c)};a.prototype.append=function(a){this.element&&this.element.insertAdjacentHTML("beforeend",a)};a.prototype.focus=function(){this.element&&this.element.focus()};a.prototype.ready=function(a){this.element&&((this.element.attachEvent?"complete"===this.element.readyState:"loading"!==this.element.readyState)?a():this.element.addEventListener("DOMContentLoaded",
a))};return a}();a.Ea=function(a){var b=new XMLHttpRequest;b.open("GET","scene_info.json",!0);b.onload=function(){if(200<=b.status&&400>b.status){var c=JSON.parse(b.responseText);a(c)}};b.onerror=function(){};b.send()};a.Fa=function(a){var b=document.createElement("script"),c=document.getElementsByTagName("script")[0];b.async=!0;b.onload=b.onreadystatechange=function(c,d){if(d||!b.readyState||/loaded|complete/.test(b.readyState))b.onload=b.onreadystatechange=null,b=void 0,d||a&&a()};b.src="js/annyang.min.js";
c.parentNode.insertBefore(b,c)}});m("Scene/VR/NonVRCamera",["require","exports","../Vars"],function(u,a,c){function d(){b.ellipsoid=new BABYLON.Vector3(1,.5*c.O,1)}Object.defineProperty(a,"__esModule",{value:!0});var b;new BABYLON.Vector3(0,0,0);a.c=function(){b=c.a.activeCamera;b.keysUp=[87,38];b.keysDown=[83,40];b.keysLeft=[65,37];b.keysRight=[68,39];d();c.a.collisionsEnabled=!0;b.checkCollisions=!0;b.speed=.1;b.attachControl(c.canvas,!0);b._updatePosition()};a.Pa=d});m("Scene/VR/Optimizations",
["require","exports","../Extras","../Vars"],function(u,a,c,d){function b(a){if(void 0!==a){a=a.getVerticesData(BABYLON.VertexBuffer.PositionKind);if(null===a)return null;a=a.length/3}else a=0;return a}function r(){var a=new BABYLON.SceneOptimizerOptions(25,2E3),b=0;a.optimizations.push(new BABYLON.ShadowsOptimization(b));a.optimizations.push(new BABYLON.LensFlaresOptimization(b));a.optimizations.push(new BABYLON.PostProcessesOptimization(b));a.optimizations.push(new BABYLON.ParticlesOptimization(b));
a.optimizations.push(new k(b));b++;a.optimizations.push(new x(b));a.optimizations.push(new k(b));b++;a.optimizations.push(new BABYLON.TextureOptimization(b,512));a.optimizations.push(new k(b));b++;a.optimizations.push(new BABYLON.RenderTargetsOptimization(b));a.optimizations.push(new BABYLON.TextureOptimization(b,256));a.optimizations.push(new k(b));b++;a.optimizations.push(new BABYLON.HardwareScalingOptimization(b,4));a.optimizations.push(new l(b,500));a.optimizations.push(new k(b));return a}function k(a){var b=
this;"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){console.log("Optimization priority:",b.priority);console.log("FPS:",d.s.getFps());console.log("");return!0};this.getDescription=function(){return"Reports the current priority. For debugging."}}function x(a){"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){var a=d.a.getMeshByName("surfaces.wrl");null!==a&&a.dispose();return!0};this.getDescription=function(){return"Removes surface representations."}}function l(a,
c,l){void 0===l&&(l=void 0);"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){var a=[],h;for(h in d.a.meshes)if(d.a.meshes.hasOwnProperty(h)){var e=d.a.meshes[h];if(-1===e.name.indexOf("Decimated")){var f=b(e);null!==f&&(f<c||a.push([f,e,void 0===l?1-c/f:l]))}}a.sort(function(a,b){return b[0]-a[0]});for(h in a)if(a.hasOwnProperty(h)){e=a[h][1];for(f=a[h][2];0<e.getLODLevels().length;){var q=e.getLODLevels()[0].mesh;e.removeLODLevel(q);null!==q&&q.dispose()}e.simplify([{quality:f,
distance:.001}],!1,BABYLON.SimplificationType.QUADRATIC,function(){})}return!0};this.getDescription=function(){return"Simplifies the geometry of complex objects in the scene."}}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){BABYLON.SceneOptimizer.OptimizeAsync(d.a,r());d.a.autoClear=!1;d.a.autoClearDepthAndStencil=!1;for(var a in d.a.meshes)if(d.a.meshes.hasOwnProperty(a)){var b=d.a.meshes[a];-1!==b.name.indexOf("baked")&&void 0!==b.material&&(b.material.diffuseColor=new BABYLON.Color3(0,
0,0),b.material.specularColor=new BABYLON.Color3(0,0,0),b.material.emissiveTexture=b.material.diffuseTexture,b.material.diffuseTexture=null,b.freezeWorldMatrix())}};a.ba=function(a){var c=b(a);null===c||100>c||(c=1+Math.floor(c/d.qa),1<c&&a.subdivide(c),a.createOrUpdateSubmeshesOctree(64,2),a.useOctreeForCollisions=!0)};a.ia=function(a,b){void 0===b&&(b=!0);b&&a.material.freeze()};a.T=function(){c.o&&(d.a.lights[0].autoUpdateExtends=!0,c.o.getShadowMap().refreshRate=BABYLON.RenderTargetTexture.REFRESHRATE_RENDER_ONCE,
d.a.lights[0].autoUpdateExtends=!1)}});m("Scene/VR/Navigation","require exports ../jQuery ../Vars ./CommonCamera ./NonVRCamera ./Optimizations ./Pickables ./Points".split(" "),function(u,a,c,d,b,r,k,x,l){function e(){z=b.m();d.a.registerBeforeRender(function(){var a=b.m();null===l.Ha(a).pickedMesh?b.oa(z):z=a})}function h(){c.jQuery("body").Ja(function(a){32===a.charCode&&f()})}function f(){var a=(new Date).getTime();if(!(250>a-q))switch(q=a,console.log("hi"),x.Da()){case 2:console.log("teleport");
v();break;case 4:n();break;case 3:x.w.v()}}function v(a,c){void 0===a&&(a=void 0);void 0===c&&(c=void 0);void 0===c&&(c=function(){});d.f.gazeTrackerMesh.isVisible=!1;var e=new BABYLON.Animation("animationCameraTeleportation","position",90,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),h=b.m();void 0===a&&(a=new BABYLON.Vector3(l.i.x,l.i.y+d.O,l.i.z));var p=b.Ga();a=a.subtract(p);h=h.subtract(p);e.setKeys([{frame:0,value:h},{frame:d.fa,value:a}]);var t=d.a.activeCamera;
t.animations=[];t.animations.push(e);d.a.beginAnimation(t,0,d.fa,!1,1,function(){d.f.gazeTrackerMesh.isVisible=!0;t.animations=[];c()})}function n(){var a=l.$,c=b.m(),e=l.i.subtract(c),h=e.length(),p;.1*h<d.ea?p=l.i.subtract(e.normalize().scale(d.ea)):.1*h>d.W?p=l.i.subtract(e.normalize().scale(d.W)):.1*h<d.W&&(p=c.add(e.scale(.9)));p.y=l.i.y;p.y-a.y<.5*d.V+.1&&(p.y=a.y+.5*d.V+.1);d.Qa(l.i.y-a.y);v(p,function(){r.Pa()})}function w(){p=c.jQuery("#capture-clicks");p.click(function(){console.log("clicked!");
f()});d.a.registerBeforeRender(function(){var a=d.a.activeCamera.inputs.attached.deviceOrientation;(a=a?0!==a._alpha||0!==a._beta||0!==a._gamma:!1)&&!C?(C=!0,p.show()):!a&&C&&(C=!1,p.Ia())})}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){d.b.l=d.a.getMeshByID(d.b.ka);null===d.b.l&&alert("No mesh named "+d.b.ka);d.b.l.checkCollisions=!0;d.b.l.visibility=0;k.ba(d.b.l);x.la({M:f,F:d.b.l});d.b.h=3;h();l.c();w();e()};var z,q=0;a.B=f;var p=void 0,C=!1});m("Scene/VR/Pickables","require exports ../Vars ./CommonCamera ./Navigation ./Optimizations".split(" "),
function(u,a,c,d,b,r){function k(a){void 0===a.M&&(a.M=b.B);void 0===a.a&&(a.a=c.a);void 0!==a.F&&(a.F.xa=new BABYLON.ActionManager(a.a),a.F.xa.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){3===c.b.h&&a.M()})))}Object.defineProperty(a,"__esModule",{value:!0});var x=[],l=[],e=[];a.G=function(b){a.w=b};a.c=function(){x.push(c.b.l)};a.ya=function(a){x.push(a);l.push(a);r.ba(a);k({F:a,M:function(){a.v()}})};a.za=function(a){x.push(a);e.push(a);r.ba(a);k({F:a})};
a.ga=function(a){return a.id===c.b.l.id?!0:a.isVisible?-1!==x.indexOf(a):!1};a.Da=function(){return void 0===a.w?1:a.w===c.b.l?2:-1!==l.indexOf(a.w)?3:-1!==e.indexOf(a.w)?4:a.w===a.D?5:1};a.la=k;a.La=function(){a.D=BABYLON.Mesh.CreateSphere("padNavSphereAroundCamera",4,c.da-1,c.a);a.D.flipFaces(!0);var b=new BABYLON.StandardMaterial("padNavSphereAroundCameraMat",c.a);b.diffuseColor=new BABYLON.Color3(1,1,1);b.specularColor=new BABYLON.Color3(0,0,0);b.g=null;a.D.material=b;a.D.visibility=0;c.a.registerBeforeRender(function(){a.D.position=
d.m()});x.push(a.D)}});m("Scene/VR/Points",["require","exports","../Vars","./CommonCamera","./Pickables"],function(u,a,c,d,b){function r(b){a.i.copyFrom(b)}function k(){if(3===c.b.h)var b=c.a.activeCamera.getForwardRay();else if(2===c.b.h||1===c.b.h){b=void 0;1===c.b.h?(b=c.f.rightControllerGazeTrackerMesh,b||(b=c.f.leftControllerGazeTrackerMesh)):2===c.b.h&&(b=c.f.gazeTrackerMesh);if(!b){console.log("error!");return}b.isVisible?r(b.absolutePosition):r(a.J);b=d.m();b=new BABYLON.Ray(b,a.i.subtract(b))}else console.log("Unexpected error.");
x(b)}function x(d,l){void 0===l&&(l=!0);d=c.a.pickWithRay(d,function(a){return b.ga(a)});d.hit&&d.distance<c.da?(l&&r(d.pickedPoint),b.G(d.pickedMesh)):(r(a.J),b.G(void 0))}function l(a){a=new BABYLON.Ray(a,new BABYLON.Vector3(0,-1,0),50);return c.a.pickWithRay(a,function(a){return a.id===c.b.l.id})}Object.defineProperty(a,"__esModule",{value:!0});a.J=new BABYLON.Vector3(-1E3,1E3,1E3);a.Z=new BABYLON.Vector3(0,0,0);a.$=new BABYLON.Vector3(0,0,0);a.i=new BABYLON.Vector3(0,0,0);a.bb=r;a.c=function(){c.a.registerBeforeRender(function(){k();
void 0===a.i?(r(a.J),b.G(void 0)):10<BABYLON.Vector3.Distance(d.m(),a.i)&&(r(a.J),b.G(void 0));c.b.na.position.copyFrom(a.i);void 0!==b.w&&(c.b.na.isVisible=b.w!==b.D);var e=l(d.m()).pickedPoint;e&&(a.Z=e);if(e=l(a.i).pickedPoint)a.$=e})};a.cb=k;a.Ha=l});m("Scene/VR/CommonCamera",["require","exports","../Vars","./Points"],function(u,a,c,d){function b(){if(3===c.b.h)return new BABYLON.Vector3(0,0,0);var a=c.f.webVRCamera,b;a.leftCamera?b=a.leftCamera.globalPosition.subtract(a.position):b=new BABYLON.Vector3(0,
0,0);return b}Object.defineProperty(a,"__esModule",{value:!0});var r=new BABYLON.Vector3(1,0,0),k=new BABYLON.Vector3(1,0,0);a.m=function(){var a=c.a.activeCamera,b=a.position.clone();if(2===c.b.h||1===c.b.h)a.leftCamera?b.copyFrom(a.leftCamera.globalPosition):console.log("Prob here");return b};a.oa=function(a){if(3===c.b.h){var d=c.a.activeCamera;d.position.copyFrom(a)}else if(2===c.b.h||1===c.b.h)d=c.f.webVRCamera,d.position.copyFrom(a.subtract(b()))};a.ja=function(){if(2===c.b.h||1===c.b.h){var a=
d.$.subtract(d.Z),b=BABYLON.Vector3.GetAngleBetweenVectors(a,r,k);for(0>a.z&&(b=-b);0>b;)b+=2*Math.PI;for(;b>2*Math.PI;)b-=2*Math.PI;return b+=.5*Math.PI}return c.a.activeCamera.rotation.clone().y};a.Ga=b});m("Scene/VR/VoiceCommands","require exports ../jQuery ../Vars ./Navigation ./Optimizations".split(" "),function(u,a,c,d,b,r){function k(c){function d(a){function b(a){if(v.hasOwnProperty(a)){var b=v[a];if(""!==b){a=function(a){if(n.hasOwnProperty(a)){var c=n[a];""!==c&&(p[e+" "+b+" "+c]=function(){h([b,
c],f)})}};for(var c in n)a(c)}}}function c(a){if(n.hasOwnProperty(a)){var b=n[a];""!==b&&(p[e+" "+b]=function(){h([b],f)})}}function d(a){if(v.hasOwnProperty(a)){var b=v[a];""!==b&&(p[e+" "+b]=function(){h([b],f)})}}var e=["hide","show","high"][a],f="show"===e,q;for(q in v)d(q);for(var k in n)c(k);for(q in v)b(q);p[e+" surface"]=function(){h(["Surfaces"],f)}}var p={};void 0===a.j&&e(c);for(c=0;3>c;c++)d(c);p.teleport=function(){b.B()};p.click=function(){b.B()};p.move=function(){b.B()};p.look=function(){b.B()};
p.hiya=function(){b.B()};annyang&&(annyang.debug(),annyang.removeCommands(),annyang.addCommands(p),annyang.start());z||(q.speak("The show and hide commands control visualization. For example, show proteen or hide ribbon. The teleport command moves your position to the stair point sphere."),z=!0)}function m(a){return a.charAt(0).toUpperCase()+a.substring(1)}function l(a){a=a.replace(/.sdf/g,"").replace(/.pdb/g,"");a=a.replace(/.wrl/g,"");a=a.replace(/surfaces/g,"Surfaces");var b=a.split("_");a=b[0];
if("Surfaces"===a)return{key:"Surfaces",u:a,A:""};b=b[1].replace(/[A-Z]/g,function(a){return"_"+a}).split(/_/g)[1];a=m(a);b=m(b);return{key:a+"_"+b,u:a,A:b}}function e(b){a.j={};for(var c in b.objIDs)if(b.objIDs.hasOwnProperty(c)){var d=b.objIDs[c],e=l(d);void 0===a.j[e.key]&&(a.j[e.key]={description:e.key.replace(/_/g," "),S:[],u:e.u,A:e.A});a.j[e.key].S.push(d);-1===v.indexOf(e.u)&&v.push(e.u);-1===n.indexOf(e.A)&&n.push(e.A)}}function h(b,c){for(var d in a.j)if(a.j.hasOwnProperty(d)){var e=a.j[d];
a:{var p=void 0;var q=b,n=[e.u,e.A];for(p in q)if(q.hasOwnProperty(p)&&-1===n.indexOf(q[p])){p=!1;break a}p=!0}p&&f(e.u,e.A,c)}}function f(b,c,e){b=m(b);""!==c&&(b+="_"+m(c));for(var p in a.j[b].S)a.j[b].S.hasOwnProperty(p)&&(d.a.getMeshByName(a.j[b].S[p]).isVisible=e);r.T()}Object.defineProperty(a,"__esModule",{value:!0});var v=[],n=[],w=!1,z=!1;a.c=function(a){w?k(a):c.Fa(function(){k(a);w=!0})};a.Ra=e;a.Za=h;a.Ua=f;a.Xa=function(){annyang.abort()};var q=new (function(){function a(){var a=this;
this.U=null;c.jQuery(document).ready(function(){"speechSynthesis"in window&&(a.U=window.speechSynthesis.getVoices(),window.speechSynthesis.onvoiceschanged=function(){a.U=window.speechSynthesis.getVoices()})})}a.prototype.speak=function(a){if(null!==this.U){a=new SpeechSynthesisUtterance(a);a.rate=1;var b=this.U.filter(function(a){return-1<a.name.toUpperCase().indexOf("SAMANTHA")});0<b.length&&(a.voice=b[0]);a.lang="en";a.volume=1;annyang&&annyang.abort();window.speechSynthesis.speak(a);setTimeout(function(){annyang&&
annyang.start()},2E3)}};return a}())});m("Scene/GUI","require exports ./Vars ./VR/CommonCamera ./VR/Pickables ./VR/Points ./VR/VoiceCommands".split(" "),function(m,a,c,d,b,r,k){function u(a){function b(a){if(k.j.hasOwnProperty(a)){var b=k.j[a];a=b.description;h.push(new z({v:function(a){k.Ua(b.u,b.A,!a.value)},default:!1,I:a+"\n(Hide)",aa:function(a){a.isVisible(!1)},name:"menu-visible-button-"+b.u.replace(/ /g,"").replace(/\n/g,""),ca:w,K:a+"\n(Show)"}))}}k.Ra(a);f=new BABYLON.GUI.GUI3DManager(c.a);
w=new BABYLON.GUI.CylinderPanel;f.addControl(w);w.g=!0;for(var d in k.j)b(d);l(w,a);w.g=!1;v=new BABYLON.TransformNode("");w.linkToTransformNode(v);setInterval(function(){w.radius=c.sa;w.margin=c.ra},1E3);window.cylinderPanelMainMenu=w}function l(a,b){h.push(new z({v:function(a){a.value?k.c(b):k.Xa()},default:!1,I:"Audio Commands\n(On)",aa:function(a){a.isVisible(!1)},name:"menu-audio-commands-button",ca:a,K:"Audio Commands\n(Off)"}))}function e(){var a=new BABYLON.GUI.GUI3DManager(c.a),b=new BABYLON.GUI.StackPanel3D;
a.addControl(b);new z({v:function(a){for(var b in h)h.hasOwnProperty(b)&&h[parseInt(b,10)].isVisible(a.value);v.position.copyFrom(d.m());v.rotation.y=d.ja()},default:!1,I:"Show Menu",name:"menu-visible-button",ca:b,K:"Hide Menu"});var e=new BABYLON.TransformNode("");b.linkToTransformNode(e);e.rotation.x=.5*Math.PI;c.a.registerBeforeRender(function(){e.position.copyFrom(r.Z);e.position.y+=.1;e.rotation.y=d.ja()})}Object.defineProperty(a,"__esModule",{value:!0});var h=[],f,v,n,w;a.c=function(a){u(a);
e();n=new BABYLON.Sound("click-button","assets/staple-public-domain.mp3",c.a,null,{loop:!1,autoplay:!1,eb:!0,volume:.1})};var z=function(){function a(a){var d=this;this.button=new BABYLON.GUI.HolographicButton(a.name);a.ca.addControl(this.button);this.C=new BABYLON.GUI.TextBlock;this.C.color="white";this.C.g=!0;this.value=a.default;this.K=a.K;this.I=a.I;this.v=a.v;this.Y();this.g=BABYLON.Mesh.CreateSphere(a.name+"-container-mesh",2,c.V,c.a);this.g.position=this.button.node.absolutePosition;this.g.visibility=
0;this.g.v=function(){d.Ca()};b.ya(this.g);void 0!==a.aa&&a.aa(this)}a.prototype.isVisible=function(a){if(void 0===a)return this.button.isVisible;this.button.isVisible=a;this.g.isVisible=a};a.prototype.Y=function(){this.C.text=this.value?this.K:this.I;this.button.content.dispose();this.button.content=this.C};a.prototype.Ca=function(){n.setPosition(this.g.position.clone());n.play();this.value=!this.value;this.v(this);this.Y()};return a}()});m("Scene/LoadingScreens",["require","exports","./Vars"],function(m,
a,c){function d(){clearInterval(b)}Object.defineProperty(a,"__esModule",{value:!0});var b;a.Na=function(){document.getElementById("loading-container").outerHTML=""};a.X=function(a){d();c.s.displayLoadingUI();c.s.loadingUIText=a};a.Va=function(){var a=90;b=setInterval(function(){a+=.02*(99-a);c.s.displayLoadingUI();c.s.loadingUIText="Loading the main scene... "+a.toFixed(0)+"%"},100)};a.Wa=d});m("Scene/Extras","require exports ./GUI ./jQuery ./Load ./LoadingScreens ./Vars ./VR/Optimizations ./VR/Pickables".split(" "),
function(m,a,c,d,b,r,k,x,l){function e(){var a=k.a.lights[0],b=64,c=.9625,d=a.name.match(/blur_([0-9\.]+)/g);null!==d&&(b=parseFloat(d[0].substr(5)));a=a.name.match(/dark_([0-9\.]+)/g);null!==a&&(c=parseFloat(a[0].substr(5)));return{blur:b,R:c}}function h(){var b=k.a.lights[0],c=e();k.pa?console.log("iOS, so not generating shadows... causes an error... See https://forum.babylonjs.com/t/issues-between-shadowgenerator-and-ios-osx/795"):(a.o=new BABYLON.ShadowGenerator(4096,b),a.o.useBlurExponentialShadowMap=
!0,a.o.setDarkness(c.R),a.o.C=!0,a.o.g=c.blur,window.o=a.o)}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){h();d.Ea(function(d){function h(b){if(d.objIDs.hasOwnProperty(b)){var c=d.objIDs[b];n.addMeshTask(c,"","./",c+".gltf").onSuccess=function(b){for(var n in b.loadedMeshes)if(b.loadedMeshes.hasOwnProperty(n)){var h=parseInt(n,10),f=b.loadedMeshes[h],q=c;if(void 0!==f.material){if("Skip"!==d.shadowQuality){var p=f.material.sideOrientation;f.material.dispose();f.material=null;f.hasVertexAlpha=
!1;f.visibility=!0;var m=new BABYLON.StandardMaterial("molMat"+h.toString(),k.a);m.diffuseColor=new BABYLON.Color3(1,1,1);m.specularColor=new BABYLON.Color3(0,0,0);m.g=null;m.sideOrientation=p;q=new BABYLON.Texture(q+".png",k.a);q.g=-1;m.emissiveTexture=q;m.Y=!0;m.sideOrientation=BABYLON.Material.ClockWiseSideOrientation;m.C=!1;f.material=m}else q=e(),q=.95<q.R?.01:.4>q.R?.0025:.013636363636363637*q.R-.0029545454545454545,f.material.emissiveColor=new BABYLON.Color3(q,q,q);x.ia(f)}f.scaling.z=-1;0<
h&&(f.scaling.x=-1);a.o&&a.o.getShadowMap().renderList.push(f);l.za(f)}}}}BABYLON.OBJFileLoader.OPTIMIZE_WITH_UV=!0;!1===d.menuActive&&(k.b.ma=!1);var n=new BABYLON.AssetsManager(k.a),f;for(f in d.objIDs)h(f);n.onProgress=function(a,b){r.X("Loading molecular meshes... "+a+" of "+b+" remaining.")};n.onFinish=function(){for(var a in k.a.meshes)if(k.a.meshes.hasOwnProperty(a)){var c=k.a.meshes[a];if(-1!==c.name.toLowerCase().indexOf("shadowcatcher")||-1!==c.name.toLowerCase().indexOf("shadow_catcher"))c.material=
new BABYLON.ShadowOnlyMaterial("shadow_catch"+a.toString(),k.a),c.material.activeLight=k.a.lights[0],c.receiveShadows=!0}void 0!==d.transparentGround&&!0===d.transparentGround&&(k.b.l?(k.b.l.visibility=1,a=new BABYLON.StandardMaterial("transparentGround",k.a),a.diffuseColor=new BABYLON.Color3(1,1,1),a.specularColor=new BABYLON.Color3(0,0,0),a.emissiveColor=new BABYLON.Color3(0,0,0),a.alpha=k.ua,k.b.l.material=a):console.log("Warning: Vars.vrVars.groundMesh not defined."));b.Ka()};n.load();k.b.ma&&
c.c(d)})}});m("Scene/VR/UI",["require","exports","../jQuery","../Vars"],function(m,a,c,d){function b(){c.jQuery("body").append('\n        <button\n          title="Click to switch to full screen"\n          id="fullscreen-button"\n          class="ui-button"\n          style="color:white;\n                 width:80px;\n                 right:20px;\n                 position:absolute;\n                 height:50px;\n                 bottom:80px;\n                 background-color:rgba(51,51,51,0.7);\n                 border:none;\n                 outline:none;\n                 cursor:pointer;">\n            <svg\n              style="position:relative; left:0.5px;"\n              width="48" height="48"\n              xmlns="http://www.w3.org/2000/svg"\n              xmlns:svg="http://www.w3.org/2000/svg"\n              clip-rule="evenodd">\n                <g class="layer">\n                    <path d="m47.799999,43.649999l-47.699999,0l0,-39.749999l47.699999,0l0,39.749999zm-1.9875,-37.762499l-43.724999,0l0,35.774999l43.724999,0l0,-35.774999zm-7.95,13.9125l-1.9875,0l0,-6.441487l-22.341487,22.341487l6.441487,0l0,1.9875l-9.9375,0l0,-9.9375l1.9875,0l0,6.441487l22.341487,-22.341487l-6.441487,0l0,-1.9875l9.9375,0l0,9.9375z" fill="#ffffff" id="svg_1"/>\n                </g>\n            </svg>\n        </button>\n\n        <button\n          title="Click for help"\n          id="help-button"\n          class="ui-button"\n          style="color:white;\n                 width:80px;\n                 right:20px;\n                 position:absolute;\n                 height:50px;\n                 bottom:140px;\n                 background-color:rgba(51,51,51,0.7);\n                 border:none;\n                 outline:none;\n                 cursor:pointer;">\n                 <svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n<path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="\n\tM35.5,9.8c1.7,5.4-0.6,8-1.6,8.9c-1.9,1.9-4.5,4.7-5.8,7c-1.5,2.7-4.1,12-6.8,4.4c-3.2-9.1,1.3-11.6,3.5-13.4\n\tc1.5-1.3,3.4-4.3,0.5-5.3c-4-1.3-6.1,5.3-10.7,4c-3-0.8-3.2-4.1-2.2-6.6C15.4,1.7,32.5,0.6,35.5,9.8L35.5,9.8z"/>\n<path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" d="M28.3,39.6c0-5.5-8.5-5.5-8.5,0S28.3,45.1,28.3,39.6\n\t"/>\n</svg>\n\n        </button>\n    ');
c.jQuery("#fullscreen-button").click(function(){d.s.switchFullscreen(!0);c.jQuery("#renderCanvas").focus()});c.jQuery("#help-button").click(function(){window.open("help/index.html","_blank")});document.getElementById("babylonVRiconbtn").style.opacity="1.0";document.getElementById("babylonVRiconbtn").style.filter="alpha(opacity=1.0)"}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){b()};window.debugMode=function(){d.a.debugLayer.show();setTimeout(function(){document.getElementById("inspector-host").style.zIndex=
"15";document.getElementById("scene-explorer-host").style.zIndex="15"},500)}});m("Scene/VR/General",["require","exports","./Navigation","./Pickables","./UI"],function(m,a,c,d,b){Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){c.c();d.c();b.c()}});m("Scene/VR/VRControllers","require exports ../Vars ./CommonCamera ./Navigation ./Pickables ./Points ./VRCamera".split(" "),function(m,a,c,d,b,r,k,x){function l(a){a.onTriggerStateChangedObservable.add(function(a){a.pressed&&(a=(new Date).getTime(),
a-h>c.wa&&(h=a,b.B()))})}function e(a){a.onPadStateChangedObservable.add(function(a){(w=a.pressed)&&Math.abs(v)<c.L&&Math.abs(n)<c.L&&console.log("Would reset camera view if you didn't get an error below...")});a.onPadValuesChangedObservable.add(function(a){v=a.y;n=a.x;Math.abs(n)<c.L&&Math.abs(v)<c.L?n=v=0:.5>Math.abs(n)?n=0:(n+=0<n?-.5:.5,n=2*n)});c.a.registerBeforeRender(function(){if(w){if(!k.i.equals(k.J)){var a=d.m(),b=k.i.subtract(a);b.normalize();b=b.scale(v*c.ta*c.a.getAnimationRatio());
d.oa(a.subtract(b))}0!==n&&(a=(new Date).getTime(),a-f<c.va||(f=a,a=c.f.webVRCamera.rotationQuaternion.toEulerAngles(),a.y+=.25*Math.sign(n)*Math.PI,c.f.webVRCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(a)))}})}Object.defineProperty(a,"__esModule",{value:!0});var h=0,f=0,v=0,n=0,w=!1;a.c=function(){r.La();c.f.webVRCamera.onControllerMeshLoadedObservable.add(function(a){c.b.h=1;console.log("controller loaded");x.Sa();console.log("Isnt there on pickable or something");l(a);e(a)})}});
m("Scene/VR/VRCamera","require exports ../Vars ./Optimizations ./Pickables ./VRControllers".split(" "),function(m,a,c,d,b,r){function k(){c.f.onEnteringVRObservable.add(function(){c.b.h=2;l();b.G(void 0);d.T();window.vrHelper=c.f});c.f.onExitingVRObservable.add(function(){c.b.h=3;b.G(void 0);d.T()})}function u(){var a=new BABYLON.Mesh("vrNavTargetMesh",c.a),b=new BABYLON.VertexData;b.C=[0,0,0];b.g=[0];b.applyToMesh(a);a.isVisible=!1;return a}function l(){c.f.raySelectionPredicate=function(a){return b.ga(a)};
c.f.gazeTrackerMesh=u();c.f.updateGazeTrackerScale=!1;c.f.displayGaze=!0;c.f.enableInteractions()}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){k();r.c()};a.Sa=l});m("Scene/VR/Load",["require","exports","../Vars","./Optimizations","./VRCamera"],function(m,a,c,d,b){Object.defineProperty(a,"__esModule",{value:!0});a.c=function(a){c.Ta(a);b.c();d.c();window.g=c}});m("Scene/Load","require exports ./Extras ./LoadingScreens ./Vars ./VR/General ./VR/Load ./VR/NonVRCamera ./VR/Optimizations ./VR/Pickables".split(" "),
function(m,a,c,d,b,r,k,x,l,e){function h(a){d.X("Loading the main scene...");BABYLON.SceneLoader.LoadAssetContainer("scene/","scene.babylon",b.a,function(c){d.Va();b.a.executeWhenReady(function(){c.addAllToScene();b.a.activeCamera=b.a.cameras[0];for(var d=!1,f=0;1<b.a.lights.length;){var k=b.a.lights[f].name.toLowerCase();-1===k.indexOf("shadowlight")&&-1===k.indexOf("shadow_light")?b.a.lights[f].dispose():d?b.a.lights[f].dispose():(d=!0,f++)}for(var h in b.a.meshes)"protein_box"===b.a.meshes[h].name&&
b.a.meshes[h].dispose();for(h in b.a.meshes)if(b.a.meshes[h].material){d=b.a.meshes[h];if(void 0===d.material.emissiveTexture||null===d.material.emissiveTexture)d.material.emissiveTexture=d.material.diffuseTexture,d.material.diffuseColor=new BABYLON.Color3(0,0,0),d.material.specularColor=new BABYLON.Color3(0,0,0),d.material.emissiveColor=new BABYLON.Color3(0,0,0);l.ia(d,!1);e.la({F:d,a:b.a})}a()})},function(a){a.lengthComputable&&d.X("Loading the main scene... "+Math.round(90*a.loaded/a.total).toString()+
"%")})}Object.defineProperty(a,"__esModule",{value:!0});a.load=function(){b.c();d.Na();var e=BABYLON.Mesh.CreateSphere("navTargetMesh",4,.1,b.a),l=new BABYLON.StandardMaterial("myMaterial",b.a);l.diffuseColor=new BABYLON.Color3(1,0,1);e.material=l;k.c({ka:"ground",na:e});h(function(){a.N=b.a.cameras.filter(function(a){return-1===a.name.indexOf("VR")})[0];var d=new BABYLON.DeviceOrientationCamera("DevOr_camera",a.N.position.clone(),b.a,!0);d.rotation=a.N.rotation;window.cameraFromBabylonFile=a.N;window.DevOrCamera=
d;b.a.activeCamera=d;b.a.activeCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(a.N.rotation);b.Ba();x.c();r.c();c.c()});window.addEventListener("resize",function(){b.s.resize()})};a.Ka=function(){setTimeout(l.T,1E3);d.Wa();b.a.activeCamera.maxZ=250;b.a.activeCamera.minZ=0;b.s.runRenderLoop(function(){b.a.render()})}});m("Game",["require","exports","./Scene/Load"],function(m,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.start=function(){c.load()}});y.P({urlArgs:"bust="+(new Date).getTime()});
y(["Game"],function(m){m.start("renderCanvas")});m("Start",function(){})})();
