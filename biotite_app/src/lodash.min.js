/*
 almond 0.3.3 Copyright jQuery Foundation and other contributors.
 Released under MIT license, http://github.com/requirejs/almond/LICENSE
*/
var E="function"==typeof Object.defineProperties?Object.defineProperty:function(A,y,t){A!=Array.prototype&&A!=Object.prototype&&(A[y]=t.value)},F="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function G(A,y){if(y){var t=F;A=A.split(".");for(var p=0;p<A.length-1;p++){var a=A[p];a in t||(t[a]={});t=t[a]}A=A[A.length-1];p=t[A];y=y(p);y!=p&&null!=y&&E(t,A,{configurable:!0,writable:!0,value:y})}}
G("Math.sign",function(A){return A?A:function(y){y=Number(y);return 0===y||isNaN(y)?y:0<y?1:-1}});G("Array.prototype.find",function(A){return A?A:function(y,t){a:{var p=this;p instanceof String&&(p=String(p));for(var a=p.length,g=0;g<a;g++){var e=p[g];if(y.call(t,e,g,p)){y=e;break a}}y=void 0}return y}});
(function(){var A,y,t;(function(p){function a(a,v){var l,h;v=v&&v.split("/");var d=c.map,k=d&&d["*"]||{};if(a){a=a.split("/");var b=a.length-1;c.Cb&&z.test(a[b])&&(a[b]=a[b].replace(z,""));"."===a[0].charAt(0)&&v&&(b=v.slice(0,v.length-1),a=b.concat(a));for(b=0;b<a.length;b++){var e=a[b];"."===e?(a.splice(b,1),--b):".."===e&&0!==b&&(1!==b||".."!==a[2])&&".."!==a[b-1]&&0<b&&(a.splice(b-1,2),b-=2)}a=a.join("/")}if((v||k)&&d){e=a.split("/");for(b=e.length;0<b;--b){var n=e.slice(0,b).join("/");if(v)for(h=
v.length;0<h;--h)if(l=d[v.slice(0,h).join("/")])if(l=l[n]){var m=l;var f=b;break}if(m)break;if(!r&&k&&k[n]){var r=k[n];var C=b}}!m&&r&&(m=r,f=C);m&&(e.splice(0,f,m),a=e.join("/"))}return a}function g(a,h){return function(){var l=B.call(arguments,0);"string"!==typeof l[0]&&1===l.length&&l.push(null);return m.apply(p,l.concat([a,h]))}}function e(l){return function(h){return a(h,l)}}function f(a){return function(l){d[a]=l}}function b(a){if(r.call(h,a)){var l=h[a];delete h[a];k[a]=!0;x.apply(p,l)}if(!r.call(d,
a)&&!r.call(k,a))throw Error("No "+a);return d[a]}function q(a){var l=a?a.indexOf("!"):-1;if(-1<l){var h=a.substring(0,l);a=a.substring(l+1,a.length)}return[h,a]}function n(a){return function(){return c&&c.V&&c.V[a]||{}}}var m,d={},h={},c={},k={},r=Object.prototype.hasOwnProperty,B=[].slice,z=/\.js$/;var C=function(l,h){l=q(l);var c=l[0];h=h[1];l=l[1];if(c){c=a(c,h);var v=b(c)}c?v&&v.normalize?l=v.normalize(l,e(h)):l=a(l,h):(l=a(l,h),l=q(l),c=l[0],l=l[1],c&&(v=b(c)));return{sa:c?c+"!"+l:l,n:l,Db:c,
p:v}};var w={require:function(a){return g(a)},K:function(a){var l=d[a];return"undefined"!==typeof l?l:d[a]={}},fb:function(a){return{id:a,uri:"",K:d[a],V:n(a)}}};var x=function(a,c,e,n){var l,v=[];var m=typeof e;var z=(n=n||a)?q(n):[];if("undefined"===m||"function"===m){c=!c.length&&e.length?["require","exports","module"]:c;for(l=0;l<c.length;l+=1){var x=C(c[l],z);m=x.sa;if("require"===m)v[l]=w.require(a);else if("exports"===m){v[l]=w.K(a);var D=!0}else if("module"===m)var B=v[l]=w.fb(a);else if(r.call(d,
m)||r.call(h,m)||r.call(k,m))v[l]=b(m);else if(x.p)x.p.load(x.n,g(n,!0),f(m),{}),v[l]=d[m];else throw Error(a+" missing "+m);}c=e?e.apply(d[a],v):void 0;a&&(B&&B.K!==p&&B.K!==d[a]?d[a]=B.K:c===p&&D||(d[a]=c))}else a&&(d[a]=e)};A=y=m=function(a,h,d,e,k){if("string"===typeof a)return w[a]?w[a](h):b(C(a,h?q(h):[]).sa);if(!a.splice){c=a;c.Ta&&m(c.Ta,c.zb);if(!h)return;h.splice?(a=h,h=d,d=null):a=p}h=h||function(){};"function"===typeof d&&(d=e,e=k);e?x(p,a,h,d):setTimeout(function(){x(p,a,h,d)},4);return m};
m.V=function(a){return m(a)};A.j=d;t=function(a,c,b){if("string"!==typeof a)throw Error("See almond README: incorrect module build, no module name");c.splice||(b=c,c=[]);r.call(d,a)||r.call(h,a)||(h[a]=[a,c,b])};t.j={jQuery:!0}})();t("external/almond",function(){});t("Vars",["require","exports"],function(p,a){Object.defineProperty(a,"__esModule",{value:!0});a.na=11;a.ba=1.5;a.ma=1;a.Ga=2E3;a.aa=1.2;a.Ia=2.5;a.Ha=.05;a.Ja=.01;a.Ma=500;a.La=750;a.R=.1;a.la=15;a.Ka=.05;a.Fa=/iPad|iPhone|iPod/.test(navigator.userAgent)&&
!window.MSStream;a.c=function(){a.canvas=document.getElementById("renderCanvas");a.o=new BABYLON.Engine(a.canvas,!0);BABYLON.Database.IDBStorageEnabled=!0;a.a=new BABYLON.Scene(a.o);window.scene=a.a};a.Ua=function(){if(void 0===a.T){var g=new BABYLON.Ray(a.a.activeCamera.position,new BABYLON.Vector3(0,-1,0),50);g=a.a.pickWithRay(g,function(a){return"ground"===a.name});a.T=g.distance}};a.lb=function(g){a.T=g};a.tb=function(g){var e={createDeviceOrientationCamera:!0};a.a.getEngine().getCaps().multiview&&
(e.useMultiview=!0);a.g=a.a.createDefaultVRExperience(e);document.getElementById("babylonVRiconbtn").style.opacity="0.0";document.getElementById("babylonVRiconbtn").style.filter="alpha(opacity=0)";window.vrHelper=a.g;a.b=g;a.b.Aa=!0}});t("Cameras/NonVRCamera",["require","exports","../Vars"],function(p,a,g){function e(){f.ellipsoid=new BABYLON.Vector3(1,.5*g.T,1)}Object.defineProperty(a,"__esModule",{value:!0});var f;new BABYLON.Vector3(0,0,0);a.c=function(){f=g.a.activeCamera;f.keysUp=[87,38];f.keysDown=
[83,40];f.keysLeft=[65,37];f.keysRight=[68,39];g.a.gravity=new BABYLON.Vector3(0,-.1,0);f.applyGravity=!0;e();g.a.collisionsEnabled=!0;f.checkCollisions=!0;f.speed=.1;f.attachControl(g.canvas,!0);f._updatePosition()};a.kb=e});t("Cameras/Setup",["require","exports","../Vars","./NonVRCamera"],function(p,a,g,e){Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){a.ca=g.a.cameras.filter(function(a){return-1===a.name.indexOf("VR")})[0];var f=new BABYLON.DeviceOrientationCamera("DevOr_camera",
a.ca.position.clone(),g.a,!0);f.rotation=a.ca.rotation;g.a.activeCamera=f;g.a.activeCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(a.ca.rotation);g.Ua();e.c()}});t("Navigation/Points",["require","exports","../Cameras/CommonCamera","../Vars","./Pickables"],function(p,a,g,e,f){function b(b){a.i.copyFrom(b)}function q(){if(3===e.b.h)var d=e.a.activeCamera.getForwardRay();else if(2===e.b.h||1===e.b.h){d=void 0;1===e.b.h?(d=e.g.rightControllerGazeTrackerMesh,d||(d=e.g.leftControllerGazeTrackerMesh)):
2===e.b.h&&(d=e.g.gazeTrackerMesh);if(!d){console.log("error!");return}d.isVisible?b(d.absolutePosition):b(a.M);d=g.s();d=new BABYLON.Ray(d,a.i.subtract(d))}else console.log("Unexpected error.");n(d)}function n(d,h){void 0===h&&(h=!0);d=e.a.pickWithRay(d,function(a){return f.ra(a)});d.hit&&d.distance<e.la?(h&&b(d.pickedPoint),f.J(d.pickedMesh)):(b(a.M),f.J(void 0))}function m(a){a=new BABYLON.Ray(a,new BABYLON.Vector3(0,-1,0),50);return e.a.pickWithRay(a,function(a){return a.id===e.b.m.id})}Object.defineProperty(a,
"__esModule",{value:!0});a.M=new BABYLON.Vector3(-1E3,1E3,1E3);a.X=new BABYLON.Vector3(0,0,0);a.fa=new BABYLON.Vector3(0,0,0);a.i=new BABYLON.Vector3(0,0,0);a.Fb=b;a.c=function(){e.a.registerBeforeRender(function(){q();void 0===a.i?(b(a.M),f.J(void 0)):10<BABYLON.Vector3.Distance(g.s(),a.i)&&(b(a.M),f.J(void 0));e.b.Ba.position.copyFrom(a.i);void 0!==f.B&&(e.b.Ba.isVisible=f.B!==f.F);var d=m(g.s()).pickedPoint;d&&(a.X=d);if(d=m(a.i).pickedPoint)a.fa=d})};a.Gb=q;a.Za=m});t("Cameras/CommonCamera",["require",
"exports","../Navigation/Points","../Vars"],function(p,a,g,e){function f(){if(3===e.b.h)return new BABYLON.Vector3(0,0,0);var a=e.g.webVRCamera,b;a.leftCamera?b=a.leftCamera.globalPosition.subtract(a.position):b=new BABYLON.Vector3(0,0,0);return b}Object.defineProperty(a,"__esModule",{value:!0});var b=new BABYLON.Vector3(1,0,0),q=new BABYLON.Vector3(1,0,0);a.s=function(){var a=e.a.activeCamera,b=a.position.clone();if(2===e.b.h||1===e.b.h)a.leftCamera?b.copyFrom(a.leftCamera.globalPosition):console.log("Prob here");
return b};a.Ea=function(a){if(3===e.b.h){var b=e.a.activeCamera;b.position.copyFrom(a)}else if(2===e.b.h||1===e.b.h)b=e.g.webVRCamera,b.position.copyFrom(a.subtract(f()))};a.ea=function(){if(2===e.b.h||1===e.b.h){var a=g.fa.subtract(g.X),m=BABYLON.Vector3.GetAngleBetweenVectors(a,b,q);for(0>a.z&&(m=-m);0>m;)m+=2*Math.PI;for(;m>2*Math.PI;)m-=2*Math.PI;return m+=.5*Math.PI}return e.a.activeCamera.rotation.clone().y};a.Ya=f});t("Mols/Shadows",["require","exports","../Vars"],function(p,a,g){function e(){var a=
g.a.lights[0],b=64,e=.9625,n=a.name.match(/blur_([0-9\.]+)/g);null!==n&&(b=parseFloat(n[0].substr(5)));a=a.name.match(/dark_([0-9\.]+)/g);null!==a&&(e=parseFloat(a[0].substr(5)));return{blur:b,W:e}}Object.defineProperty(a,"__esModule",{value:!0});a.rb=function(){var f=g.a.lights[0],b=e();b.yb=0;b.blur=2;g.Fa?console.log("iOS, so not generating shadows... causes an error... See https://forum.babylonjs.com/t/issues-between-shadowgenerator-and-ios-osx/795"):(a.u=new BABYLON.ShadowGenerator(4096,f),a.u.useBlurExponentialShadowMap=
!0,a.u.setDarkness(b.W),a.u.D=!0,a.u.j=b.blur,window.u=a.u)};a.Wa=e;a.qb=function(){for(var a in g.a.meshes)if(g.a.meshes.hasOwnProperty(a)){var b=g.a.meshes[a];if(-1!==b.name.toLowerCase().indexOf("shadowcatcher")||-1!==b.name.toLowerCase().indexOf("shadow_catcher"))b.material=new BABYLON.ShadowOnlyMaterial("shadow_catch"+a.toString(),g.a),b.material.activeLight=g.a.lights[0],b.receiveShadows=!0}}});t("Scene/Optimizations",["require","exports","../Mols/Shadows","../Vars"],function(p,a,g,e){function f(a){if(void 0!==
a){a=a.getVerticesData(BABYLON.VertexBuffer.PositionKind);if(null===a)return null;a=a.length/3}else a=0;return a}function b(){var a=new BABYLON.SceneOptimizerOptions(25,2E3),c=0;a.optimizations.push(new BABYLON.ShadowsOptimization(c));a.optimizations.push(new BABYLON.LensFlaresOptimization(c));a.optimizations.push(new BABYLON.PostProcessesOptimization(c));a.optimizations.push(new BABYLON.ParticlesOptimization(c));a.optimizations.push(new n(c));c++;a.optimizations.push(new m(c));a.optimizations.push(new n(c));
c++;a.optimizations.push(new BABYLON.TextureOptimization(c,512));a.optimizations.push(new n(c));c++;a.optimizations.push(new BABYLON.RenderTargetsOptimization(c));a.optimizations.push(new BABYLON.TextureOptimization(c,256));a.optimizations.push(new n(c));c++;a.optimizations.push(new BABYLON.HardwareScalingOptimization(c,4));a.optimizations.push(new d(c,500));a.optimizations.push(new n(c));return a}function q(a){null!==a&&a.dispose()}function n(a){var c=this;"undefined"===typeof a&&(a=0);this.priority=
a;this.apply=function(){console.log("Optimization priority:",c.priority);console.log("FPS:",e.o.getFps());console.log("");return!0};this.getDescription=function(){return"Reports the current priority. For debugging."}}function m(a){"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){var a=e.a.getMeshByName("surfaces.wrl");q(a);return!0};this.getDescription=function(){return"Removes surface representations."}}function d(a,c,b){void 0===b&&(b=void 0);"undefined"===typeof a&&(a=0);this.priority=
a;this.apply=function(){var a=[],h;for(h in e.a.meshes)if(e.a.meshes.hasOwnProperty(h)){var d=e.a.meshes[h];if(-1===d.name.indexOf("Decimated")){var k=f(d);null!==k&&(k<c||a.push([k,d,void 0===b?1-c/k:b]))}}a.sort(function(a,c){return c[0]-a[0]});for(h=0;h<a.length;h++){k=a[h];d=k[1];for(k=k[2];0<d.getLODLevels().length;){var m=d.getLODLevels()[0].mesh;d.removeLODLevel(m);q(m)}d.simplify([{quality:k,distance:.001}],!1,BABYLON.SimplificationType.QUADRATIC,function(){})}return!0};this.getDescription=
function(){return"Simplifies the geometry of complex objects in the scene."}}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){BABYLON.SceneOptimizer.OptimizeAsync(e.a,b());e.a.autoClear=!1;e.a.autoClearDepthAndStencil=!1;for(var a in e.a.meshes)if(e.a.meshes.hasOwnProperty(a)){var c=e.a.meshes[a];-1!==c.name.indexOf("baked")&&void 0!==c.material&&(c.material.diffuseColor=new BABYLON.Color3(0,0,0),c.material.specularColor=new BABYLON.Color3(0,0,0),c.material.emissiveTexture=c.material.diffuseTexture,
c.material.diffuseTexture=null,c.freezeWorldMatrix())}};a.ga=function(a){var c=f(a);null===c||100>c||(c=1+Math.floor(c/e.Ga),1<c&&a.subdivide(c))};a.ta=function(a,c){void 0===c&&(c=!0);c&&a.material.freeze()};a.P=function(){g.u&&(e.a.lights[0].autoUpdateExtends=!0,g.u.getShadowMap().refreshRate=BABYLON.RenderTargetTexture.REFRESHRATE_RENDER_ONCE,e.a.lights[0].autoUpdateExtends=!1)};a.ib=q});t("Navigation/Navigation","require exports ../Cameras/CommonCamera ../Cameras/NonVRCamera ../Scene/Optimizations ../Vars ./Pickables ./Points".split(" "),
function(p,a,g,e,f,b,q,n){function m(){B=g.s();b.a.registerBeforeRender(function(){var a=g.s();null===n.Za(a).pickedMesh?g.Ea(B):B=a})}function d(){jQuery("body").keypress(function(a){32===a.charCode&&h()})}function h(){var a=(new Date).getTime();if(!(250>a-z))switch(z=a,q.Xa()){case 2:console.log("teleport");c();break;case 4:k();break;case 3:q.B.v()}}function c(a,c){void 0===a&&(a=void 0);void 0===c&&(c=void 0);void 0===c&&(c=function(){});b.g.gazeTrackerMesh.isVisible=!1;var l=new BABYLON.Animation("animationCameraTeleportation",
"position",90,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),d=g.s();void 0===a&&(a=new BABYLON.Vector3(n.i.x,n.i.y+b.T,n.i.z));var h=g.Ya();a=a.subtract(h);d=d.subtract(h);l.setKeys([{frame:0,value:d},{frame:b.na,value:a}]);var k=b.a.activeCamera;k.animations=[];k.animations.push(l);b.a.beginAnimation(k,0,b.na,!1,1,function(){b.g.gazeTrackerMesh.isVisible=!0;k.animations=[];c()})}function k(){var a=n.fa,l=g.s(),d=n.i.subtract(l),h=d.length(),k;.1*h<b.ma?k=n.i.subtract(d.normalize().scale(b.ma)):
.1*h>b.ba?k=n.i.subtract(d.normalize().scale(b.ba)):.1*h<b.ba&&(k=l.add(d.scale(.9)));k.y=n.i.y;k.y-a.y<.5*b.aa+.1&&(k.y=a.y+.5*b.aa+.1);b.lb(n.i.y-a.y);c(k,function(){e.kb()})}function r(){C=jQuery("#capture-clicks");C.click(function(){console.log("clicked!");h()});b.a.registerBeforeRender(function(){var a=b.a.activeCamera.inputs.attached.deviceOrientation;(a=a?0!==a._alpha||0!==a._beta||0!==a._gamma:!1)&&!w?(w=!0,C.show()):!a&&w&&(w=!1,C.Ab())})}Object.defineProperty(a,"__esModule",{value:!0});
a.c=function(){b.b.m=b.a.getMeshByID(b.b.va);null===b.b.m&&alert("No mesh named "+b.b.va);b.b.m.checkCollisions=!0;b.b.m.visibility=0;f.ga(b.b.m);q.za({S:h,mesh:b.b.m});b.b.h=3;d();n.c();r();m()};var B,z=0;a.oa=h;var C=void 0,w=!1});t("Navigation/Pickables","require exports ../Cameras/CommonCamera ../Scene/Optimizations ../Vars ./Navigation".split(" "),function(p,a,g,e,f,b){function q(a){void 0===a.S&&(a.S=b.oa);void 0===a.a&&(a.a=f.a);void 0!==a.mesh&&(a.mesh.actionManager=new BABYLON.ActionManager(a.a),
a.mesh.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){3===f.b.h&&a.S()})))}Object.defineProperty(a,"__esModule",{value:!0});var n=[],m=[],d=[];a.J=function(b){a.B=b};a.c=function(){n.push(f.b.m)};a.Na=function(a){n.push(a);m.push(a);e.ga(a);q({mesh:a,S:function(){a.v()}})};a.Oa=function(a){n.push(a);d.push(a);e.ga(a);q({mesh:a})};a.ra=function(a){return a.id===f.b.m.id?!0:a.isVisible?-1!==n.indexOf(a):!1};a.Xa=function(){return void 0===a.B?
1:a.B===f.b.m?2:-1!==m.indexOf(a.B)?3:-1!==d.indexOf(a.B)?4:a.B===a.F?5:1};a.za=q;a.eb=function(){a.F=BABYLON.Mesh.CreateSphere("padNavSphereAroundCamera",4,f.la-1,f.a);a.F.flipFaces(!0);var b=new BABYLON.StandardMaterial("padNavSphereAroundCameraMat",f.a);b.diffuseColor=new BABYLON.Color3(1,1,1);b.specularColor=new BABYLON.Color3(0,0,0);b.j=null;a.F.material=b;a.F.visibility=0;f.a.registerBeforeRender(function(){a.F.position=g.s()});n.push(a.F)}});t("Cameras/VRControllers","require exports ../Navigation/Navigation ../Navigation/Pickables ../Navigation/Points ../Vars ./CommonCamera ./VRCamera".split(" "),
function(p,a,g,e,f,b,q,n){function m(a){a.onTriggerStateChangedObservable.add(function(a){a.pressed&&(a=(new Date).getTime(),a-h>b.Ma&&(h=a,g.oa()))})}function d(a){a.onPadStateChangedObservable.add(function(a){(B=a.pressed)&&Math.abs(k)<b.R&&Math.abs(r)<b.R&&console.log("Would reset camera view if you didn't get an error below...")});a.onPadValuesChangedObservable.add(function(a){k=a.y;r=a.x;Math.abs(r)<b.R&&Math.abs(k)<b.R?r=k=0:.5>Math.abs(r)?r=0:(r+=0<r?-.5:.5,r=2*r)});b.a.registerBeforeRender(function(){if(B){if(!f.i.equals(f.M)){var a=
q.s(),d=f.i.subtract(a);d.normalize();d=d.scale(k*b.Ja*b.a.getAnimationRatio());q.Ea(a.subtract(d))}0!==r&&(a=(new Date).getTime(),a-c<b.La||(c=a,a=b.g.webVRCamera.rotationQuaternion.toEulerAngles(),a.y+=.25*Math.sign(r)*Math.PI,b.g.webVRCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(a)))}})}Object.defineProperty(a,"__esModule",{value:!0});var h=0,c=0,k=0,r=0,B=!1;a.c=function(){e.eb();b.g.webVRCamera.onControllerMeshLoadedObservable.add(function(a){b.b.h=1;console.log("controller loaded");
n.ob();console.log("Isnt there on pickable or something");m(a);d(a)})}});t("Cameras/VRCamera","require exports ../Navigation/Pickables ../Scene/Optimizations ../Vars ./VRControllers".split(" "),function(p,a,g,e,f,b){function q(){f.g.onEnteringVRObservable.add(function(){f.b.h=2;m();g.J(void 0);e.P();window.vrHelper=f.g});f.g.onExitingVRObservable.add(function(){f.b.h=3;g.J(void 0);e.P()})}function n(){var a=new BABYLON.Mesh("vrNavTargetMesh",f.a),b=new BABYLON.VertexData;b.D=[0,0,0];b.j=[0];b.applyToMesh(a);
a.isVisible=!1;return a}function m(){f.g.raySelectionPredicate=function(a){return g.ra(a)};f.g.gazeTrackerMesh=n();f.g.updateGazeTrackerScale=!1;f.g.displayGaze=!0;f.g.enableInteractions()}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){q();b.c()};a.ob=m});t("UI/Menu3D/Button",["require","exports","../../Navigation/Pickables","../../Vars","./Menu3D"],function(p,a,g,e,f){Object.defineProperty(a,"__esModule",{value:!0});var b=new BABYLON.Vector3(.75,.75,.75);p=function(){function a(a){var m=
this;this.button=new BABYLON.GUI.HolographicButton(a.name);a.Da.addControl(this.button);this.$a();void 0!==a.color&&this.O(a.color);this.level=a.level;this.D=new BABYLON.GUI.TextBlock;this.D.color="white";this.D.j=!0;this.value=a.default;this.N=a.N;this.L=a.L;this.v=a.v;this.ja();this.button.scaling=b.clone();this.j=BABYLON.Mesh.CreateSphere(a.name+"-container-mesh",2,e.aa,e.a);this.j.position=this.button.node.absolutePosition;this.j.visibility=0;this.j.scaling=b.clone();this.j.v=function(){m.G()};
g.Na(this.j);void 0!==a.ya&&a.ya(this)}a.prototype.O=function(a){switch(a){case "default":this.button.mesh.material=this.qa;break;case void 0:this.button.mesh.material=this.qa;break;case "green":this.button.mesh.material=this.ua;break;case "yellow":this.button.mesh.material=this.xa;break;case "red":this.button.mesh.material=this.wa}};a.prototype.isVisible=function(a){if(void 0===a)return this.button.isVisible;this.button.isVisible=a;this.j.isVisible=a};a.prototype.G=function(){f.U.setPosition(this.j.position.clone());
f.U.play();this.value=!this.value;this.v(this);this.ja()};a.prototype.ja=function(a){void 0===a?this.D.text=this.value?this.N:this.L:this.L=this.N=this.D.text=a;this.button.content.dispose();this.button.content=this.D};a.prototype.$a=function(){this.qa=this.button.mesh.material;this.ua=this.button.mesh.material.clone();this.ua.albedoColor=new BABYLON.Color3(.3,.35+.1,.4);this.xa=this.button.mesh.material.clone();this.xa.albedoColor=new BABYLON.Color3(.4,.35+.1,.4);this.wa=this.button.mesh.material.clone();
this.wa.albedoColor=new BABYLON.Color3(.4,.35,.4)};return a}();a.ka=p});t("UI/OpenPopup",["require","exports"],function(p,a){function g(a,e){jQuery.prototype.modal=f;var b=jQuery("#myModal");b.find("h4.modal-title").html(a);b.find("iframe").attr("src",e);b.modal()}Object.defineProperty(a,"__esModule",{value:!0});var e=!1,f;a.Ca=function(a,q){e?g(a,q):(e=!0,document.head.insertAdjacentHTML("beforeend","<link rel=stylesheet href=help/css/bootstrap.min.css>"),document.body.insertAdjacentHTML("beforeend",
'\n            \x3c!-- The Modal --\x3e\n            <div class="modal fade" id="myModal" role="dialog">\n                <div class="modal-dialog" role="document">\n                    <div class="modal-content">\n\n                    \x3c!-- Modal Header --\x3e\n                    <div class="modal-header">\n                        <h4 class="modal-title">Modal Heading</h4>\n                        <button type="button" class="close" data-dismiss="modal">&times;</button>\n                    </div>\n\n                    \x3c!-- Modal body --\x3e\n                    <div class="modal-body">\n                        <div class="embed-responsive embed-responsive-1by1">\n                            <iframe class="embed-responsive-item" src=""></iframe>\n                        </div>\n                    </div>\n\n                    \x3c!-- Modal footer --\x3e\n                    \x3c!-- <div class="modal-footer">\n                        <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>\n                    </div> --\x3e\n                </div>\n            </div>\n        '),
jQuery.getScript("help/scripts/bootstrap.min.js",function(){f=jQuery.prototype.modal;g(a,q)}))}});t("Mols/CommonLoader","require exports ../Navigation/Pickables ../Scene/LoadAndSetup ../Scene/Optimizations ../Vars ./Shadows".split(" "),function(p,a,g,e,f,b,q){Object.defineProperty(a,"__esModule",{value:!0});a.Qa=function(){q.rb();BABYLON.OBJFileLoader.OPTIMIZE_WITH_UV=!0};a.Pa=function(a){q.qb();void 0!==a.transparentGround&&!0===a.transparentGround&&(b.b.m?(b.b.m.visibility=1,a=new BABYLON.StandardMaterial("transparentGround",
b.a),a.diffuseColor=new BABYLON.Color3(1,1,1),a.specularColor=new BABYLON.Color3(0,0,0),a.emissiveColor=new BABYLON.Color3(0,0,0),a.alpha=b.Ka,b.b.m.material=a):console.log("Warning: Vars.vrVars.groundMesh not defined."));e.cb()};a.pb=function(a){if(void 0!==a.material&&null!==a.material){var b=q.Wa();b=.95<b.W?.05:.4>b.W?.0025:.013636363636363637*b.W-.0029545454545454545;a.material.emissiveColor=new BABYLON.Color3(b,b,b);f.ta(a)}a.scaling.z=-1;a.scaling.x=-1;q.u&&q.u.getShadowMap().renderList.push(a);
g.Oa(a)}});t("Mols/3DMol/VRMLParserWebWorker",["require","exports"],function(p,a){function g(a,r){void 0===r&&(r=!1);var k=[],z=0;for(a=a.split("geometry IndexedFaceSet {").splice(1);z<a.length;z++){var g=a[z];var w=q("point [","]",g).match(d);for(var x=w.length,l=new Float32Array(x),v=0;v<x;v+=3)l[v]=+w[v+2],l[v+1]=+w[v+1],l[v+2]=+w[v];w=l;r&&(w=e(w));k.push({colors:f(q("color [","]",g)),coors:w,trisIdxs:b(q("coordIndex [","]",g))})}void 0===h&&(h=n(k));r=h;z=k.length;for(a=0;a<z;a++)for(g=k[a].coors.length,
w=0;w<g;w+=3)k[a].coors[w]-=r[0],k[a].coors[w+1]-=r[1],k[a].coors[w+2]-=r[2];if(c){m=[];r=["colors","coors","trisIdxs"];for(var D in k)if(k.hasOwnProperty(D))for(z=0,a=r;z<a.length;z++){g=a[z];w=0;x=k[+D][g];l=[];v=0;for(var p=x.length;v<p;)l.push(x.slice(v,v+=1E7));for(x=l;w<x.length;w++)m.push([+D,g,x[w]])}return[]}return k}function e(a){console.log("Removing extra points.");for(var b=a[0],c=a[1],d=a[2],e=a.length,k=0;k<e;k+=3){var m=k+1,l=k+2;0===a[k]&&0===a[m]&&0===a[l]&&(a[k]=b,a[m]=c,a[l]=d)}return a}
function f(a){a=a.match(d);for(var b=new Float32Array(4*a.length/3),c=b.length,e=0;e<c;e+=4){var k=3*e/4;b[e]=+a[k];b[e+1]=+a[k+1];b[e+2]=+a[k+2];b[e+3]=1}return b}function b(a){a=a.match(d);for(var b=3*a.length/4,c=new Uint32Array(b),e=0;e<b;e+=3){var k=4*e/3;c[e]=+a[k];c[e+1]=+a[k+1];c[e+2]=+a[k+2]}return c}function q(a,b,c){a=c.split(a,2);if(1>=a.length)return"";a=a[1].split(b,2);return a[0]}function n(a){if(0===a.length)return new Float32Array([0,0,0]);var b=a.map(function(a){return a.coors.length}).reduce(function(a,
b){return a+b});if(0===b)return new Float32Array([0,0,0]);for(var c=0,e=0,d=0,k=a.length,m=0;m<k;m++)for(var l=a[m].coors,v=l.length,h=0;h<v;h+=3)c+=l[h],e+=l[h+1],d+=l[h+2];a=b/3;return new Float32Array([c/a,e/a,d/a])}Object.defineProperty(a,"__esModule",{value:!0});var m=void 0,d=/(^|-| )[0-9.]{1,8}/g,h=void 0,c=!1;"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&(c=!0);c&&(self.onmessage=function(a){var b=a.data.cmd,c=a.data.data;a=a.data.removeExtraPts;"start"===b&&(g(c,
a),b="sendDataChunk");"sendDataChunk"===b&&(b=m.shift(),c=0===m.length?"done":"more",void 0===b&&(c="done"),postMessage({chunk:b,status:c}))});a.bb=g;a.Eb=e});t("Mols/3DMol/VRML","require exports ../../UrlVars ../../Vars ../CommonLoader ./PositionInScene ./VRMLParserWebWorker".split(" "),function(p,a,g,e,f,b,q){function n(b){var c=jQuery("#mol-container");c&&c.remove();jQuery("body").append('<div\n        id="mol-container"\n        class="mol-container"\n        style="display:none;"></div>');k=
jQuery("#mol-container");r={backgroundColor:"white"};a.A=$3Dmol.createViewer(k,r);window.viewer=a.A;b()}function m(b){B=a.A.exportVRML();b()}function d(a,b){c=[];"undefined"!==typeof Worker?("undefined"===typeof z&&(z=new Worker("VRMLParserWebWorker.js")),z.onmessage=function(a){a=a.data;var e=a.chunk;a=a.status;if(void 0!==e){var d=e[0],l=e[1],m=e[2];c.length===d&&c.push({coors:new Float32Array(0),colors:new Float32Array(0),trisIdxs:new Uint32Array(0)});e=c[d];d=[c[d][l],m];for(var h=0,k=0;k<d.length;k++)m=
d[k],h+=m.length;h=new ("trisIdxs"===l?Uint32Array:Float32Array)(h);for(var v=k=0;v<d.length;v++)m=d[v],h.set(m,k),k+=m.length;e[l]=h}switch(a){case "more":z.postMessage({cmd:"sendDataChunk",data:void 0});break;case "done":b();break;default:console.log("Error here!")}},z.postMessage({cmd:"start",data:B,removeExtraPts:"Stick"===a})):(c=q.bb(B),b())}function h(){var a=[],b;for(b in c)if(c.hasOwnProperty(b)){var d=c[b],m=[];BABYLON.VertexData.ComputeNormals(d.coors,d.trisIdxs,m);var k=new BABYLON.VertexData;
k.positions=d.coors;k.indices=d.trisIdxs;k.normals=m;k.colors=d.colors;d=new BABYLON.Mesh("mesh_3dmol_tmp"+b,e.a);k.applyToMesh(d);k=new BABYLON.StandardMaterial("Material",e.a);k.diffuseColor=new BABYLON.Color3(1,1,1);k.emissiveColor=new BABYLON.Color3(0,0,0);k.specularColor=new BABYLON.Color3(0,0,0);d.material=k;a.push(d)}if(0<a.length){var h=BABYLON.Mesh.MergeMeshes(a,!0,!0);h.name="MeshFrom3DMol"+Math.random().toString();h.id=h.name;f.pb(h)}return h}Object.defineProperty(a,"__esModule",{value:!0});
var c=[];a.w=new BABYLON.Vector3(0,0,0);var k,r,B,z,C="",w="pdb",x=!1;a.c=n;a.jb=function(){x&&(x=!1,a.A=null,n(function(){a.A.addModel(C,"pdb")}));a.A.setStyle({},{})};a.ab=function(b,c){jQuery.ajax(b,{success:function(d){C=d;w="pdb";"sdf"===b.slice(b.length-3).toLowerCase()&&(w="sdf");d=a.A.addModel(d,w);c(d)},error:function(a,c,d){console.error("Failed to load molecule "+b+": "+d)}})};a.setStyle=function(b,c){a.A.setStyle(b,c);a.A.render()};a.addSurface=function(b,c,d){x=!0;a.A.addSurface($3Dmol.SurfaceType.MS,
b,c,void 0,void 0,function(){d()})};a.render=function(a,k,g){void 0===g&&(g=function(){});e.o.hideLoadingUI();a&&m(function(){d(k,function(){var a=h();void 0!==a&&(b.I(a,e.a.getMeshByName("protein_box")),g(a));c=[]})})};a.Bb=h;a.ia=function(b,c){a.w[b]+=c;g.ha()};a.nb=function(b,c,d){a.w=new BABYLON.Vector3(b,c,d)}});t("UrlVars",["require","exports","./Mols/3DMol/ThreeDMol","./Mols/3DMol/Visualize","./Mols/3DMol/VRML"],function(p,a,g,e,f){function b(a){a=a.split("--");var b=decodeURIComponent(a[a.length-
2]),e=decodeURIComponent(a[a.length-1]);return[a.slice(0,a.length-2).map(function(a){a=decodeURIComponent(a);"{"===a.charAt(0)&&(a=JSON.parse(a));return a}),b,e]}function q(){if(0<n.length){var a=n.pop();e.$(a[0],a[1],a[2],function(){q()})}}Object.defineProperty(a,"__esModule",{value:!0});var n=[];a.ha=function(){var a=[],b=f.w.x;0!==b&&a.push("x="+(Math.round(1E5*b)/1E5).toString());b=f.w.y;0!==b&&a.push("y="+(Math.round(1E5*b)/1E5).toString());b=f.w.z;0!==b&&a.push("z="+(Math.round(1E5*b)/1E5).toString());
a.push("src="+g.Z);b=0;var h=[],c;for(c in e.f)e.f.hasOwnProperty(c)&&e.f[c].mesh.isVisible&&(h.push("style"+b.toString()+"="+c),b++);a=a.concat(h);window.history.pushState({},document.title,window.location.href.split("?")[0]+"?"+a.join("&"))};a.gb=function(){var a=window.location.href,d=a?a.split("?")[1]:window.location.search.slice(1);a={};if(d){d=d.split("#")[0];var e=0;for(d=d.split("&");e<d.length;e++){var c=d[e].split("=");a[c[0]]=void 0===c[1]?!0:c[1]}}a.x=void 0===a.x?0:+a.x;a.y=void 0===
a.y?0:+a.y;a.z=void 0===a.z?0:+a.z;f.nb(a.x,a.y,a.z);e=a.src;void 0!==e&&(4===e.length&&-1===e.indexOf(".")&&(e="https://files.rcsb.org/view/"+e.toUpperCase()+".pdb"),g.mb(e));for(var k in a)a.hasOwnProperty(k)&&"style"===k.slice(0,5)&&(e=b(a[k]),n.push(e));0===n.length&&(n.push([["Protein","All"],"Cartoon","Spectrum"]),n.push([["Ligand","All"],"Stick","Element"]))};a.Va=b;a.vb=q});t("Mols/3DMol/ThreeDMol","require exports ../../UI/Menu3D/Menu3D ../../UI/OpenPopup ../../UrlVars ../CommonLoader ./VRML".split(" "),
function(p,a,g,e,f,b,q){function n(d){q.c(function(){f.gb();q.ab(a.Z,function(h){f.ha();m(h);g.c();f.vb();b.Pa(d);"nanokid.sdf"===a.Z&&setTimeout(function(){e.Ca("Load Molecule","help/load.html")},3E3)})})}function m(b){b=b.selectedAtoms({});a.l={"Atom Name":[],Chain:[],Element:[],"Residue Index":[],"Residue Name":[],"Secondary Structure":[]};for(var e=b.length,c=0;c<e;c++){var d=b[c];a.l["Atom Name"].push(d.atom);a.l.Chain.push(d.chain);a.l.Element.push(d.elem);a.l["Residue Name"].push(d.resn);a.l["Residue Index"].push(d.resi);
a.l["Secondary Structure"].push(d.ss)}for(var g in a.l)if(a.l.hasOwnProperty(g)){b=a.l;e=g;c=a.l[g];d={};for(var f=[],m=0,n=c.length;m<n;++m)d.hasOwnProperty(c[m])||(f.push(c[m]),d[c[m]]=1);b[e]=f}}Object.defineProperty(a,"__esModule",{value:!0});a.l={};a.Z="nanokid.sdf";a.mb=function(b){a.Z=b};a.c=function(a){try{jQuery.getScript("https://3Dmol.csb.pitt.edu/build/3Dmol.js",function(){n(a)})}catch(h){n(a)}}});t("UI/Menu3D/Styles","require exports ../../Mols/3DMol/ThreeDMol ../../Mols/3DMol/Visualize ../../UrlVars ./Menu3D".split(" "),
function(p,a,g,e,f,b){function q(a,b){if(2>b)return[a];var c=a.length,e=[],d=0,k;if(0===c%b)for(k=Math.floor(c/b);d<c;)e.push(a.slice(d,d+=k));else for(;d<c;)k=Math.ceil((c-d)/b--),e.push(a.slice(d,d+=k));return e}function n(a,e,d){function g(e){function l(c){a[e].Colors[c]=function(){d(e,c);b.C.G()}}function g(c){a[e]["Color Schemes"][c]=function(){d(e,c);b.C.G()}}a[e]={Colors:{},"Color Schemes":{}};for(var h=0,f=k;h<f.length;h++)g(f[h]);h=0;for(f=c;h<f.length;h++)l(f[h]);a[e].Hide=function(){d(e,
"Hide");b.C.G()}}var f=0;for(e=void 0===h[e]?h.Protein:h[e];f<e.length;f++)g(e[f]);return a}Object.defineProperty(a,"__esModule",{value:!0});var m=["Protein","Ligand","Water","Nucleic"],d={Ligand:["All"],Nucleic:["All"],Protein:["All","Hydrophobic","Hydrophilic","Charged","Aromatic"],Water:["All"]};p=["Stick","Sphere","Surface"];var h={Ligand:p,Nucleic:p,Protein:["Cartoon"].concat(p),Water:p},c="White Red Blue Green Orange Yellow Purple".split(" "),k=["Element","Amino Acid","Chain","Nucleic","Spectrum"];
a.Sa=function(){function a(b,c,d){function k(d){if(1===d.length){var l=d[0];c[l]={};c[l]=n(c[l],b,function(a,c){var d={};d[x[b]]=l;e.$([d],a,c)})}else{var k="["+d[0].toString()+"-"+d[d.length-1].toString()+"]";c[k]={};a(b,c[k],d)}}d.sort(function(a,b){a=isNaN(+a)?a:+a;b=isNaN(+b)?b:+b;return a<b?-1:a>b?1:0});var l=0;for(d=q(d,14);l<d.length;l++)k(d[l])}function c(a){function b(b){k.Components[a][b]=n({},a,function(c,d){e.$([a,b],c,d)})}k.Components[a]={};for(var c=0,l=d[a];c<l.length;c++)b(l[c])}
for(var k={Components:{},Selections:{},Clear:function(){for(var a in e.f)e.f.hasOwnProperty(a)&&(e.f[a].mesh.isVisible=!1);b.C.G()},"Remove Existing":{}},h=0;h<m.length;h++){var f=m[h];c(f)}var x={"Atom Name":"atom",Chain:"chain",Element:"elem","Residue Index":"resi","Residue Name":"resn","Secondary Structure":"ss"};for(f in g.l)g.l.hasOwnProperty(f)&&(h=g.l[f],k.Selections[f]={},a(f,k.Selections[f],h));return k};a.xb=function(a){function c(c){if(e.f.hasOwnProperty(c)&&!0===e.f[c].mesh.isVisible){var d=
c.replace(/--/g," ");d=d.replace(/{/g,"").replace(/}/g,"").replace(/"/g,"");a.Styles["Remove Existing"][d]=function(){b.C.G();setTimeout(function(){var a=f.Va(c);e.$(a[0],a[1],"Hide")},0)}}}a.Styles["Remove Existing"]={};b.sb(a.Styles["Remove Existing"],["Styles","Remove Existing"]);for(var d in e.f)c(d)}});t("Mols/3DMol/Visualize","require exports ../../Scene/Optimizations ../../UI/Menu3D/Menu3D ../../UI/Menu3D/Styles ../../UrlVars ../../Vars ./PositionInScene ./VRML".split(" "),function(p,a,g,e,
f,b,q,n,m){function d(b,c,d){m.render(!0,c,function(e){for(var l in a.f)if(a.f.hasOwnProperty(l)){var h=a.f[l];h.H===b.H&&(g.ib(h.mesh),delete a.f[l],console.log("deleting old mesh..."))}"Surface"===c&&(e.material.backFaceCulling=!1);a.f[b.da]={H:b.H,mesh:e};k();d();console.log("added new mesh")})}function h(a,b,c){a.sort();a=a.map(function(a){return"string"===typeof a?a:JSON.stringify(a)});return{H:a.join("--")+"--"+b,da:a.join("--")+"--"+b+"--"+c}}function c(a){for(var b=a.map(function(a){return a}),
c=0;c<a.length;c++){var d=a[c];b.push(d.toUpperCase());b.push(d.toLowerCase())}return b=b.filter(function(a,c){return b.indexOf(a)>=c})}function k(){b.ha();f.xb(e.Y)}Object.defineProperty(a,"__esModule",{value:!0});a.f={};var r={All:{},Protein:{resn:c("ALA ARG ASP ASN ASX CYS GLN GLU GLX GLY HIS HSP HYP ILE LEU LYS MET PCA PHE PRO TRP TYR VAL GLU SER THR MSE".split(" "))},Acidic:{resn:c(["ASP","GLU"])},Cyclic:{resn:c(["HIS","PHE","PRO","TRP","TYR"])},Aliphatic:{resn:c(["ALA","GLY","ILE","LEU","VAL"])},
Aromatic:{resn:c(["HIS","PHE","TRP","TYR"])},Basic:{resn:c(["ARG","HIS","LYS","HSP"])},Charged:{resn:c("ASP GLU ARG HIS LYS HSP".split(" "))},Hydrophobic:{resn:c("ALA LEU VAL ILE PRO PHE MET TRP".split(" "))},Neutral:{resn:c("VAL PHE GLN TYR HIS CYS MET TRP ASX GLX PCA HYP".split(" "))},Nucleic:{resn:c("ADE A GUA G CYT C THY T URA U".split(" "))},Purine:{resn:c(["ADE","A","GUA","G"])},Pyrimidine:{resn:c("CYT C THY T URA U".split(" "))},Ions:{resn:c("AL BA CA CAL CD CES CLA CL CO CS CU CU1 CUA HG IN IOD K MG MN3 MO3 MO4 MO5 MO6 NA NAW OC7 PB POT PT RB SOD TB TL WO4 YB ZN ZN1 ZN2".split(" "))},
Water:{resn:c(["WAT","HOH","TIP","TIP3"])}};r.Ligand={not:{or:[r.Protein,r.Nucleic,r.Ions,r.Water]}};var B={"Amino Acid":{colorscheme:"amino"},Blue:{color:"blue"},Chain:{colorscheme:"chain"},Element:{colorscheme:"default"},Green:{color:"green"},Nucleic:{colorscheme:"nucleic"},Orange:{color:"orange"},Purple:{color:"purple"},Red:{color:"red"},Spectrum:{color:"spectrum"},White:{color:"white"},Yellow:{color:"yellow"}};a.$=function(b,c,e,f){void 0===f&&(f=void 0);var l=h(b,c,e);void 0===f&&(f=function(){});
if("Hide"===e){for(var g in a.f)a.f.hasOwnProperty(g)&&(b=a.f[g],b.H===l.H&&(b.mesh.isVisible=!1,console.log("Hiding existing mesh...")));n.I(void 0,q.a.getMeshByName("protein_box"));k()}else void 0!==a.f[l.da]?(a.f[l.da].mesh.isVisible=!0,console.log("showing existing mesh..."),n.I(void 0,q.a.getMeshByName("protein_box")),k()):(m.jb(),g=B[e],b={and:b.map(function(a){return void 0!==r[a]?r[a]:a})},"surface"===c.toLowerCase()?m.addSurface(g,b,function(){d(l,c,f)}):(e={},e[c.toLowerCase()]=g,m.setStyle(b,
e),d(l,c,f)))}});t("Mols/3DMol/PositionInScene","require exports ../../Scene/Optimizations ../../Vars ./Visualize ./VRML".split(" "),function(p,a,g,e,f,b){function q(a){var b=[],d;for(d in f.f)if(f.f.hasOwnProperty(d)){var e=f.f[d].mesh;!0===e.isVisible&&b.push(e)}void 0!==a&&b.push(a);return b}function n(a){for(var c=0;c<a.length;c++){var d=a[c];d.animations=[];!0===d.isVisible&&(d.scaling=new BABYLON.Vector3(1,1,1),d.position=new BABYLON.Vector3(0,0,0),d.rotation=b.w,d.visibility=0)}}function m(a,
b,d,e){a=new BABYLON.Animation(a,b,60,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);a.setKeys([{frame:0,value:d},{frame:15,value:e}]);return a}Object.defineProperty(a,"__esModule",{value:!0});var d=void 0;a.I=function(a,c){var f=q(a);void 0===d&&(d=b.w.clone());a=f.map(function(a){return{mesh:a,position:a.position.clone(),rotation:d.clone(),scaling:a.scaling.clone()}});d=b.w.clone();if(0!==f.length){n(f);e.a.render();for(var h=c.getBoundingInfo().boundingBox,p=Object.keys(h.maximumWorld).map(function(a){return h.maximumWorld[a]-
h.minimumWorld[a]}),z=0,t,w,x=function(a){var b=a.getBoundingInfo().boundingBox;a=Object.keys(b.maximumWorld).map(function(a){return b.maximumWorld[a]-b.minimumWorld[a]});var c=a[0]*a[1]*a[2];c>z&&(z=c,t=b,w=a)},l=0;l<f.length;l++)c=f[l],x(c);c=p.map(function(a,b){return a/w[b]});c=Math.min.apply(null,c);p=new BABYLON.Vector3(c,c,c);for(x=0;x<f.length;x++)c=f[x],c.scaling=p;e.a.render();p=t.centerWorld.subtract(h.centerWorld);for(x=0;x<f.length;x++)c=f[x],c.position=c.position.subtract(p);p=.5*(h.maximumWorld.y-
h.minimumWorld.y-(t.maximumWorld.y-t.minimumWorld.y));for(x=0;x<f.length;x++)c=f[x],c.position.y=c.position.y-p,c.visibility=1;for(f=0;f<a.length;f++){l=a[f];c=l.mesh;var v=c.position.clone(),D=c.scaling.clone(),y=c.rotation.clone();p=m("posX","position.x",l.position.x,v.x);x=m("posY","position.y",l.position.y,v.y);v=m("posZ","position.z",l.position.z,v.z);var A=m("scaX","scaling.x",l.scaling.x,D.x),H=m("scaY","scaling.y",l.scaling.y,D.y);D=m("scaZ","scaling.z",l.scaling.z,D.z);var I=m("rotX","rotation.x",
l.rotation.x,y.x),J=m("rotY","rotation.y",l.rotation.y,y.y);l=m("rotZ","rotation.z",l.rotation.z,y.z);c.animations=[p,x,v,A,H,D,I,J,l];e.a.beginAnimation(c,0,15,!1,1,function(){g.P()})}}}});t("UI/Menu3D/Rotations",["require","exports","../../Mols/3DMol/PositionInScene","../../Mols/3DMol/VRML","../../Vars"],function(p,a,g,e,f){Object.defineProperty(a,"__esModule",{value:!0});a.Ra=function(){var a=15*Math.PI/180;return{"X Axis":function(){e.ia("x",a);g.I(void 0,f.a.getMeshByName("protein_box"))},"Y Axis":function(){e.ia("y",
a);g.I(void 0,f.a.getMeshByName("protein_box"))},"Z Axis":function(){e.ia("z",a);g.I(void 0,f.a.getMeshByName("protein_box"))}}}});t("UI/Menu3D/Menu3D","require exports ../../Cameras/CommonCamera ../../Navigation/Points ../../Vars ./Button ./Rotations ./Styles".split(" "),function(p,a,g,e,f,b,q,n){function m(){function a(a){a=a.toString();t.push(new b.ka({v:function(){},default:!1,L:a,ya:function(a){a.isVisible(!1)},level:1,name:"menu-visible-button-"+a,Da:c,N:a,color:"yellow"}))}var c=new BABYLON.GUI.SpherePanel;
c.radius=f.Ia;c.margin=f.Ha;z.addControl(c);c.blockLayout=!0;for(var d=0;16>d;d++)a(d);c.columns=4;c.linkToTransformNode(y);c.blockLayout=!1}function d(b){function c(a,d){b(a,d);for(var e=0,f=Object.keys(a);e<f.length;e++){var l=f[e],g=a[l];switch(typeof g){case "object":c(g,d.concat([l]))}}}c(a.Y,[])}function h(){d(function(a,b){c(a,b)})}function c(b,c){0<c.length&&(b["Back \u21e6"]=function(){r(c.slice(0,c.length-1))});b["Close Menu \u00d7"]=function(){a.C.G()}}function k(){var c=new BABYLON.GUI.StackPanel3D;
z.addControl(c);a.C=new b.ka({v:function(a){a.value?r([]):r(void 0);y.position.copyFrom(g.s());y.rotation.y=g.ea()},default:!1,L:"Show Menu",level:0,name:"menu-visible-button",Da:c,N:"Hide Menu"});window.openMainMenuFloorButton=a.C;var d=new BABYLON.TransformNode("");c.linkToTransformNode(d);d.rotation.x=.5*Math.PI;d.position.copyFrom(e.X);d.position.y+=.1;d.rotation.y=g.ea();f.a.registerBeforeRender(function(){d.position.copyFrom(e.X);d.position.y+=.1;d.rotation.y=g.ea()})}function r(b){void 0!==
b&&0<b.length&&(w=b);for(var c=0,d=t;c<d.length;c++)d[c].isVisible(!1);if(void 0!==b){var e=a.Y;for(c=0;c<b.length;c++)e=e[b[c]];var f=Object.keys(e),g=["Close Menu \u00d7"],h=["Back \u21e6"],l=g.concat(h);f.sort(function(a,b){var c=-1!==l.indexOf(a),d=-1!==l.indexOf(b);return c&&!d?1:!c&&d?-1:a.localeCompare(b)});var k=[];k=4>=f.length?[7,6,5,4]:8>=f.length?[7,6,5,4,11,10,9,8]:12>=f.length?[3,2,1,0,7,6,5,4,11,10,9,8]:[3,2,1,0,7,6,5,4,11,10,9,8,15,14,13,12];c=function(a){var c=f[a],d=e[c];a=t[k[a]];
a.ja(c);switch(typeof d){case "object":a.v=function(){r(b.concat(c))};a.O("green");break;case "function":a.v=d,a.O("default")}-1!==g.indexOf(c)?a.O("red"):-1!==h.indexOf(c)&&a.O("yellow");a.isVisible(!0)};for(d=0;d<f.length;d++)c(d)}}Object.defineProperty(a,"__esModule",{value:!0});a.U=void 0;var t,z,y,w,x;a.c=function(b){t=[];w=[];a.Y={Styles:n.Sa(),Rotate:q.Ra(),Last:function(){console.log("Going to",w);r(w)}};void 0!==b?x=b:b=x;void 0===z&&(z=new BABYLON.GUI.GUI3DManager(f.a));h(a.Y);y=new BABYLON.TransformNode("");
m();void 0===a.C&&k();void 0===a.U&&(a.U=new BABYLON.Sound("click-button","assets/staple-public-domain.mp3",f.a,null,{loop:!1,autoplay:!1,Hb:!0,volume:.1}))};a.sb=c});t("Mols/Load","require exports ../Scene/Optimizations ../UI/Menu3D/Menu3D ../Vars ./3DMol/ThreeDMol ./CommonLoader".split(" "),function(p,a,g,e,f,b,q){Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){q.Qa();jQuery.getJSON("scene_info.json",function(a){!1===a.menuActive&&(f.b.Aa=!1);b.c(a);f.b.Aa&&e.c(a);g.P()})}});t("UI/LoadingScreens",
["require","exports","../Vars"],function(p,a,g){function e(){clearInterval(f)}Object.defineProperty(a,"__esModule",{value:!0});var f;a.hb=function(){document.getElementById("loading-container").outerHTML=""};a.pa=function(a){e();g.o.displayLoadingUI();g.o.loadingUIText=a};a.ub=function(){var a=90;clearInterval(f);f=setInterval(function(){a+=.02*(99-a);g.o.displayLoadingUI();g.o.loadingUIText="Loading the main scene... "+a.toFixed(0)+"%"},100)};a.wb=e});t("UI/UI2D",["require","exports","../UI/OpenPopup",
"../Vars"],function(p,a,g,e){function f(){jQuery("body").append('\n        <button\n          title="Click to switch to full screen"\n          id="fullscreen-button"\n          class="ui-button"\n          style="color:white;\n                 width:80px;\n                 right:20px;\n                 position:absolute;\n                 height:50px;\n                 bottom:80px;\n                 background-color:rgba(51,51,51,0.7);\n                 border:none;\n                 outline:none;\n                 cursor:pointer;">\n            <svg\n              style="position:relative; left:0.5px;"\n              width="48" height="48"\n              xmlns="http://www.w3.org/2000/svg"\n              xmlns:svg="http://www.w3.org/2000/svg"\n              clip-rule="evenodd">\n                <g class="layer">\n                    <path d="m47.799999,43.649999l-47.699999,0l0,-39.749999l47.699999,0l0,39.749999zm-1.9875,-37.762499l-43.724999,0l0,35.774999l43.724999,0l0,-35.774999zm-7.95,13.9125l-1.9875,0l0,-6.441487l-22.341487,22.341487l6.441487,0l0,1.9875l-9.9375,0l0,-9.9375l1.9875,0l0,6.441487l22.341487,-22.341487l-6.441487,0l0,-1.9875l9.9375,0l0,9.9375z" fill="#ffffff" id="svg_1"/>\n                </g>\n            </svg>\n        </button>\n\n        <button\n          title="Click for help"\n          id="help-button"\n          class="ui-button"\n          style="color:white;\n                 width:80px;\n                 right:20px;\n                 position:absolute;\n                 height:50px;\n                 bottom:140px;\n                 background-color:rgba(51,51,51,0.7);\n                 border:none;\n                 outline:none;\n                 cursor:pointer;">\n                 <svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n<path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="\n\tM35.5,9.8c1.7,5.4-0.6,8-1.6,8.9c-1.9,1.9-4.5,4.7-5.8,7c-1.5,2.7-4.1,12-6.8,4.4c-3.2-9.1,1.3-11.6,3.5-13.4\n\tc1.5-1.3,3.4-4.3,0.5-5.3c-4-1.3-6.1,5.3-10.7,4c-3-0.8-3.2-4.1-2.2-6.6C15.4,1.7,32.5,0.6,35.5,9.8L35.5,9.8z"/>\n<path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" d="M28.3,39.6c0-5.5-8.5-5.5-8.5,0S28.3,45.1,28.3,39.6\n\t"/>\n</svg>\n\n        </button>\n    ');
jQuery("#fullscreen-button").click(function(){e.o.switchFullscreen(!0);jQuery("#renderCanvas").focus()});jQuery("#help-button").click(function(){g.Ca("Help","help/index.html")});document.getElementById("babylonVRiconbtn").style.opacity="1.0";document.getElementById("babylonVRiconbtn").style.filter="alpha(opacity=1.0)"}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){f()};window.debugMode=function(){e.a.debugLayer.show();setTimeout(function(){document.getElementById("inspector-host").style.zIndex=
"15";document.getElementById("scene-explorer-host").style.zIndex="15"},500)}});t("Scene/LoadAndSetup","require exports ../Cameras/Setup ../Cameras/VRCamera ../Mols/Load ../Navigation/Navigation ../Navigation/Pickables ../UI/LoadingScreens ../UI/UI2D ../Vars ./Optimizations".split(" "),function(p,a,g,e,f,b,q,n,m,d,h){function c(){var a=BABYLON.Mesh.CreateSphere("navTargetMesh",4,.1,d.a),b=new BABYLON.StandardMaterial("myMaterial",d.a);b.diffuseColor=new BABYLON.Color3(1,0,1);a.material=b;d.tb({va:"ground",
Ba:a});e.c();h.c();window.j=d}function k(a){n.pa("Loading the main scene...");BABYLON.SceneLoader.LoadAssetContainer("scene/","scene.babylon",d.a,function(b){n.ub();d.a.executeWhenReady(function(){b.addAllToScene();d.a.activeCamera=d.a.cameras[0];for(var c=!1,e=0;1<d.a.lights.length;){var f=d.a.lights[e].name.toLowerCase();-1===f.indexOf("shadowlight")&&-1===f.indexOf("shadow_light")?d.a.lights[e].dispose():c?d.a.lights[e].dispose():(c=!0,e++)}for(var g in d.a.meshes)"protein_box"===d.a.meshes[g].name&&
(d.a.getMeshByName("protein_box").isVisible=!1);for(var k in d.a.meshes)if(d.a.meshes[k].material){c=d.a.meshes[k];if(void 0===c.material.emissiveTexture||null===c.material.emissiveTexture)c.material.emissiveTexture=c.material.diffuseTexture,c.material.diffuseColor=new BABYLON.Color3(0,0,0),c.material.specularColor=new BABYLON.Color3(0,0,0),c.material.emissiveColor=new BABYLON.Color3(0,0,0);h.ta(c,!1);q.za({mesh:c,a:d.a})}a()})},function(a){a.lengthComputable&&n.pa("ALoading the main scene... "+Math.round(90*
a.loaded/a.total).toString()+"%")})}Object.defineProperty(a,"__esModule",{value:!0});a.load=function(){d.c();n.hb();c();k(function(){g.c();b.c();q.c();m.c();f.c()});window.addEventListener("resize",function(){d.o.resize()})};a.cb=function(){setTimeout(h.P,1E3);n.wb();d.a.activeCamera.maxZ=250;d.a.activeCamera.minZ=0;d.o.runRenderLoop(function(){d.a.render()})}});y.V({urlArgs:"bust="+(new Date).getTime()});y(["Scene/LoadAndSetup"],function(p){p.load()});t("Start",function(){})})();
