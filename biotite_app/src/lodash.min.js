/*
 almond 0.3.3 Copyright jQuery Foundation and other contributors.
 Released under MIT license, http://github.com/requirejs/almond/LICENSE
*/
var E="function"==typeof Object.defineProperties?Object.defineProperty:function(B,y,q){B!=Array.prototype&&B!=Object.prototype&&(B[y]=q.value)},F="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function G(B){if(B){for(var y=F,q=["Math","sign"],v=0;v<q.length-1;v++){var a=q[v];a in y||(y[a]={});y=y[a]}q=q[q.length-1];v=y[q];B=B(v);B!=v&&null!=B&&E(y,q,{configurable:!0,writable:!0,value:B})}}
G(function(B){return B?B:function(y){y=Number(y);return 0===y||isNaN(y)?y:0<y?1:-1}});
(function(){var B,y,q;(function(v){function a(a,b){var k,l;b=b&&b.split("/");var f=x.map,c=f&&f["*"]||{};if(a){a=a.split("/");var n=a.length-1;x.ib&&A.test(a[n])&&(a[n]=a[n].replace(A,""));"."===a[0].charAt(0)&&b&&(n=b.slice(0,b.length-1),a=n.concat(a));for(n=0;n<a.length;n++){var d=a[n];"."===d?(a.splice(n,1),--n):".."===d&&0!==n&&(1!==n||".."!==a[2])&&".."!==a[n-1]&&0<n&&(a.splice(n-1,2),n-=2)}a=a.join("/")}if((b||c)&&f){d=a.split("/");for(n=d.length;0<n;--n){var e=d.slice(0,n).join("/");if(b)for(l=
b.length;0<l;--l)if(k=f[b.slice(0,l).join("/")])if(k=k[e]){var C=k;var g=n;break}if(C)break;if(!m&&c&&c[e]){var m=c[e];var z=n}}!C&&m&&(C=m,g=z);C&&(d.splice(0,g,C),a=d.join("/"))}return a}function g(a,b){return function(){var k=w.call(arguments,0);"string"!==typeof k[0]&&1===k.length&&k.push(null);return r.apply(v,k.concat([a,b]))}}function e(k){return function(b){return a(b,k)}}function d(a){return function(k){b[a]=k}}function c(a){if(u.call(f,a)){var k=f[a];delete f[a];t[a]=!0;l.apply(v,k)}if(!u.call(b,
a)&&!u.call(t,a))throw Error("No "+a);return b[a]}function p(a){var k=a?a.indexOf("!"):-1;if(-1<k){var b=a.substring(0,k);a=a.substring(k+1,a.length)}return[b,a]}function m(a){return function(){return x&&x.R&&x.R[a]||{}}}var r,b={},f={},x={},t={},u=Object.prototype.hasOwnProperty,w=[].slice,A=/\.js$/;var n=function(k,b){k=p(k);var l=k[0];b=b[1];k=k[1];if(l){l=a(l,b);var f=c(l)}l?f&&f.normalize?k=f.normalize(k,e(b)):k=a(k,b):(k=a(k,b),k=p(k),l=k[0],k=k[1],l&&(f=c(l)));return{ia:l?l+"!"+k:k,n:k,jb:l,
p:f}};var z={Qa:function(a){return g(a)},I:function(a){var k=b[a];return"undefined"!==typeof k?k:b[a]={}},Na:function(a){return{id:a,uri:"",I:b[a],R:m(a)}}};var l=function(a,l,e,m){var k,C=[];var r=typeof e;var w=(m=m||a)?p(m):[];if("undefined"===r||"function"===r){l=!l.length&&e.length?["require","exports","module"]:l;for(k=0;k<l.length;k+=1){var A=n(l[k],w);r=A.ia;if("require"===r)C[k]=z.Qa(a);else if("exports"===r){C[k]=z.I(a);var x=!0}else if("module"===r)var D=C[k]=z.Na(a);else if(u.call(b,r)||
u.call(f,r)||u.call(t,r))C[k]=c(r);else if(A.p)A.p.load(A.n,g(m,!0),d(r),{}),C[k]=b[r];else throw Error(a+" missing "+r);}l=e?e.apply(b[a],C):void 0;a&&(D&&D.I!==v&&D.I!==b[a]?b[a]=D.I:l===v&&x||(b[a]=l))}else a&&(b[a]=e)};B=y=r=function(a,b,f,d,e){if("string"===typeof a)return z[a]?z[a](b):c(n(a,b?p(b):[]).ia);if(!a.splice){x=a;x.Da&&r(x.Da,x.eb);if(!b)return;b.splice?(a=b,b=f,f=null):a=v}b=b||function(){};"function"===typeof f&&(f=d,d=e);d?l(v,a,b,f):setTimeout(function(){l(v,a,b,f)},4);return r};
r.R=function(a){return r(a)};B.h=b;q=function(a,l,n){if("string"!==typeof a)throw Error("See almond README: incorrect module build, no module name");l.splice||(n=l,l=[]);u.call(b,a)||u.call(f,a)||(f[a]=[a,l,n])};q.h={jQuery:!0}})();q("external/almond",function(){});q("Vars",["require","exports"],function(v,a){Object.defineProperty(a,"__esModule",{value:!0});a.ea=11;a.W=1.5;a.da=1;a.ra=2E3;a.V=1.2;a.ta=2.5;a.sa=.1;a.ua=.01;a.xa=500;a.wa=750;a.N=.1;a.ca=15;a.va=.05;a.qa=/iPad|iPhone|iPod/.test(navigator.userAgent)&&
!window.MSStream;a.c=function(){a.canvas=document.getElementById("renderCanvas");a.u=new BABYLON.Engine(a.canvas,!0);BABYLON.Database.IDBStorageEnabled=!0;a.a=new BABYLON.Scene(a.u);window.scene=a.a};a.Ea=function(){if(void 0===a.P){var g=new BABYLON.Ray(a.a.activeCamera.position,new BABYLON.Vector3(0,-1,0),50);g=a.a.pickWithRay(g,function(a){return"ground"===a.name});a.P=g.distance}};a.Sa=function(g){a.P=g};a.Ya=function(g){var e={createDeviceOrientationCamera:!0};a.a.getEngine().getCaps().multiview&&
(e.useMultiview=!0);a.f=a.a.createDefaultVRExperience(e);document.getElementById("babylonVRiconbtn").style.opacity="0.0";document.getElementById("babylonVRiconbtn").style.filter="alpha(opacity=0)";window.vrHelper=a.f;a.b=g;a.b.na=!0}});q("Cameras/NonVRCamera",["require","exports","../Vars"],function(v,a,g){function e(){d.ellipsoid=new BABYLON.Vector3(1,.5*g.P,1)}Object.defineProperty(a,"__esModule",{value:!0});var d;new BABYLON.Vector3(0,0,0);a.c=function(){d=g.a.activeCamera;d.keysUp=[87,38];d.keysDown=
[83,40];d.keysLeft=[65,37];d.keysRight=[68,39];e();g.a.collisionsEnabled=!0;d.checkCollisions=!0;d.speed=.1;d.attachControl(g.canvas,!0);d._updatePosition()};a.Ra=e});q("Cameras/Setup",["require","exports","../Vars","./NonVRCamera"],function(v,a,g,e){Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){a.X=g.a.cameras.filter(function(a){return-1===a.name.indexOf("VR")})[0];var d=new BABYLON.DeviceOrientationCamera("DevOr_camera",a.X.position.clone(),g.a,!0);d.rotation=a.X.rotation;g.a.activeCamera=
d;g.a.activeCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(a.X.rotation);g.Ea();e.c()}});q("Navigation/Points",["require","exports","../Cameras/CommonCamera","../Vars","./Pickables"],function(v,a,g,e,d){function c(b){a.i.copyFrom(b)}function p(){if(3===e.b.g)var b=e.a.activeCamera.getForwardRay();else if(2===e.b.g||1===e.b.g){b=void 0;1===e.b.g?(b=e.f.rightControllerGazeTrackerMesh,b||(b=e.f.leftControllerGazeTrackerMesh)):2===e.b.g&&(b=e.f.gazeTrackerMesh);if(!b){console.log("error!");
return}b.isVisible?c(b.absolutePosition):c(a.K);b=g.o();b=new BABYLON.Ray(b,a.i.subtract(b))}else console.log("Unexpected error.");m(b)}function m(b,f){void 0===f&&(f=!0);b=e.a.pickWithRay(b,function(a){return d.ha(a)});b.hit&&b.distance<e.ca?(f&&c(b.pickedPoint),d.H(b.pickedMesh)):(c(a.K),d.H(void 0))}function r(a){a=new BABYLON.Ray(a,new BABYLON.Vector3(0,-1,0),50);return e.a.pickWithRay(a,function(a){return a.id===e.b.m.id})}Object.defineProperty(a,"__esModule",{value:!0});a.K=new BABYLON.Vector3(-1E3,
1E3,1E3);a.Y=new BABYLON.Vector3(0,0,0);a.Z=new BABYLON.Vector3(0,0,0);a.i=new BABYLON.Vector3(0,0,0);a.kb=c;a.c=function(){e.a.registerBeforeRender(function(){p();void 0===a.i?(c(a.K),d.H(void 0)):10<BABYLON.Vector3.Distance(g.o(),a.i)&&(c(a.K),d.H(void 0));e.b.oa.position.copyFrom(a.i);void 0!==d.A&&(e.b.oa.isVisible=d.A!==d.D);var b=r(g.o()).pickedPoint;b&&(a.Y=b);if(b=r(a.i).pickedPoint)a.Z=b})};a.lb=p;a.Ja=r});q("Cameras/CommonCamera",["require","exports","../Navigation/Points","../Vars"],function(v,
a,g,e){function d(){if(3===e.b.g)return new BABYLON.Vector3(0,0,0);var a=e.f.webVRCamera,c;a.leftCamera?c=a.leftCamera.globalPosition.subtract(a.position):c=new BABYLON.Vector3(0,0,0);return c}Object.defineProperty(a,"__esModule",{value:!0});var c=new BABYLON.Vector3(1,0,0),p=new BABYLON.Vector3(1,0,0);a.o=function(){var a=e.a.activeCamera,c=a.position.clone();if(2===e.b.g||1===e.b.g)a.leftCamera?c.copyFrom(a.leftCamera.globalPosition):console.log("Prob here");return c};a.pa=function(a){if(3===e.b.g){var c=
e.a.activeCamera;c.position.copyFrom(a)}else if(2===e.b.g||1===e.b.g)c=e.f.webVRCamera,c.position.copyFrom(a.subtract(d()))};a.ka=function(){if(2===e.b.g||1===e.b.g){var a=g.Z.subtract(g.Y),d=BABYLON.Vector3.GetAngleBetweenVectors(a,c,p);for(0>a.z&&(d=-d);0>d;)d+=2*Math.PI;for(;d>2*Math.PI;)d-=2*Math.PI;return d+=.5*Math.PI}return e.a.activeCamera.rotation.clone().y};a.Ia=d});q("Mols/Shadows",["require","exports","../Vars"],function(v,a,g){function e(){var a=g.a.lights[0],c=64,e=.9625,m=a.name.match(/blur_([0-9\.]+)/g);
null!==m&&(c=parseFloat(m[0].substr(5)));a=a.name.match(/dark_([0-9\.]+)/g);null!==a&&(e=parseFloat(a[0].substr(5)));return{blur:c,S:e}}Object.defineProperty(a,"__esModule",{value:!0});a.Xa=function(){var d=g.a.lights[0],c=e();c.cb=0;c.blur=2;console.log(c);g.qa?console.log("iOS, so not generating shadows... causes an error... See https://forum.babylonjs.com/t/issues-between-shadowgenerator-and-ios-osx/795"):(a.s=new BABYLON.ShadowGenerator(4096,d),a.s.useBlurExponentialShadowMap=!0,a.s.setDarkness(c.S),
a.s.F=!0,a.s.h=c.blur,window.s=a.s)};a.Ga=e;a.Wa=function(){for(var a in g.a.meshes)if(g.a.meshes.hasOwnProperty(a)){var c=g.a.meshes[a];if(-1!==c.name.toLowerCase().indexOf("shadowcatcher")||-1!==c.name.toLowerCase().indexOf("shadow_catcher"))c.material=new BABYLON.ShadowOnlyMaterial("shadow_catch"+a.toString(),g.a),c.material.activeLight=g.a.lights[0],c.receiveShadows=!0}}});q("Scene/Optimizations",["require","exports","../Mols/Shadows","../Vars"],function(v,a,g,e){function d(a){if(void 0!==a){a=
a.getVerticesData(BABYLON.VertexBuffer.PositionKind);if(null===a)return null;a=a.length/3}else a=0;return a}function c(){var a=new BABYLON.SceneOptimizerOptions(25,2E3),f=0;a.optimizations.push(new BABYLON.ShadowsOptimization(f));a.optimizations.push(new BABYLON.LensFlaresOptimization(f));a.optimizations.push(new BABYLON.PostProcessesOptimization(f));a.optimizations.push(new BABYLON.ParticlesOptimization(f));a.optimizations.push(new p(f));f++;a.optimizations.push(new m(f));a.optimizations.push(new p(f));
f++;a.optimizations.push(new BABYLON.TextureOptimization(f,512));a.optimizations.push(new p(f));f++;a.optimizations.push(new BABYLON.RenderTargetsOptimization(f));a.optimizations.push(new BABYLON.TextureOptimization(f,256));a.optimizations.push(new p(f));f++;a.optimizations.push(new BABYLON.HardwareScalingOptimization(f,4));a.optimizations.push(new r(f,500));a.optimizations.push(new p(f));return a}function p(a){var b=this;"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){console.log("Optimization priority:",
b.priority);console.log("FPS:",e.u.getFps());console.log("");return!0};this.getDescription=function(){return"Reports the current priority. For debugging."}}function m(a){"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){var a=e.a.getMeshByName("surfaces.wrl");null!==a&&a.dispose();return!0};this.getDescription=function(){return"Removes surface representations."}}function r(a,f,c){void 0===c&&(c=void 0);"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){var a=[],
b;for(b in e.a.meshes)if(e.a.meshes.hasOwnProperty(b)){var g=e.a.meshes[b];if(-1===g.name.indexOf("Decimated")){var m=d(g);null!==m&&(m<f||a.push([m,g,void 0===c?1-f/m:c]))}}a.sort(function(a,l){return l[0]-a[0]});for(b in a)if(a.hasOwnProperty(b)){g=a[b][1];for(m=a[b][2];0<g.getLODLevels().length;){var n=g.getLODLevels()[0].mesh;g.removeLODLevel(n);null!==n&&n.dispose()}g.simplify([{quality:m,distance:.001}],!1,BABYLON.SimplificationType.QUADRATIC,function(){})}return!0};this.getDescription=function(){return"Simplifies the geometry of complex objects in the scene."}}
Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){BABYLON.SceneOptimizer.OptimizeAsync(e.a,c());e.a.autoClear=!1;e.a.autoClearDepthAndStencil=!1;for(var a in e.a.meshes)if(e.a.meshes.hasOwnProperty(a)){var f=e.a.meshes[a];-1!==f.name.indexOf("baked")&&void 0!==f.material&&(f.material.diffuseColor=new BABYLON.Color3(0,0,0),f.material.specularColor=new BABYLON.Color3(0,0,0),f.material.emissiveTexture=f.material.diffuseTexture,f.material.diffuseTexture=null,f.freezeWorldMatrix())}};a.aa=
function(a){var b=d(a);null===b||100>b||(b=1+Math.floor(b/e.ra),1<b&&a.subdivide(b),a.createOrUpdateSubmeshesOctree(64,2),a.useOctreeForCollisions=!0)};a.ja=function(a,c){void 0===c&&(c=!0);c&&a.material.freeze()};a.M=function(){g.s&&(e.a.lights[0].autoUpdateExtends=!0,g.s.getShadowMap().refreshRate=BABYLON.RenderTargetTexture.REFRESHRATE_RENDER_ONCE,e.a.lights[0].autoUpdateExtends=!1)}});q("Navigation/Navigation","require exports ../Cameras/CommonCamera ../Cameras/NonVRCamera ../Scene/Optimizations ../Vars ./Pickables ./Points".split(" "),
function(v,a,g,e,d,c,p,m){function r(){w=g.o();c.a.registerBeforeRender(function(){var a=g.o();null===m.Ja(a).pickedMesh?g.pa(w):w=a})}function b(){jQuery("body").keypress(function(a){32===a.charCode&&f()})}function f(){var a=(new Date).getTime();if(!(250>a-A))switch(A=a,console.log("hi"),p.Ha()){case 2:console.log("teleport");x();break;case 4:t();break;case 3:p.A.w()}}function x(a,b){void 0===a&&(a=void 0);void 0===b&&(b=void 0);void 0===b&&(b=function(){});c.f.gazeTrackerMesh.isVisible=!1;var l=
new BABYLON.Animation("animationCameraTeleportation","position",90,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),k=g.o();void 0===a&&(a=new BABYLON.Vector3(m.i.x,m.i.y+c.P,m.i.z));var n=g.Ia();a=a.subtract(n);k=k.subtract(n);l.setKeys([{frame:0,value:k},{frame:c.ea,value:a}]);var f=c.a.activeCamera;f.animations=[];f.animations.push(l);c.a.beginAnimation(f,0,c.ea,!1,1,function(){c.f.gazeTrackerMesh.isVisible=!0;f.animations=[];b()})}function t(){var a=m.Z,b=
g.o(),n=m.i.subtract(b),f=n.length(),d;.1*f<c.da?d=m.i.subtract(n.normalize().scale(c.da)):.1*f>c.W?d=m.i.subtract(n.normalize().scale(c.W)):.1*f<c.W&&(d=b.add(n.scale(.9)));d.y=m.i.y;d.y-a.y<.5*c.V+.1&&(d.y=a.y+.5*c.V+.1);c.Sa(m.i.y-a.y);x(d,function(){e.Ra()})}function u(){n=jQuery("#capture-clicks");n.click(function(){console.log("clicked!");f()});c.a.registerBeforeRender(function(){var a=c.a.activeCamera.inputs.attached.deviceOrientation;(a=a?0!==a._alpha||0!==a._beta||0!==a._gamma:!1)&&!z?(z=
!0,n.show()):!a&&z&&(z=!1,n.fb())})}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){c.b.m=c.a.getMeshByID(c.b.la);null===c.b.m&&alert("No mesh named "+c.b.la);c.b.m.checkCollisions=!0;c.b.m.visibility=0;d.aa(c.b.m);p.ma({O:f,G:c.b.m});c.b.g=3;b();m.c();u();r()};var w,A=0;a.C=f;var n=void 0,z=!1});q("Navigation/Pickables","require exports ../Cameras/CommonCamera ../Scene/Optimizations ../Vars ./Navigation".split(" "),function(v,a,g,e,d,c){function p(a){void 0===a.O&&(a.O=c.C);void 0===
a.a&&(a.a=d.a);void 0!==a.G&&(a.G.ya=new BABYLON.ActionManager(a.a),a.G.ya.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){3===d.b.g&&a.O()})))}Object.defineProperty(a,"__esModule",{value:!0});var m=[],r=[],b=[];a.H=function(b){a.A=b};a.c=function(){m.push(d.b.m)};a.za=function(a){m.push(a);r.push(a);e.aa(a);p({G:a,O:function(){a.w()}})};a.Aa=function(a){m.push(a);b.push(a);e.aa(a);p({G:a})};a.ha=function(a){return a.id===d.b.m.id?!0:a.isVisible?-1!==m.indexOf(a):
!1};a.Ha=function(){return void 0===a.A?1:a.A===d.b.m?2:-1!==r.indexOf(a.A)?3:-1!==b.indexOf(a.A)?4:a.A===a.D?5:1};a.ma=p;a.Ma=function(){a.D=BABYLON.Mesh.CreateSphere("padNavSphereAroundCamera",4,d.ca-1,d.a);a.D.flipFaces(!0);var b=new BABYLON.StandardMaterial("padNavSphereAroundCameraMat",d.a);b.diffuseColor=new BABYLON.Color3(1,1,1);b.specularColor=new BABYLON.Color3(0,0,0);b.h=null;a.D.material=b;a.D.visibility=0;d.a.registerBeforeRender(function(){a.D.position=g.o()});m.push(a.D)}});q("Cameras/VRControllers",
"require exports ../Navigation/Navigation ../Navigation/Pickables ../Navigation/Points ../Vars ./CommonCamera ./VRCamera".split(" "),function(v,a,g,e,d,c,p,m){function r(a){a.onTriggerStateChangedObservable.add(function(a){a.pressed&&(a=(new Date).getTime(),a-f>c.xa&&(f=a,g.C()))})}function b(a){a.onPadStateChangedObservable.add(function(a){(w=a.pressed)&&Math.abs(t)<c.N&&Math.abs(u)<c.N&&console.log("Would reset camera view if you didn't get an error below...")});a.onPadValuesChangedObservable.add(function(a){t=
a.y;u=a.x;Math.abs(u)<c.N&&Math.abs(t)<c.N?u=t=0:.5>Math.abs(u)?u=0:(u+=0<u?-.5:.5,u=2*u)});c.a.registerBeforeRender(function(){if(w){if(!d.i.equals(d.K)){var a=p.o(),b=d.i.subtract(a);b.normalize();b=b.scale(t*c.ua*c.a.getAnimationRatio());p.pa(a.subtract(b))}0!==u&&(a=(new Date).getTime(),a-x<c.wa||(x=a,a=c.f.webVRCamera.rotationQuaternion.toEulerAngles(),a.y+=.25*Math.sign(u)*Math.PI,c.f.webVRCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(a)))}})}Object.defineProperty(a,"__esModule",
{value:!0});var f=0,x=0,t=0,u=0,w=!1;a.c=function(){e.Ma();c.f.webVRCamera.onControllerMeshLoadedObservable.add(function(a){c.b.g=1;console.log("controller loaded");m.Ua();console.log("Isnt there on pickable or something");r(a);b(a)})}});q("Cameras/VRCamera","require exports ../Navigation/Pickables ../Scene/Optimizations ../Vars ./VRControllers".split(" "),function(v,a,g,e,d,c){function p(){d.f.onEnteringVRObservable.add(function(){d.b.g=2;r();g.H(void 0);e.M();window.vrHelper=d.f});d.f.onExitingVRObservable.add(function(){d.b.g=
3;g.H(void 0);e.M()})}function m(){var a=new BABYLON.Mesh("vrNavTargetMesh",d.a),c=new BABYLON.VertexData;c.F=[0,0,0];c.h=[0];c.applyToMesh(a);a.isVisible=!1;return a}function r(){d.f.raySelectionPredicate=function(a){return g.ha(a)};d.f.gazeTrackerMesh=m();d.f.updateGazeTrackerScale=!1;d.f.displayGaze=!0;d.f.enableInteractions()}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){p();c.c()};a.Ua=r});q("Navigation/VoiceCommands",["require","exports","../Scene/Optimizations","../Vars",
"./Navigation"],function(v,a,g,e,d){function c(c){function n(a){function c(a){if(x.hasOwnProperty(a)){var c=x[a];if(""!==c){a=function(a){if(t.hasOwnProperty(a)){var k=t[a];""!==k&&(l[n+" "+c+" "+k]=function(){b([c,k],e)})}};for(var k in t)a(k)}}}function k(a){if(t.hasOwnProperty(a)){var c=t[a];""!==c&&(l[n+" "+c]=function(){b([c],e)})}}function d(a){if(x.hasOwnProperty(a)){var c=x[a];""!==c&&(l[n+" "+c]=function(){b([c],e)})}}var n=["hide","show","high"][a],e="show"===n,f;for(f in x)d(f);for(var g in t)k(g);
for(f in x)c(f);l[n+" surface"]=function(){b(["Surfaces"],e)}}var l={};void 0===a.j&&r(c);for(c=0;3>c;c++)n(c);l.teleport=function(){d.C()};l.click=function(){d.C()};l.move=function(){d.C()};l.look=function(){d.C()};l.hiya=function(){d.C()};annyang&&(annyang.debug(),annyang.removeCommands(),annyang.addCommands(l),annyang.start());w||(q.speak("The show and hide commands control visualization. For example, show proteen or hide ribbon. The teleport command moves your position to the stair point sphere."),
w=!0)}function p(a){return a.charAt(0).toUpperCase()+a.substring(1)}function m(a){a=a.replace(/.sdf/g,"").replace(/.pdb/g,"");a=a.replace(/.wrl/g,"");a=a.replace(/surfaces/g,"Surfaces");var b=a.split("_");a=b[0];if("Surfaces"===a)return{key:"Surfaces",v:a,B:""};b=b[1].replace(/[A-Z]/g,function(a){return"_"+a}).split(/_/g)[1];a=p(a);b=p(b);return{key:a+"_"+b,v:a,B:b}}function r(b){a.j={};for(var c in b.objIDs)if(b.objIDs.hasOwnProperty(c)){var l=b.objIDs[c],k=m(l);void 0===a.j[k.key]&&(a.j[k.key]=
{description:k.key.replace(/_/g," "),T:[],v:k.v,B:k.B});a.j[k.key].T.push(l);-1===x.indexOf(k.v)&&x.push(k.v);-1===t.indexOf(k.B)&&t.push(k.B)}}function b(b,c){for(var l in a.j)if(a.j.hasOwnProperty(l)){var k=a.j[l];a:{var d=void 0;var e=b,g=[k.v,k.B];for(d in e)if(e.hasOwnProperty(d)&&-1===g.indexOf(e[d])){d=!1;break a}d=!0}d&&f(k.v,k.B,c)}}function f(b,c,l){b=p(b);""!==c&&(b+="_"+p(c));for(var k in a.j[b].T)a.j[b].T.hasOwnProperty(k)&&(e.a.getMeshByName(a.j[b].T[k]).isVisible=l);g.M()}Object.defineProperty(a,
"__esModule",{value:!0});var x=[],t=[],u=!1,w=!1;a.c=function(a){u?c(a):jQuery.getScript("js/annyang.min.js",function(){c(a);u=!0})};a.Ta=r;a.hb=b;a.Za=f;a.bb=function(){annyang.abort()};var q=new (function(){function a(){var a=this;this.U=null;jQuery(document).ready(function(){"speechSynthesis"in window&&(a.U=window.speechSynthesis.getVoices(),window.speechSynthesis.onvoiceschanged=function(){a.U=window.speechSynthesis.getVoices()})})}a.prototype.speak=function(a){if(null!==this.U){a=new SpeechSynthesisUtterance(a);
a.rate=1;var b=this.U.filter(function(a){return-1<a.name.toUpperCase().indexOf("SAMANTHA")});0<b.length&&(a.voice=b[0]);a.lang="en";a.volume=1;annyang&&annyang.abort();window.speechSynthesis.speak(a);setTimeout(function(){annyang&&annyang.start()},2E3)}};return a}())});q("UI/GUI","require exports ../Cameras/CommonCamera ../Navigation/Pickables ../Navigation/Points ../Navigation/VoiceCommands ../Vars".split(" "),function(q,a,g,e,d,c,p){function m(a){function b(a){if(c.j.hasOwnProperty(a)){var b=c.j[a];
a=b.description;f.push(new A({w:function(a){c.Za(b.v,b.B,!a.value)},default:!1,J:a+"\n(Hide)",$:function(a){a.isVisible(!1)},name:"menu-visible-button-"+b.v.replace(/ /g,"").replace(/\n/g,""),ba:w,L:a+"\n(Show)"}))}}c.Ta(a);v=new BABYLON.GUI.GUI3DManager(p.a);w=new BABYLON.GUI.CylinderPanel;v.addControl(w);w.h=!0;for(var l in c.j)b(l);r(w,a);w.h=!1;t=new BABYLON.TransformNode("");w.linkToTransformNode(t);setInterval(function(){w.radius=p.ta;w.margin=p.sa},1E3);window.cylinderPanelMainMenu=w}function r(a,
b){f.push(new A({w:function(a){a.value?c.c(b):c.bb()},default:!1,J:"Audio Commands\n(On)",$:function(a){a.isVisible(!1)},name:"menu-audio-commands-button",ba:a,L:"Audio Commands\n(Off)"}))}function b(){var a=new BABYLON.GUI.GUI3DManager(p.a),b=new BABYLON.GUI.StackPanel3D;a.addControl(b);new A({w:function(a){for(var b in f)f.hasOwnProperty(b)&&f[parseInt(b,10)].isVisible(a.value);t.position.copyFrom(g.o());t.rotation.y=g.ka()},default:!1,J:"Show Menu",name:"menu-visible-button",ba:b,L:"Hide Menu"});
var c=new BABYLON.TransformNode("");b.linkToTransformNode(c);c.rotation.x=.5*Math.PI;p.a.registerBeforeRender(function(){c.position.copyFrom(d.Y);c.position.y+=.1;c.rotation.y=g.ka()})}Object.defineProperty(a,"__esModule",{value:!0});var f=[],v,t,u,w;a.c=function(a){m(a);b();u=new BABYLON.Sound("click-button","assets/staple-public-domain.mp3",p.a,null,{loop:!1,autoplay:!1,nb:!0,volume:.1})};var A=function(){function a(a){var b=this;this.button=new BABYLON.GUI.HolographicButton(a.name);a.ba.addControl(this.button);
this.F=new BABYLON.GUI.TextBlock;this.F.color="white";this.F.h=!0;this.value=a.default;this.L=a.L;this.J=a.J;this.w=a.w;this.ga();this.h=BABYLON.Mesh.CreateSphere(a.name+"-container-mesh",2,p.V,p.a);this.h.position=this.button.node.absolutePosition;this.h.visibility=0;this.h.w=function(){b.Fa()};e.za(this.h);void 0!==a.$&&a.$(this)}a.prototype.isVisible=function(a){if(void 0===a)return this.button.isVisible;this.button.isVisible=a;this.h.isVisible=a};a.prototype.ga=function(){this.F.text=this.value?
this.L:this.J;this.button.content.dispose();this.button.content=this.F};a.prototype.Fa=function(){u.setPosition(this.h.position.clone());u.play();this.value=!this.value;this.w(this);this.ga()};return a}()});q("Mols/CommonLoader","require exports ../Navigation/Pickables ../Scene/LoadAndSetup ../Scene/Optimizations ../Vars ./Shadows".split(" "),function(v,a,g,e,d,c,p){Object.defineProperty(a,"__esModule",{value:!0});a.Ca=function(){p.Xa();BABYLON.OBJFileLoader.OPTIMIZE_WITH_UV=!0};a.Ba=function(a){p.Wa();
void 0!==a.transparentGround&&!0===a.transparentGround&&(c.b.m?(c.b.m.visibility=1,a=new BABYLON.StandardMaterial("transparentGround",c.a),a.diffuseColor=new BABYLON.Color3(1,1,1),a.specularColor=new BABYLON.Color3(0,0,0),a.emissiveColor=new BABYLON.Color3(0,0,0),a.alpha=c.va,c.b.m.material=a):console.log("Warning: Vars.vrVars.groundMesh not defined."));e.La()};a.Va=function(a){if(void 0!==a.material&&null!==a.material){var c=p.Ga();c=.95<c.S?.01:.4>c.S?.0025:.013636363636363637*c.S-.0029545454545454545;
a.material.emissiveColor=new BABYLON.Color3(c,c,c);d.ja(a)}a.scaling.z=-1;a.scaling.x=-1;p.s&&p.s.getShadowMap().renderList.push(a);g.Aa(a)}});q("Mols/VRML",["require","exports","../Scene/Optimizations","../Vars","./CommonLoader"],function(v,a,g,e,d){function c(){var a=q(f("point [","]",z));a=a.map(function(a){return[a[2],a[1],a[0]]});t=[].concat.apply([],a);t=m(t);r(b().map(function(a){return-a}));a=q(f("vector [","]",z));u=[].concat.apply([],a);u=m(u);a=q(f("color [","]",z));a=a.map(function(a){return[a[0],
a[1],a[2],1]});w=[].concat.apply([],a);w=m(w);A=f("coordIndex [","]",z).split(",").map(function(a){return parseInt(a,10)}).filter(function(a){return-1!==a&&!isNaN(a)&&void 0!==a})}function p(){var b=new BABYLON.VertexData;b.positions=t;b.indices=A;b.normals=u;b.colors=w;a.l=new BABYLON.Mesh("MeshFrom3DMol",e.a);b.applyToMesh(a.l);b=new BABYLON.StandardMaterial("Material",e.a);b.diffuseColor=new BABYLON.Color3(1,1,1);b.emissiveColor=new BABYLON.Color3(0,0,0);b.specularColor=new BABYLON.Color3(0,0,
0);b.sideOrientation=BABYLON.Mesh.h;a.l.material=b;d.Va(a.l)}function m(a){return a.filter(function(a){return!isNaN(a)&&void 0!==a})}function r(a){t=t.map(function(b,c){return b+a[c%3]})}function b(){var a=t.map(function(a,b){return 0===b%3?a:0}).reduce(function(a,b){return a+b}),b=t.map(function(a,b){return 1===b%3?a:0}).reduce(function(a,b){return a+b}),c=t.map(function(a,b){return 2===b%3?a:0}).reduce(function(a,b){return a+b}),d=t.length/3;return[a/d,b/d,c/d]}function f(a,b,c){a=c.split(a,2);
a=a[1].split(b,2);return a[0]}function q(a){return a.split(",").map(function(a){a=a.replace(/\n/g,"").replace(/^ +/gm,"");return a.split(" ").map(function(a){return parseFloat(a)})})}Object.defineProperty(a,"__esModule",{value:!0});var t,u,w,A,n,z;a.c=function(){jQuery("body").append('<div\n        id="mol-container"\n        class="mol-container"\n        style="display:none;"></div>');var a=jQuery("#mol-container");n=$3Dmol.createViewer(a,{backgroundColor:"white"})};a.Ka=function(a){jQuery.ajax("https://files.rcsb.org/view/1XDN.pdb",
{success:function(b){n.addModel(b,"pdb");a()},error:function(a,b,c){console.error("Failed to load PDB https://files.rcsb.org/view/1XDN.pdb: "+c)}})};a.setStyle=function(a,b,d){void 0===a&&(a=void 0);void 0===b&&(b=void 0);void 0===d&&(d=!0);a=void 0===a?{}:a;b=void 0===b?{cartoon:{color:"spectrum"}}:b;n.setStyle(a,b);n.render();d&&(z=n.exportVRML(),c(),p())};a.gb=p;a.Oa=function(b){a.l.scaling=new BABYLON.Vector3(1,1,1);a.l.position=new BABYLON.Vector3(0,0,0);e.a.render();var c=b.getBoundingInfo().boundingBox;
b=Object.keys(c.maximumWorld).map(function(a){return c.maximumWorld[a]-c.minimumWorld[a]});var d=a.l.getBoundingInfo().boundingBox,f=Object.keys(d.maximumWorld).map(function(a){return d.maximumWorld[a]-d.minimumWorld[a]});b=b.map(function(a,b){return a/f[b]});b=Math.min.apply(null,b);a.l.scaling=new BABYLON.Vector3(b,b,b);e.a.render();b=d.centerWorld.subtract(c.centerWorld);a.l.position=a.l.position.subtract(b);g.M()}});q("Mols/ThreeDMol",["require","exports","../Vars","./CommonLoader","./VRML"],
function(q,a,g,e,d){function c(a){d.c();d.Ka(function(){d.setStyle();d.Oa(g.a.getMeshByName("protein_box"));d.l.mb=!0;setTimeout(function(){console.log(d.l.getBoundingInfo().boundingBox.maximumWorld);console.log(d.l.getBoundingInfo().boundingBox.minimumWorld)},2E3);e.Ba(a)})}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(a){try{jQuery.getScript("https://3Dmol.csb.pitt.edu/build/3Dmol-min.js",function(){c(a)})}catch(m){c(a)}}});q("Mols/Load","require exports ../UI/GUI ../Vars ./CommonLoader ./ThreeDMol".split(" "),
function(q,a,g,e,d,c){Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){d.Ca();jQuery.getJSON("scene_info.json",function(a){!1===a.menuActive&&(e.b.na=!1);c.c(a);e.b.na&&g.c(a)})}});q("UI/LoadingScreens",["require","exports","../Vars"],function(q,a,g){function e(){clearInterval(d)}Object.defineProperty(a,"__esModule",{value:!0});var d;a.Pa=function(){document.getElementById("loading-container").outerHTML=""};a.fa=function(a){e();g.u.displayLoadingUI();g.u.loadingUIText=a};a.$a=function(){var a=
90;d=setInterval(function(){a+=.02*(99-a);g.u.displayLoadingUI();g.u.loadingUIText="Loading the main scene... "+a.toFixed(0)+"%"},100)};a.ab=e});q("UI/UI",["require","exports","../Vars"],function(q,a,g){function e(){jQuery("body").append('\n        <button\n          title="Click to switch to full screen"\n          id="fullscreen-button"\n          class="ui-button"\n          style="color:white;\n                 width:80px;\n                 right:20px;\n                 position:absolute;\n                 height:50px;\n                 bottom:80px;\n                 background-color:rgba(51,51,51,0.7);\n                 border:none;\n                 outline:none;\n                 cursor:pointer;">\n            <svg\n              style="position:relative; left:0.5px;"\n              width="48" height="48"\n              xmlns="http://www.w3.org/2000/svg"\n              xmlns:svg="http://www.w3.org/2000/svg"\n              clip-rule="evenodd">\n                <g class="layer">\n                    <path d="m47.799999,43.649999l-47.699999,0l0,-39.749999l47.699999,0l0,39.749999zm-1.9875,-37.762499l-43.724999,0l0,35.774999l43.724999,0l0,-35.774999zm-7.95,13.9125l-1.9875,0l0,-6.441487l-22.341487,22.341487l6.441487,0l0,1.9875l-9.9375,0l0,-9.9375l1.9875,0l0,6.441487l22.341487,-22.341487l-6.441487,0l0,-1.9875l9.9375,0l0,9.9375z" fill="#ffffff" id="svg_1"/>\n                </g>\n            </svg>\n        </button>\n\n        <button\n          title="Click for help"\n          id="help-button"\n          class="ui-button"\n          style="color:white;\n                 width:80px;\n                 right:20px;\n                 position:absolute;\n                 height:50px;\n                 bottom:140px;\n                 background-color:rgba(51,51,51,0.7);\n                 border:none;\n                 outline:none;\n                 cursor:pointer;">\n                 <svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n<path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="\n\tM35.5,9.8c1.7,5.4-0.6,8-1.6,8.9c-1.9,1.9-4.5,4.7-5.8,7c-1.5,2.7-4.1,12-6.8,4.4c-3.2-9.1,1.3-11.6,3.5-13.4\n\tc1.5-1.3,3.4-4.3,0.5-5.3c-4-1.3-6.1,5.3-10.7,4c-3-0.8-3.2-4.1-2.2-6.6C15.4,1.7,32.5,0.6,35.5,9.8L35.5,9.8z"/>\n<path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" d="M28.3,39.6c0-5.5-8.5-5.5-8.5,0S28.3,45.1,28.3,39.6\n\t"/>\n</svg>\n\n        </button>\n    ');
jQuery("#fullscreen-button").click(function(){g.u.switchFullscreen(!0);jQuery("#renderCanvas").focus()});jQuery("#help-button").click(function(){window.open("help/index.html","_blank")});document.getElementById("babylonVRiconbtn").style.opacity="1.0";document.getElementById("babylonVRiconbtn").style.filter="alpha(opacity=1.0)"}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){e()};window.debugMode=function(){g.a.debugLayer.show();setTimeout(function(){document.getElementById("inspector-host").style.zIndex=
"15";document.getElementById("scene-explorer-host").style.zIndex="15"},500)}});q("Scene/LoadAndSetup","require exports ../Cameras/Setup ../Cameras/VRCamera ../Mols/Load ../Navigation/Navigation ../Navigation/Pickables ../UI/LoadingScreens ../UI/UI ../Vars ./Optimizations".split(" "),function(q,a,g,e,d,c,p,m,r,b,f){function v(){var a=BABYLON.Mesh.CreateSphere("navTargetMesh",4,.1,b.a),c=new BABYLON.StandardMaterial("myMaterial",b.a);c.diffuseColor=new BABYLON.Color3(1,0,1);a.material=c;b.Ya({la:"ground",
oa:a});e.c();f.c();window.h=b}function t(a){m.fa("Loading the main scene...");BABYLON.SceneLoader.LoadAssetContainer("scene/","scene.babylon",b.a,function(c){m.$a();b.a.executeWhenReady(function(){c.addAllToScene();b.a.activeCamera=b.a.cameras[0];for(var d=!1,e=0;1<b.a.lights.length;){var g=b.a.lights[e].name.toLowerCase();-1===g.indexOf("shadowlight")&&-1===g.indexOf("shadow_light")?b.a.lights[e].dispose():d?b.a.lights[e].dispose():(d=!0,e++)}for(var l in b.a.meshes)"protein_box"===b.a.meshes[l].name&&
(b.a.getMeshByName("protein_box").isVisible=!1);for(var k in b.a.meshes)if(b.a.meshes[k].material){d=b.a.meshes[k];if(void 0===d.material.emissiveTexture||null===d.material.emissiveTexture)d.material.emissiveTexture=d.material.diffuseTexture,d.material.diffuseColor=new BABYLON.Color3(0,0,0),d.material.specularColor=new BABYLON.Color3(0,0,0),d.material.emissiveColor=new BABYLON.Color3(0,0,0);f.ja(d,!1);p.ma({G:d,a:b.a})}a()})},function(a){a.lengthComputable&&m.fa("Loading the main scene... "+Math.round(90*
a.loaded/a.total).toString()+"%")})}Object.defineProperty(a,"__esModule",{value:!0});a.load=function(){b.c();m.Pa();v();t(function(){g.c();c.c();p.c();r.c();d.c()});window.addEventListener("resize",function(){b.u.resize()})};a.La=function(){setTimeout(f.M,1E3);m.ab();b.a.activeCamera.maxZ=250;b.a.activeCamera.minZ=0;b.u.runRenderLoop(function(){b.a.render()})}});y.R({urlArgs:"bust="+(new Date).getTime()});y(["Scene/LoadAndSetup"],function(q){q.load()});q("Start",function(){})})();
