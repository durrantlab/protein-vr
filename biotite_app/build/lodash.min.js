/*
 almond 0.3.3 Copyright jQuery Foundation and other contributors.
 Released under MIT license, http://github.com/requirejs/almond/LICENSE
*/
var D="function"==typeof Object.defineProperties?Object.defineProperty:function(A,z,l){A!=Array.prototype&&A!=Object.prototype&&(A[z]=l.value)},E="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function F(A){if(A){for(var z=E,l=["Math","sign"],x=0;x<l.length-1;x++){var a=l[x];a in z||(z[a]={});z=z[a]}l=l[l.length-1];x=z[l];A=A(x);A!=x&&null!=A&&D(z,l,{configurable:!0,writable:!0,value:A})}}
F(function(A){return A?A:function(z){z=Number(z);return 0===z||isNaN(z)?z:0<z?1:-1}});
(function(){var A,z,l;(function(x){function a(a,k){var g,e;k=k&&k.split("/");var m=v.map,c=m&&m["*"]||{};if(a){a=a.split("/");var b=a.length-1;v.ib&&C.test(a[b])&&(a[b]=a[b].replace(C,""));"."===a[0].charAt(0)&&k&&(b=k.slice(0,k.length-1),a=b.concat(a));for(b=0;b<a.length;b++){var d=a[b];"."===d?(a.splice(b,1),--b):".."===d&&0!==b&&(1!==b||".."!==a[2])&&".."!==a[b-1]&&0<b&&(a.splice(b-1,2),b-=2)}a=a.join("/")}if((k||c)&&m){d=a.split("/");for(b=d.length;0<b;--b){var u=d.slice(0,b).join("/");if(k)for(e=
k.length;0<e;--e)if(g=m[k.slice(0,e).join("/")])if(g=g[u]){var f=g;var B=b;break}if(f)break;if(!y&&c&&c[u]){var y=c[u];var n=b}}!f&&y&&(f=y,B=n);f&&(d.splice(0,B,f),a=d.join("/"))}return a}function c(a,k){return function(){var g=w.call(arguments,0);"string"!==typeof g[0]&&1===g.length&&g.push(null);return q.apply(x,g.concat([a,k]))}}function b(g){return function(k){return a(k,g)}}function d(a){return function(g){e[a]=g}}function f(a){if(t.call(m,a)){var g=m[a];delete m[a];r[a]=!0;k.apply(x,g)}if(!t.call(e,
a)&&!t.call(r,a))throw Error("No "+a);return e[a]}function p(a){var g=a?a.indexOf("!"):-1;if(-1<g){var k=a.substring(0,g);a=a.substring(g+1,a.length)}return[k,a]}function n(a){return function(){return v&&v.S&&v.S[a]||{}}}var q,e={},m={},v={},r={},t=Object.prototype.hasOwnProperty,w=[].slice,C=/\.js$/;var u=function(g,k){g=p(g);var e=g[0];k=k[1];g=g[1];if(e){e=a(e,k);var m=f(e)}e?m&&m.normalize?g=m.normalize(g,b(k)):g=a(g,k):(g=a(g,k),g=p(g),e=g[0],g=g[1],e&&(m=f(e)));return{ia:e?e+"!"+g:g,n:g,jb:e,
p:m}};var y={Qa:function(a){return c(a)},I:function(a){var g=e[a];return"undefined"!==typeof g?g:e[a]={}},Na:function(a){return{id:a,uri:"",I:e[a],S:n(a)}}};var k=function(a,k,b,n){var g,B=[];var q=typeof b;var v=(n=n||a)?p(n):[];if("undefined"===q||"function"===q){k=!k.length&&b.length?["require","exports","module"]:k;for(g=0;g<k.length;g+=1){var w=u(k[g],v);q=w.ia;if("require"===q)B[g]=y.Qa(a);else if("exports"===q){B[g]=y.I(a);var G=!0}else if("module"===q)var l=B[g]=y.Na(a);else if(t.call(e,q)||
t.call(m,q)||t.call(r,q))B[g]=f(q);else if(w.p)w.p.load(w.n,c(n,!0),d(q),{}),B[g]=e[q];else throw Error(a+" missing "+q);}k=b?b.apply(e[a],B):void 0;a&&(l&&l.I!==x&&l.I!==e[a]?e[a]=l.I:k===x&&G||(e[a]=k))}else a&&(e[a]=b)};A=z=q=function(a,b,e,m,c){if("string"===typeof a)return y[a]?y[a](b):f(u(a,b?p(b):[]).ia);if(!a.splice){v=a;v.Da&&q(v.Da,v.eb);if(!b)return;b.splice?(a=b,b=e,e=null):a=x}b=b||function(){};"function"===typeof e&&(e=m,m=c);m?k(x,a,b,e):setTimeout(function(){k(x,a,b,e)},4);return q};
q.S=function(a){return q(a)};A.h=e;l=function(a,k,b){if("string"!==typeof a)throw Error("See almond README: incorrect module build, no module name");k.splice||(b=k,k=[]);t.call(e,a)||t.call(m,a)||(m[a]=[a,k,b])};l.h={jQuery:!0}})();l("external/almond",function(){});l("Scene/Vars",["require","exports"],function(l,a){Object.defineProperty(a,"__esModule",{value:!0});a.ea=11;a.X=1.5;a.da=1;a.ra=2E3;a.W=1.2;a.ta=2.5;a.sa=.1;a.ua=.01;a.xa=500;a.wa=750;a.N=.1;a.ca=15;a.va=.05;a.qa=/iPad|iPhone|iPod/.test(navigator.userAgent)&&
!window.MSStream;a.c=function(){a.canvas=document.getElementById("renderCanvas");a.u=new BABYLON.Engine(a.canvas,!0);BABYLON.Database.IDBStorageEnabled=!0;a.a=new BABYLON.Scene(a.u);window.scene=a.a};a.Ea=function(){if(void 0===a.R){var c=new BABYLON.Ray(a.a.activeCamera.position,new BABYLON.Vector3(0,-1,0),50);c=a.a.pickWithRay(c,function(a){return"ground"===a.name});a.R=c.distance}};a.Sa=function(c){a.R=c};a.Ya=function(c){var b={createDeviceOrientationCamera:!0};a.a.getEngine().getCaps().multiview&&
(b.useMultiview=!0);a.f=a.a.createDefaultVRExperience(b);document.getElementById("babylonVRiconbtn").style.opacity="0.0";document.getElementById("babylonVRiconbtn").style.filter="alpha(opacity=0)";window.vrHelper=a.f;a.b=c;a.b.na=!0}});l("Scene/Cameras/NonVRCamera",["require","exports","../Vars"],function(l,a,c){function b(){d.ellipsoid=new BABYLON.Vector3(1,.5*c.R,1)}Object.defineProperty(a,"__esModule",{value:!0});var d;new BABYLON.Vector3(0,0,0);a.c=function(){d=c.a.activeCamera;d.keysUp=[87,38];
d.keysDown=[83,40];d.keysLeft=[65,37];d.keysRight=[68,39];b();c.a.collisionsEnabled=!0;d.checkCollisions=!0;d.speed=.1;d.attachControl(c.canvas,!0);d._updatePosition()};a.Ra=b});l("Scene/LoadingScreens",["require","exports","./Vars"],function(l,a,c){function b(){clearInterval(d)}Object.defineProperty(a,"__esModule",{value:!0});var d;a.Pa=function(){document.getElementById("loading-container").outerHTML=""};a.fa=function(a){b();c.u.displayLoadingUI();c.u.loadingUIText=a};a.$a=function(){var a=90;d=
setInterval(function(){a+=.02*(99-a);c.u.displayLoadingUI();c.u.loadingUIText="Loading the main scene... "+a.toFixed(0)+"%"},100)};a.ab=b});l("Scene/Mols/Shadows",["require","exports","../Vars"],function(l,a,c){function b(){var a=c.a.lights[0],b=64,p=.9625,n=a.name.match(/blur_([0-9\.]+)/g);null!==n&&(b=parseFloat(n[0].substr(5)));a=a.name.match(/dark_([0-9\.]+)/g);null!==a&&(p=parseFloat(a[0].substr(5)));return{blur:b,T:p}}Object.defineProperty(a,"__esModule",{value:!0});a.Xa=function(){var d=c.a.lights[0],
f=b();f.cb=0;f.blur=2;console.log(f);c.qa?console.log("iOS, so not generating shadows... causes an error... See https://forum.babylonjs.com/t/issues-between-shadowgenerator-and-ios-osx/795"):(a.s=new BABYLON.ShadowGenerator(4096,d),a.s.useBlurExponentialShadowMap=!0,a.s.setDarkness(f.T),a.s.F=!0,a.s.h=f.blur,window.s=a.s)};a.Ga=b;a.Wa=function(){for(var a in c.a.meshes)if(c.a.meshes.hasOwnProperty(a)){var b=c.a.meshes[a];if(-1!==b.name.toLowerCase().indexOf("shadowcatcher")||-1!==b.name.toLowerCase().indexOf("shadow_catcher"))b.material=
new BABYLON.ShadowOnlyMaterial("shadow_catch"+a.toString(),c.a),b.material.activeLight=c.a.lights[0],b.receiveShadows=!0}}});l("Scene/VR/Optimizations",["require","exports","../Mols/Shadows","../Vars"],function(l,a,c,b){function d(a){if(void 0!==a){a=a.getVerticesData(BABYLON.VertexBuffer.PositionKind);if(null===a)return null;a=a.length/3}else a=0;return a}function f(){var a=new BABYLON.SceneOptimizerOptions(25,2E3),b=0;a.optimizations.push(new BABYLON.ShadowsOptimization(b));a.optimizations.push(new BABYLON.LensFlaresOptimization(b));
a.optimizations.push(new BABYLON.PostProcessesOptimization(b));a.optimizations.push(new BABYLON.ParticlesOptimization(b));a.optimizations.push(new p(b));b++;a.optimizations.push(new n(b));a.optimizations.push(new p(b));b++;a.optimizations.push(new BABYLON.TextureOptimization(b,512));a.optimizations.push(new p(b));b++;a.optimizations.push(new BABYLON.RenderTargetsOptimization(b));a.optimizations.push(new BABYLON.TextureOptimization(b,256));a.optimizations.push(new p(b));b++;a.optimizations.push(new BABYLON.HardwareScalingOptimization(b,
4));a.optimizations.push(new q(b,500));a.optimizations.push(new p(b));return a}function p(a){var c=this;"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){console.log("Optimization priority:",c.priority);console.log("FPS:",b.u.getFps());console.log("");return!0};this.getDescription=function(){return"Reports the current priority. For debugging."}}function n(a){"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){var a=b.a.getMeshByName("surfaces.wrl");null!==a&&a.dispose();
return!0};this.getDescription=function(){return"Removes surface representations."}}function q(a,c,f){void 0===f&&(f=void 0);"undefined"===typeof a&&(a=0);this.priority=a;this.apply=function(){var a=[],m;for(m in b.a.meshes)if(b.a.meshes.hasOwnProperty(m)){var e=b.a.meshes[m];if(-1===e.name.indexOf("Decimated")){var n=d(e);null!==n&&(n<c||a.push([n,e,void 0===f?1-c/n:f]))}}a.sort(function(a,b){return b[0]-a[0]});for(m in a)if(a.hasOwnProperty(m)){e=a[m][1];for(n=a[m][2];0<e.getLODLevels().length;){var u=
e.getLODLevels()[0].mesh;e.removeLODLevel(u);null!==u&&u.dispose()}e.simplify([{quality:n,distance:.001}],!1,BABYLON.SimplificationType.QUADRATIC,function(){})}return!0};this.getDescription=function(){return"Simplifies the geometry of complex objects in the scene."}}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){BABYLON.SceneOptimizer.OptimizeAsync(b.a,f());b.a.autoClear=!1;b.a.autoClearDepthAndStencil=!1;for(var a in b.a.meshes)if(b.a.meshes.hasOwnProperty(a)){var c=b.a.meshes[a];
-1!==c.name.indexOf("baked")&&void 0!==c.material&&(c.material.diffuseColor=new BABYLON.Color3(0,0,0),c.material.specularColor=new BABYLON.Color3(0,0,0),c.material.emissiveTexture=c.material.diffuseTexture,c.material.diffuseTexture=null,c.freezeWorldMatrix())}};a.aa=function(a){var c=d(a);null===c||100>c||(c=1+Math.floor(c/b.ra),1<c&&a.subdivide(c),a.createOrUpdateSubmeshesOctree(64,2),a.useOctreeForCollisions=!0)};a.ja=function(a,b){void 0===b&&(b=!0);b&&a.material.freeze()};a.M=function(){c.s&&
(b.a.lights[0].autoUpdateExtends=!0,c.s.getShadowMap().refreshRate=BABYLON.RenderTargetTexture.REFRESHRATE_RENDER_ONCE,b.a.lights[0].autoUpdateExtends=!1)}});l("Scene/VR/Navigation","require exports ../Cameras/CommonCamera ../Cameras/NonVRCamera ../Vars ./Optimizations ./Pickables ./Points".split(" "),function(l,a,c,b,d,f,p,n){function q(){w=c.o();d.a.registerBeforeRender(function(){var a=c.o();null===n.Ja(a).pickedMesh?c.pa(w):w=a})}function e(){jQuery("body").keypress(function(a){32===a.charCode&&
m()})}function m(){var a=(new Date).getTime();if(!(250>a-x))switch(x=a,console.log("hi"),p.Ha()){case 2:console.log("teleport");v();break;case 4:r();break;case 3:p.A.w()}}function v(a,b){void 0===a&&(a=void 0);void 0===b&&(b=void 0);void 0===b&&(b=function(){});d.f.gazeTrackerMesh.isVisible=!1;var k=new BABYLON.Animation("animationCameraTeleportation","position",90,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),g=c.o();void 0===a&&(a=new BABYLON.Vector3(n.i.x,
n.i.y+d.R,n.i.z));var e=c.Ia();a=a.subtract(e);g=g.subtract(e);k.setKeys([{frame:0,value:g},{frame:d.ea,value:a}]);var u=d.a.activeCamera;u.animations=[];u.animations.push(k);d.a.beginAnimation(u,0,d.ea,!1,1,function(){d.f.gazeTrackerMesh.isVisible=!0;u.animations=[];b()})}function r(){var a=n.Z,g=c.o(),e=n.i.subtract(g),u=e.length(),m;.1*u<d.da?m=n.i.subtract(e.normalize().scale(d.da)):.1*u>d.X?m=n.i.subtract(e.normalize().scale(d.X)):.1*u<d.X&&(m=g.add(e.scale(.9)));m.y=n.i.y;m.y-a.y<.5*d.W+.1&&
(m.y=a.y+.5*d.W+.1);d.Sa(n.i.y-a.y);v(m,function(){b.Ra()})}function t(){u=jQuery("#capture-clicks");u.click(function(){console.log("clicked!");m()});d.a.registerBeforeRender(function(){var a=d.a.activeCamera.inputs.attached.deviceOrientation;(a=a?0!==a._alpha||0!==a._beta||0!==a._gamma:!1)&&!y?(y=!0,u.show()):!a&&y&&(y=!1,u.fb())})}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){d.b.m=d.a.getMeshByID(d.b.la);null===d.b.m&&alert("No mesh named "+d.b.la);d.b.m.checkCollisions=!0;d.b.m.visibility=
0;f.aa(d.b.m);p.ma({O:m,G:d.b.m});d.b.g=3;e();n.c();t();q()};var w,x=0;a.C=m;var u=void 0,y=!1});l("Scene/VR/Pickables","require exports ../Cameras/CommonCamera ../Vars ./Navigation ./Optimizations".split(" "),function(l,a,c,b,d,f){function p(a){void 0===a.O&&(a.O=d.C);void 0===a.a&&(a.a=b.a);void 0!==a.G&&(a.G.ya=new BABYLON.ActionManager(a.a),a.G.ya.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){3===b.b.g&&a.O()})))}Object.defineProperty(a,"__esModule",
{value:!0});var n=[],q=[],e=[];a.H=function(b){a.A=b};a.c=function(){n.push(b.b.m)};a.za=function(a){n.push(a);q.push(a);f.aa(a);p({G:a,O:function(){a.w()}})};a.Aa=function(a){n.push(a);e.push(a);f.aa(a);p({G:a})};a.ha=function(a){return a.id===b.b.m.id?!0:a.isVisible?-1!==n.indexOf(a):!1};a.Ha=function(){return void 0===a.A?1:a.A===b.b.m?2:-1!==q.indexOf(a.A)?3:-1!==e.indexOf(a.A)?4:a.A===a.D?5:1};a.ma=p;a.Ma=function(){a.D=BABYLON.Mesh.CreateSphere("padNavSphereAroundCamera",4,b.ca-1,b.a);a.D.flipFaces(!0);
var e=new BABYLON.StandardMaterial("padNavSphereAroundCameraMat",b.a);e.diffuseColor=new BABYLON.Color3(1,1,1);e.specularColor=new BABYLON.Color3(0,0,0);e.h=null;a.D.material=e;a.D.visibility=0;b.a.registerBeforeRender(function(){a.D.position=c.o()});n.push(a.D)}});l("Scene/VR/Points",["require","exports","../Cameras/CommonCamera","../Vars","./Pickables"],function(l,a,c,b,d){function f(b){a.i.copyFrom(b)}function p(){if(3===b.b.g)var e=b.a.activeCamera.getForwardRay();else if(2===b.b.g||1===b.b.g){e=
void 0;1===b.b.g?(e=b.f.rightControllerGazeTrackerMesh,e||(e=b.f.leftControllerGazeTrackerMesh)):2===b.b.g&&(e=b.f.gazeTrackerMesh);if(!e){console.log("error!");return}e.isVisible?f(e.absolutePosition):f(a.K);e=c.o();e=new BABYLON.Ray(e,a.i.subtract(e))}else console.log("Unexpected error.");n(e)}function n(c,n){void 0===n&&(n=!0);c=b.a.pickWithRay(c,function(a){return d.ha(a)});c.hit&&c.distance<b.ca?(n&&f(c.pickedPoint),d.H(c.pickedMesh)):(f(a.K),d.H(void 0))}function q(a){a=new BABYLON.Ray(a,new BABYLON.Vector3(0,
-1,0),50);return b.a.pickWithRay(a,function(a){return a.id===b.b.m.id})}Object.defineProperty(a,"__esModule",{value:!0});a.K=new BABYLON.Vector3(-1E3,1E3,1E3);a.Y=new BABYLON.Vector3(0,0,0);a.Z=new BABYLON.Vector3(0,0,0);a.i=new BABYLON.Vector3(0,0,0);a.kb=f;a.c=function(){b.a.registerBeforeRender(function(){p();void 0===a.i?(f(a.K),d.H(void 0)):10<BABYLON.Vector3.Distance(c.o(),a.i)&&(f(a.K),d.H(void 0));b.b.oa.position.copyFrom(a.i);void 0!==d.A&&(b.b.oa.isVisible=d.A!==d.D);var e=q(c.o()).pickedPoint;
e&&(a.Y=e);if(e=q(a.i).pickedPoint)a.Z=e})};a.lb=p;a.Ja=q});l("Scene/Cameras/CommonCamera",["require","exports","../Vars","../VR/Points"],function(l,a,c,b){function d(){if(3===c.b.g)return new BABYLON.Vector3(0,0,0);var a=c.f.webVRCamera,b;a.leftCamera?b=a.leftCamera.globalPosition.subtract(a.position):b=new BABYLON.Vector3(0,0,0);return b}Object.defineProperty(a,"__esModule",{value:!0});var f=new BABYLON.Vector3(1,0,0),p=new BABYLON.Vector3(1,0,0);a.o=function(){var a=c.a.activeCamera,b=a.position.clone();
if(2===c.b.g||1===c.b.g)a.leftCamera?b.copyFrom(a.leftCamera.globalPosition):console.log("Prob here");return b};a.pa=function(a){if(3===c.b.g){var b=c.a.activeCamera;b.position.copyFrom(a)}else if(2===c.b.g||1===c.b.g)b=c.f.webVRCamera,b.position.copyFrom(a.subtract(d()))};a.ka=function(){if(2===c.b.g||1===c.b.g){var a=b.Z.subtract(b.Y),d=BABYLON.Vector3.GetAngleBetweenVectors(a,f,p);for(0>a.z&&(d=-d);0>d;)d+=2*Math.PI;for(;d>2*Math.PI;)d-=2*Math.PI;return d+=.5*Math.PI}return c.a.activeCamera.rotation.clone().y};
a.Ia=d});l("Scene/VR/VoiceCommands",["require","exports","../Vars","./Navigation","./Optimizations"],function(l,a,c,b,d){function f(c){function d(a){function b(a){if(v.hasOwnProperty(a)){var b=v[a];if(""!==b){a=function(a){if(r.hasOwnProperty(a)){var c=r[a];""!==c&&(k[d+" "+b+" "+c]=function(){e([b,c],u)})}};for(var c in r)a(c)}}}function c(a){if(r.hasOwnProperty(a)){var b=r[a];""!==b&&(k[d+" "+b]=function(){e([b],u)})}}function g(a){if(v.hasOwnProperty(a)){var b=v[a];""!==b&&(k[d+" "+b]=function(){e([b],
u)})}}var d=["hide","show","high"][a],u="show"===d,f;for(f in v)g(f);for(var n in r)c(n);for(f in v)b(f);k[d+" surface"]=function(){e(["Surfaces"],u)}}var k={};void 0===a.j&&q(c);for(c=0;3>c;c++)d(c);k.teleport=function(){b.C()};k.click=function(){b.C()};k.move=function(){b.C()};k.look=function(){b.C()};k.hiya=function(){b.C()};annyang&&(annyang.debug(),annyang.removeCommands(),annyang.addCommands(k),annyang.start());w||(x.speak("The show and hide commands control visualization. For example, show proteen or hide ribbon. The teleport command moves your position to the stair point sphere."),
w=!0)}function p(a){return a.charAt(0).toUpperCase()+a.substring(1)}function n(a){a=a.replace(/.sdf/g,"").replace(/.pdb/g,"");a=a.replace(/.wrl/g,"");a=a.replace(/surfaces/g,"Surfaces");var b=a.split("_");a=b[0];if("Surfaces"===a)return{key:"Surfaces",v:a,B:""};b=b[1].replace(/[A-Z]/g,function(a){return"_"+a}).split(/_/g)[1];a=p(a);b=p(b);return{key:a+"_"+b,v:a,B:b}}function q(b){a.j={};for(var c in b.objIDs)if(b.objIDs.hasOwnProperty(c)){var k=b.objIDs[c],g=n(k);void 0===a.j[g.key]&&(a.j[g.key]=
{description:g.key.replace(/_/g," "),U:[],v:g.v,B:g.B});a.j[g.key].U.push(k);-1===v.indexOf(g.v)&&v.push(g.v);-1===r.indexOf(g.B)&&r.push(g.B)}}function e(b,c){for(var k in a.j)if(a.j.hasOwnProperty(k)){var g=a.j[k];a:{var d=void 0;var e=b,f=[g.v,g.B];for(d in e)if(e.hasOwnProperty(d)&&-1===f.indexOf(e[d])){d=!1;break a}d=!0}d&&m(g.v,g.B,c)}}function m(b,e,k){b=p(b);""!==e&&(b+="_"+p(e));for(var g in a.j[b].U)a.j[b].U.hasOwnProperty(g)&&(c.a.getMeshByName(a.j[b].U[g]).isVisible=k);d.M()}Object.defineProperty(a,
"__esModule",{value:!0});var v=[],r=[],t=!1,w=!1;a.c=function(a){t?f(a):jQuery.getScript("js/annyang.min.js",function(){f(a);t=!0})};a.Ta=q;a.hb=e;a.Za=m;a.bb=function(){annyang.abort()};var x=new (function(){function a(){var a=this;this.V=null;jQuery(document).ready(function(){"speechSynthesis"in window&&(a.V=window.speechSynthesis.getVoices(),window.speechSynthesis.onvoiceschanged=function(){a.V=window.speechSynthesis.getVoices()})})}a.prototype.speak=function(a){if(null!==this.V){a=new SpeechSynthesisUtterance(a);
a.rate=1;var b=this.V.filter(function(a){return-1<a.name.toUpperCase().indexOf("SAMANTHA")});0<b.length&&(a.voice=b[0]);a.lang="en";a.volume=1;annyang&&annyang.abort();window.speechSynthesis.speak(a);setTimeout(function(){annyang&&annyang.start()},2E3)}};return a}())});l("Scene/GUI","require exports ./Cameras/CommonCamera ./Vars ./VR/Pickables ./VR/Points ./VR/VoiceCommands".split(" "),function(l,a,c,b,d,f,p){function n(a){function c(a){if(p.j.hasOwnProperty(a)){var b=p.j[a];a=b.description;m.push(new x({w:function(a){p.Za(b.v,
b.B,!a.value)},default:!1,J:a+"\n(Hide)",$:function(a){a.isVisible(!1)},name:"menu-visible-button-"+b.v.replace(/ /g,"").replace(/\n/g,""),ba:w,L:a+"\n(Show)"}))}}p.Ta(a);v=new BABYLON.GUI.GUI3DManager(b.a);w=new BABYLON.GUI.CylinderPanel;v.addControl(w);w.h=!0;for(var k in p.j)c(k);q(w,a);w.h=!1;r=new BABYLON.TransformNode("");w.linkToTransformNode(r);setInterval(function(){w.radius=b.ta;w.margin=b.sa},1E3);window.cylinderPanelMainMenu=w}function q(a,b){m.push(new x({w:function(a){a.value?p.c(b):
p.bb()},default:!1,J:"Audio Commands\n(On)",$:function(a){a.isVisible(!1)},name:"menu-audio-commands-button",ba:a,L:"Audio Commands\n(Off)"}))}function e(){var a=new BABYLON.GUI.GUI3DManager(b.a),d=new BABYLON.GUI.StackPanel3D;a.addControl(d);new x({w:function(a){for(var b in m)m.hasOwnProperty(b)&&m[parseInt(b,10)].isVisible(a.value);r.position.copyFrom(c.o());r.rotation.y=c.ka()},default:!1,J:"Show Menu",name:"menu-visible-button",ba:d,L:"Hide Menu"});var k=new BABYLON.TransformNode("");d.linkToTransformNode(k);
k.rotation.x=.5*Math.PI;b.a.registerBeforeRender(function(){k.position.copyFrom(f.Y);k.position.y+=.1;k.rotation.y=c.ka()})}Object.defineProperty(a,"__esModule",{value:!0});var m=[],v,r,t,w;a.c=function(a){n(a);e();t=new BABYLON.Sound("click-button","assets/staple-public-domain.mp3",b.a,null,{loop:!1,autoplay:!1,nb:!0,volume:.1})};var x=function(){function a(a){var c=this;this.button=new BABYLON.GUI.HolographicButton(a.name);a.ba.addControl(this.button);this.F=new BABYLON.GUI.TextBlock;this.F.color=
"white";this.F.h=!0;this.value=a.default;this.L=a.L;this.J=a.J;this.w=a.w;this.ga();this.h=BABYLON.Mesh.CreateSphere(a.name+"-container-mesh",2,b.W,b.a);this.h.position=this.button.node.absolutePosition;this.h.visibility=0;this.h.w=function(){c.Fa()};d.za(this.h);void 0!==a.$&&a.$(this)}a.prototype.isVisible=function(a){if(void 0===a)return this.button.isVisible;this.button.isVisible=a;this.h.isVisible=a};a.prototype.ga=function(){this.F.text=this.value?this.L:this.J;this.button.content.dispose();
this.button.content=this.F};a.prototype.Fa=function(){t.setPosition(this.h.position.clone());t.play();this.value=!this.value;this.w(this);this.ga()};return a}()});l("Scene/Mols/CommonLoader","require exports ../Load ../Vars ../VR/Optimizations ../VR/Pickables ./Shadows".split(" "),function(l,a,c,b,d,f,p){Object.defineProperty(a,"__esModule",{value:!0});a.Ca=function(){p.Xa();BABYLON.OBJFileLoader.OPTIMIZE_WITH_UV=!0};a.Ba=function(a){p.Wa();void 0!==a.transparentGround&&!0===a.transparentGround&&
(b.b.m?(b.b.m.visibility=1,a=new BABYLON.StandardMaterial("transparentGround",b.a),a.diffuseColor=new BABYLON.Color3(1,1,1),a.specularColor=new BABYLON.Color3(0,0,0),a.emissiveColor=new BABYLON.Color3(0,0,0),a.alpha=b.va,b.b.m.material=a):console.log("Warning: Vars.vrVars.groundMesh not defined."));c.La()};a.Va=function(a){if(void 0!==a.material&&null!==a.material){var b=p.Ga();b=.95<b.T?.01:.4>b.T?.0025:.013636363636363637*b.T-.0029545454545454545;a.material.emissiveColor=new BABYLON.Color3(b,b,
b);d.ja(a)}a.scaling.z=-1;a.scaling.x=-1;p.s&&p.s.getShadowMap().renderList.push(a);f.Aa(a)}});l("Scene/Mols/VRML",["require","exports","../Vars","../VR/Optimizations","./CommonLoader"],function(l,a,c,b,d){function f(){var a=v(m("point [","]",y));a=a.map(function(a){return[a[2],a[1],a[0]]});r=[].concat.apply([],a);r=n(r);q(e().map(function(a){return-a}));a=v(m("vector [","]",y));t=[].concat.apply([],a);t=n(t);a=v(m("color [","]",y));a=a.map(function(a){return[a[0],a[1],a[2],1]});w=[].concat.apply([],
a);w=n(w);x=m("coordIndex [","]",y).split(",").map(function(a){return parseInt(a,10)}).filter(function(a){return-1!==a&&!isNaN(a)&&void 0!==a})}function p(){var b=new BABYLON.VertexData;b.positions=r;b.indices=x;b.normals=t;b.colors=w;a.l=new BABYLON.Mesh("MeshFrom3DMol",c.a);b.applyToMesh(a.l);b=new BABYLON.StandardMaterial("Material",c.a);b.diffuseColor=new BABYLON.Color3(1,1,1);b.emissiveColor=new BABYLON.Color3(0,0,0);b.specularColor=new BABYLON.Color3(0,0,0);b.sideOrientation=BABYLON.Mesh.h;
a.l.material=b;d.Va(a.l)}function n(a){return a.filter(function(a){return!isNaN(a)&&void 0!==a})}function q(a){r=r.map(function(b,c){return b+a[c%3]})}function e(){var a=r.map(function(a,b){return 0===b%3?a:0}).reduce(function(a,b){return a+b}),b=r.map(function(a,b){return 1===b%3?a:0}).reduce(function(a,b){return a+b}),c=r.map(function(a,b){return 2===b%3?a:0}).reduce(function(a,b){return a+b}),d=r.length/3;return[a/d,b/d,c/d]}function m(a,b,c){a=c.split(a,2);a=a[1].split(b,2);return a[0]}function v(a){return a.split(",").map(function(a){a=
a.replace(/\n/g,"").replace(/^ +/gm,"");return a.split(" ").map(function(a){return parseFloat(a)})})}Object.defineProperty(a,"__esModule",{value:!0});var r,t,w,x,u,y;a.c=function(){jQuery("body").append('<div\n        id="mol-container"\n        class="mol-container"\n        style="display:none;"></div>');var a=jQuery("#mol-container");u=$3Dmol.createViewer(a,{backgroundColor:"white"})};a.Ka=function(a){jQuery.ajax("https://files.rcsb.org/view/1XDN.pdb",{success:function(b){u.addModel(b,"pdb");a()},
error:function(a,b,c){console.error("Failed to load PDB https://files.rcsb.org/view/1XDN.pdb: "+c)}})};a.setStyle=function(a,b,c){void 0===a&&(a=void 0);void 0===b&&(b=void 0);void 0===c&&(c=!0);a=void 0===a?{}:a;b=void 0===b?{cartoon:{color:"spectrum"}}:b;u.setStyle(a,b);u.render();c&&(y=u.exportVRML(),f(),p())};a.gb=p;a.Oa=function(d){a.l.scaling=new BABYLON.Vector3(1,1,1);a.l.position=new BABYLON.Vector3(0,0,0);c.a.render();var e=d.getBoundingInfo().boundingBox;d=Object.keys(e.maximumWorld).map(function(a){return e.maximumWorld[a]-
e.minimumWorld[a]});var f=a.l.getBoundingInfo().boundingBox,k=Object.keys(f.maximumWorld).map(function(a){return f.maximumWorld[a]-f.minimumWorld[a]});d=d.map(function(a,b){return a/k[b]});d=Math.min.apply(null,d);a.l.scaling=new BABYLON.Vector3(d,d,d);c.a.render();d=f.centerWorld.subtract(e.centerWorld);a.l.position=a.l.position.subtract(d);b.M()}});l("Scene/Mols/ThreeDMol",["require","exports","../Vars","./CommonLoader","./VRML"],function(l,a,c,b,d){function f(a){d.c();d.Ka(function(){d.setStyle();
d.Oa(c.a.getMeshByName("protein_box"));d.l.mb=!0;setTimeout(function(){console.log(d.l.getBoundingInfo().boundingBox.maximumWorld);console.log(d.l.getBoundingInfo().boundingBox.minimumWorld)},2E3);b.Ba(a)})}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(a){try{jQuery.getScript("https://3Dmol.csb.pitt.edu/build/3Dmol-min.js",function(){f(a)})}catch(n){f(a)}}});l("Scene/Mols/Load","require exports ../GUI ../Vars ./CommonLoader ./ThreeDMol".split(" "),function(l,a,c,b,d,f){Object.defineProperty(a,
"__esModule",{value:!0});a.c=function(){d.Ca();jQuery.getJSON("scene_info.json",function(a){!1===a.menuActive&&(b.b.na=!1);f.c(a);b.b.na&&c.c(a)})}});l("Scene/VR/UI",["require","exports","../Vars"],function(l,a,c){function b(){jQuery("body").append('\n        <button\n          title="Click to switch to full screen"\n          id="fullscreen-button"\n          class="ui-button"\n          style="color:white;\n                 width:80px;\n                 right:20px;\n                 position:absolute;\n                 height:50px;\n                 bottom:80px;\n                 background-color:rgba(51,51,51,0.7);\n                 border:none;\n                 outline:none;\n                 cursor:pointer;">\n            <svg\n              style="position:relative; left:0.5px;"\n              width="48" height="48"\n              xmlns="http://www.w3.org/2000/svg"\n              xmlns:svg="http://www.w3.org/2000/svg"\n              clip-rule="evenodd">\n                <g class="layer">\n                    <path d="m47.799999,43.649999l-47.699999,0l0,-39.749999l47.699999,0l0,39.749999zm-1.9875,-37.762499l-43.724999,0l0,35.774999l43.724999,0l0,-35.774999zm-7.95,13.9125l-1.9875,0l0,-6.441487l-22.341487,22.341487l6.441487,0l0,1.9875l-9.9375,0l0,-9.9375l1.9875,0l0,6.441487l22.341487,-22.341487l-6.441487,0l0,-1.9875l9.9375,0l0,9.9375z" fill="#ffffff" id="svg_1"/>\n                </g>\n            </svg>\n        </button>\n\n        <button\n          title="Click for help"\n          id="help-button"\n          class="ui-button"\n          style="color:white;\n                 width:80px;\n                 right:20px;\n                 position:absolute;\n                 height:50px;\n                 bottom:140px;\n                 background-color:rgba(51,51,51,0.7);\n                 border:none;\n                 outline:none;\n                 cursor:pointer;">\n                 <svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n\t x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n<path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="\n\tM35.5,9.8c1.7,5.4-0.6,8-1.6,8.9c-1.9,1.9-4.5,4.7-5.8,7c-1.5,2.7-4.1,12-6.8,4.4c-3.2-9.1,1.3-11.6,3.5-13.4\n\tc1.5-1.3,3.4-4.3,0.5-5.3c-4-1.3-6.1,5.3-10.7,4c-3-0.8-3.2-4.1-2.2-6.6C15.4,1.7,32.5,0.6,35.5,9.8L35.5,9.8z"/>\n<path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" d="M28.3,39.6c0-5.5-8.5-5.5-8.5,0S28.3,45.1,28.3,39.6\n\t"/>\n</svg>\n\n        </button>\n    ');
jQuery("#fullscreen-button").click(function(){c.u.switchFullscreen(!0);jQuery("#renderCanvas").focus()});jQuery("#help-button").click(function(){window.open("help/index.html","_blank")});document.getElementById("babylonVRiconbtn").style.opacity="1.0";document.getElementById("babylonVRiconbtn").style.filter="alpha(opacity=1.0)"}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){b()};window.debugMode=function(){c.a.debugLayer.show();setTimeout(function(){document.getElementById("inspector-host").style.zIndex=
"15";document.getElementById("scene-explorer-host").style.zIndex="15"},500)}});l("Scene/VR/General",["require","exports","./Navigation","./Pickables","./UI"],function(l,a,c,b,d){Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){c.c();b.c();d.c()}});l("Scene/Cameras/VRControllers","require exports ../Vars ../VR/Navigation ../VR/Pickables ../VR/Points ./CommonCamera ./VRCamera".split(" "),function(l,a,c,b,d,f,p,n){function q(a){a.onTriggerStateChangedObservable.add(function(a){a.pressed&&
(a=(new Date).getTime(),a-m>c.xa&&(m=a,b.C()))})}function e(a){a.onPadStateChangedObservable.add(function(a){(w=a.pressed)&&Math.abs(r)<c.N&&Math.abs(t)<c.N&&console.log("Would reset camera view if you didn't get an error below...")});a.onPadValuesChangedObservable.add(function(a){r=a.y;t=a.x;Math.abs(t)<c.N&&Math.abs(r)<c.N?t=r=0:.5>Math.abs(t)?t=0:(t+=0<t?-.5:.5,t=2*t)});c.a.registerBeforeRender(function(){if(w){if(!f.i.equals(f.K)){var a=p.o(),b=f.i.subtract(a);b.normalize();b=b.scale(r*c.ua*c.a.getAnimationRatio());
p.pa(a.subtract(b))}0!==t&&(a=(new Date).getTime(),a-v<c.wa||(v=a,a=c.f.webVRCamera.rotationQuaternion.toEulerAngles(),a.y+=.25*Math.sign(t)*Math.PI,c.f.webVRCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(a)))}})}Object.defineProperty(a,"__esModule",{value:!0});var m=0,v=0,r=0,t=0,w=!1;a.c=function(){d.Ma();c.f.webVRCamera.onControllerMeshLoadedObservable.add(function(a){c.b.g=1;console.log("controller loaded");n.Ua();console.log("Isnt there on pickable or something");q(a);e(a)})}});
l("Scene/Cameras/VRCamera","require exports ../Vars ../VR/Optimizations ../VR/Pickables ./VRControllers".split(" "),function(l,a,c,b,d,f){function p(){c.f.onEnteringVRObservable.add(function(){c.b.g=2;q();d.H(void 0);b.M();window.vrHelper=c.f});c.f.onExitingVRObservable.add(function(){c.b.g=3;d.H(void 0);b.M()})}function n(){var a=new BABYLON.Mesh("vrNavTargetMesh",c.a),b=new BABYLON.VertexData;b.F=[0,0,0];b.h=[0];b.applyToMesh(a);a.isVisible=!1;return a}function q(){c.f.raySelectionPredicate=function(a){return d.ha(a)};
c.f.gazeTrackerMesh=n();c.f.updateGazeTrackerScale=!1;c.f.displayGaze=!0;c.f.enableInteractions()}Object.defineProperty(a,"__esModule",{value:!0});a.c=function(){p();f.c()};a.Ua=q});l("Scene/VR/Load",["require","exports","../Cameras/VRCamera","../Vars","./Optimizations"],function(l,a,c,b,d){Object.defineProperty(a,"__esModule",{value:!0});a.c=function(a){b.Ya(a);c.c();d.c();window.h=b}});l("Scene/Load","require exports ./Cameras/NonVRCamera ./LoadingScreens ./Mols/Load ./Vars ./VR/General ./VR/Load ./VR/Optimizations ./VR/Pickables".split(" "),
function(l,a,c,b,d,f,p,n,q,e){function m(a){b.fa("Loading the main scene...");BABYLON.SceneLoader.LoadAssetContainer("scene/","scene.babylon",f.a,function(c){b.$a();f.a.executeWhenReady(function(){c.addAllToScene();f.a.activeCamera=f.a.cameras[0];for(var b=!1,d=0;1<f.a.lights.length;){var l=f.a.lights[d].name.toLowerCase();-1===l.indexOf("shadowlight")&&-1===l.indexOf("shadow_light")?f.a.lights[d].dispose():b?f.a.lights[d].dispose():(b=!0,d++)}for(var m in f.a.meshes)"protein_box"===f.a.meshes[m].name&&
(f.a.getMeshByName("protein_box").isVisible=!1);for(m in f.a.meshes)if(f.a.meshes[m].material){b=f.a.meshes[m];if(void 0===b.material.emissiveTexture||null===b.material.emissiveTexture)b.material.emissiveTexture=b.material.diffuseTexture,b.material.diffuseColor=new BABYLON.Color3(0,0,0),b.material.specularColor=new BABYLON.Color3(0,0,0),b.material.emissiveColor=new BABYLON.Color3(0,0,0);q.ja(b,!1);e.ma({G:b,a:f.a})}a()})},function(a){a.lengthComputable&&b.fa("Loading the main scene... "+Math.round(90*
a.loaded/a.total).toString()+"%")})}Object.defineProperty(a,"__esModule",{value:!0});a.load=function(){f.c();b.Pa();var e=BABYLON.Mesh.CreateSphere("navTargetMesh",4,.1,f.a),l=new BABYLON.StandardMaterial("myMaterial",f.a);l.diffuseColor=new BABYLON.Color3(1,0,1);e.material=l;n.c({la:"ground",oa:e});m(function(){a.P=f.a.cameras.filter(function(a){return-1===a.name.indexOf("VR")})[0];var b=new BABYLON.DeviceOrientationCamera("DevOr_camera",a.P.position.clone(),f.a,!0);b.rotation=a.P.rotation;window.cameraFromBabylonFile=
a.P;window.DevOrCamera=b;f.a.activeCamera=b;f.a.activeCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(a.P.rotation);f.Ea();c.c();p.c();d.c()});window.addEventListener("resize",function(){f.u.resize()})};a.La=function(){setTimeout(q.M,1E3);b.ab();f.a.activeCamera.maxZ=250;f.a.activeCamera.minZ=0;f.u.runRenderLoop(function(){f.a.render()})}});l("Game",["require","exports","./Scene/Load"],function(l,a,c){Object.defineProperty(a,"__esModule",{value:!0});a.start=function(){c.load()}});z.S({urlArgs:"bust="+
(new Date).getTime()});z(["Game"],function(l){l.start("renderCanvas")});l("Start",function(){})})();
