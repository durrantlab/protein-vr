/**
 * ProteinVR (The 3-Clause BSD License)
 * 
 * Copyright 2019 Jacob D. Durrant.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holder nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
(function(){'use strict';function T(G){var c=0;return function(){return c<G.length?{done:!1,value:G[c++]}:{done:!0}}}var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(G,c,a){G!=Array.prototype&&G!=Object.prototype&&(G[c]=a.value)},U="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;
function V(G,c){if(c){var a=U;G=G.split(".");for(var x=0;x<G.length-1;x++){var B=G[x];B in a||(a[B]={});a=a[B]}G=G[G.length-1];x=a[G];c=c(x);c!=x&&null!=c&&aa(a,G,{configurable:!0,writable:!0,value:c})}}V("Array.prototype.find",function(G){return G?G:function(c,a){a:{var x=this;x instanceof String&&(x=String(x));for(var B=x.length,F=0;F<B;F++){var f=x[F];if(c.call(a,f,F,x)){c=f;break a}}c=void 0}return c}});
function W(G){var c="undefined"!=typeof Symbol&&Symbol.iterator&&G[Symbol.iterator];return c?c.call(G):{next:T(G)}}
V("Promise",function(G){function c(f){this.G=0;this.L=void 0;this.B=[];var n=this.I();try{f(n.resolve,n.reject)}catch(u){n.reject(u)}}function a(){this.B=null}function x(f){return f instanceof c?f:new c(function(n){n(f)})}if(G)return G;a.prototype.G=function(f){if(null==this.B){this.B=[];var n=this;this.I(function(){n.L()})}this.B.push(f)};var B=U.setTimeout;a.prototype.I=function(f){B(f,0)};a.prototype.L=function(){for(;this.B&&this.B.length;){var f=this.B;this.B=[];for(var n=0;n<f.length;++n){var u=
f[n];f[n]=null;try{u()}catch(r){this.K(r)}}}this.B=null};a.prototype.K=function(f){this.I(function(){throw f;})};c.prototype.I=function(){function f(r){return function(m){u||(u=!0,r.call(n,m))}}var n=this,u=!1;return{resolve:f(this.ua),reject:f(this.K)}};c.prototype.ua=function(f){if(f===this)this.K(new TypeError("A Promise cannot resolve to itself"));else if(f instanceof c)this.va(f);else{a:switch(typeof f){case "object":var n=null!=f;break a;case "function":n=!0;break a;default:n=!1}n?this.ta(f):
this.X(f)}};c.prototype.ta=function(f){var n=void 0;try{n=f.then}catch(u){this.K(u);return}"function"==typeof n?this.wa(n,f):this.X(f)};c.prototype.K=function(f){this.Y(2,f)};c.prototype.X=function(f){this.Y(1,f)};c.prototype.Y=function(f,n){if(0!=this.G)throw Error("Cannot settle("+f+", "+n+"): Promise already settled in state"+this.G);this.G=f;this.L=n;this.sa()};c.prototype.sa=function(){if(null!=this.B){for(var f=0;f<this.B.length;++f)F.G(this.B[f]);this.B=null}};var F=new a;c.prototype.va=function(f){var n=
this.I();f.$(n.resolve,n.reject)};c.prototype.wa=function(f,n){var u=this.I();try{f.call(n,u.resolve,u.reject)}catch(r){u.reject(r)}};c.prototype.then=function(f,n){function u(C,p){return"function"==typeof C?function(q){try{r(C(q))}catch(d){m(d)}}:p}var r,m,y=new c(function(C,p){r=C;m=p});this.$(u(f,r),u(n,m));return y};c.prototype.catch=function(f){return this.then(void 0,f)};c.prototype.$=function(f,n){function u(){switch(r.G){case 1:f(r.L);break;case 2:n(r.L);break;default:throw Error("Unexpected state: "+
r.G);}}var r=this;null==this.B?F.G(u):this.B.push(u)};c.resolve=x;c.reject=function(f){return new c(function(n,u){u(f)})};c.race=function(f){return new c(function(n,u){for(var r=W(f),m=r.next();!m.done;m=r.next())x(m.value).$(n,u)})};c.all=function(f){var n=W(f),u=n.next();return u.done?x([]):new c(function(r,m){function y(q){return function(d){C[q]=d;p--;0==p&&r(C)}}var C=[],p=0;do C.push(void 0),p++,x(u.value).$(y(C.length-1),m),u=n.next();while(!u.done)})};return c});var X;
if("function"==typeof Object.setPrototypeOf)X=Object.setPrototypeOf;else{var Y;a:{var ba={ha:!0},Z={};try{Z.__proto__=ba;Y=Z.ha;break a}catch(G){}Y=!1}X=Y?function(G,c){G.__proto__=c;if(G.__proto__!==c)throw new TypeError(G+" is not extensible");return G}:null}var ca=X;V("Object.setPrototypeOf",function(G){return G||ca});V("Math.sign",function(G){return G?G:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}});
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"/7QA":function(G,c,a){a.r(c);G=a("fcUb");c=a("SYky");a.n(c);c=a("p11u");a=a("gqHH");console.log("ProteinVR "+a.k);document.title="ProteinVR "+a.k;"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("service-worker.js",{scope:"./"}).then(function(x){console.log("SW registered: ",x)}).catch(function(x){console.log("SW registration failed: ",x)})});c.d();G.a();-1!==window.location.href.indexOf("durrantlab")&&
setTimeout(function(){(function(B,F,f,n,u,r,m){B.GoogleAnalyticsObject=u;B[u]=B[u]||function(){(B[u].q=B[u].q||[]).push(arguments)};B[u].Ha=(new Date).getTime();r=F.createElement(f);m=F.getElementsByTagName(f)[0];r.async=1;r.src=n;m.parentNode.insertBefore(r,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create","UA-144382730-1",{name:"proteinvr"});var x=window.location.href;-1!==x.indexOf("?")&&(x=x.split("?")[0]+"?PARAMS_REMOVED");ga("proteinvr.send",{hitType:"event",
eventCategory:"proteinvr",eventAction:"pageview",eventLabel:x})},0)},"0fSa":function(G,c,a){function x(){setTimeout(function(){BABYLON.SceneOptimizer.OptimizeAsync(y.s,u())},5E3);y.s.autoClear=!1;y.s.autoClearDepthAndStencil=!1;for(var d=y.s.meshes.length,b=new BABYLON.Color3(0,0,0),h=0;h<d;h++){var g=y.s.meshes[h];-1!==g.name.indexOf("baked")&&void 0!==g.material&&(g.material.diffuseColor=b,g.material.specularColor=b,g.material.emissiveTexture=g.material.diffuseTexture,g.material.diffuseTexture=
null,g.freezeWorldMatrix())}}function B(d){if(void 0!==d){d=d.getVerticesData(BABYLON.VertexBuffer.PositionKind);if(null===d)return null;d=d.length/3}else d=0;return d}function F(d){var b=B(d);null===b||100>b||(b=1+Math.floor(b/y.d),1<b&&d.subdivide(b))}function f(d,b){void 0===b&&(b=!0);b&&d.material.freeze()}function n(){m.d&&(y.s.lights[0].autoUpdateExtends=!0,m.d.getShadowMap().refreshRate=BABYLON.RenderTargetTexture.REFRESHRATE_RENDER_ONCE,y.s.lights[0].autoUpdateExtends=!1)}function u(){var d=
new BABYLON.SceneOptimizerOptions(25,2E3),b=0;d.optimizations.push(new BABYLON.ShadowsOptimization(b));d.optimizations.push(new BABYLON.LensFlaresOptimization(b));d.optimizations.push(new BABYLON.PostProcessesOptimization(b));d.optimizations.push(new BABYLON.ParticlesOptimization(b));d.optimizations.push(new C(b));b++;d.optimizations.push(new p(b));d.optimizations.push(new C(b));b++;d.optimizations.push(new BABYLON.TextureOptimization(b,512));d.optimizations.push(new C(b));b++;d.optimizations.push(new BABYLON.RenderTargetsOptimization(b));
d.optimizations.push(new BABYLON.TextureOptimization(b,256));d.optimizations.push(new C(b));b++;d.optimizations.push(new BABYLON.HardwareScalingOptimization(b,4));d.optimizations.push(new q(b,500));d.optimizations.push(new C(b));return d}function r(d){null!==d&&d.dispose()}a.d(c,"d",function(){return x});a.d(c,"b",function(){return F});a.d(c,"a",function(){return f});a.d(c,"e",function(){return n});a.d(c,"c",function(){return r});var m=a("sqbB"),y=a("gqHH"),C=function(){return function(d){var b=this;
void 0===d&&(d=0);this.priority=d;this.apply=function(){console.log("Optimization priority:",b.priority);console.log("FPS:",y.r.getFps());console.log("");return!0};this.getDescription=function(){return"Reports the current priority. For debugging."}}}(),p=function(){return function(d){"undefined"===typeof d&&(d=0);this.priority=d;this.apply=function(){var b=y.s.getMeshByName("surfaces.wrl");r(b);return!0};this.getDescription=function(){return"Removes surface representations."}}}(),q=function(){return function(d,
b,h){void 0===h&&(h=void 0);"undefined"===typeof d&&(d=0);this.priority=d;this.apply=function(){for(var g=[],e=y.s.meshes.length,k=0;k<e;k++){var D=y.s.meshes[k];if(-1===D.name.indexOf("Decimated")){var w=B(D);null!==w&&(w<b||g.push([w,D,void 0===h?1-b/w:h]))}}g.sort(function(v,t){return t[0]-v[0]});e=g.length;for(k=0;k<e;k++){w=g[k];D=w[1];for(w=w[2];0<D.getLODLevels().length;){var l=D.getLODLevels()[0].mesh;D.removeLODLevel(l);r(l)}D.simplify([{quality:w,distance:.001}],!1,BABYLON.SimplificationType.QUADRATIC,
function(){})}return!0};this.getDescription=function(){return"Simplifies the geometry of complex objects in the scene."}}}()},"1RHl":function(G,c,a){function x(){f=B.s.cameras.filter(function(u){return-1===u.name.indexOf("VR")})[0];var n=new BABYLON.DeviceOrientationCamera("DevOr_camera",f.position.clone(),B.s,!0);n.rotation=f.rotation.clone();B.s.activeCamera=n;B.s.activeCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(f.rotation);B.q();F.b()}a.d(c,"a",function(){return x});var B=a("gqHH"),
F=a("ejGh"),f},"9bcR":function(G,c,a){(function(x){function B(){q.A.H=q.s.getMeshByID("ground");null===q.A.H&&alert("No mesh named ground");q.A.H.checkCollisions=!0;q.A.H.visibility=0;p.b(q.A.H);d.f({Z:n,mesh:q.A.H});q.A.C=3;f();b.f();m();F()}function F(){k=y.a();q.s.registerBeforeRender(function(){var t=y.a();null===b.d(t).pickedMesh&&D===q.s.activeCamera.id?y.e(k):(k=t,D=q.s.activeCamera.id)})}function f(){x("body").keypress(function(t){!1===e.a&&(32===t.charCode?n():109===t.charCode&&g.c.ea())})}
function n(){if(void 0===h.h){var t=(new Date).getTime();if(!(250>t-w))switch(w=t,d.e()){case 2:u();break;case 4:r();break;case 3:d.d.D()}}}function u(t,E){void 0===t&&(t=void 0);void 0===E&&(E=void 0);void 0===E&&(E=function(){});q.z.gazeTrackerMesh.isVisible=!1;var A=new BABYLON.Animation("animationCameraTeleportation","position",90,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),z=y.a();void 0===t&&(t=new BABYLON.Vector3(b.a.x,b.a.y+q.o,b.a.z));var I=y.d();
t=t.subtract(I);z=z.subtract(I);A.setKeys([{frame:0,value:z},{frame:q.j,value:t}]);var H=q.s.activeCamera;H.animations=[];H.animations.push(A);q.s.beginAnimation(H,0,q.j,!1,1,function(){q.z.gazeTrackerMesh.isVisible=!0;H.animations=[];E()})}function r(){var t=b.c,E=y.a(),A=b.a.subtract(E),z=A.length(),I;.1*z<q.g?I=b.a.subtract(A.normalize().scale(q.g)):.1*z>q.b?I=b.a.subtract(A.normalize().scale(q.b)):.1*z<q.b&&(I=E.add(A.scale(.9)));I.y=b.a.y;I.y-t.y<.5*q.a+.1&&(I.y=t.y+.5*q.a+.1);q.v(b.a.y-t.y);
u(I,function(){C.a()})}function m(){l=x("#capture-clicks");l.click(function(){n()});q.s.registerBeforeRender(function(){var t=q.s.activeCamera.inputs.attached.deviceOrientation;(t=t?0!==t._alpha||0!==t._beta||0!==t._gamma:!1)&&!v?(v=!0,l.show()):!t&&v&&(v=!1,l.hide())})}a.d(c,"b",function(){return B});a.d(c,"a",function(){return n});var y=a("vCcv"),C=a("ejGh"),p=a("0fSa"),q=a("gqHH"),d=a("TqLJ"),b=a("ph2Y"),h=a("p11u"),g=a("jIpr"),e=a("iC5T"),k,D="",w=0,l=void 0,v=!1}).call(this,a("EVdn"))},BjG7:function(G,
c,a){function x(){function h(D){function w(t){var E=p[l][t];g.Components[l][E]=n({},l,function(A,z){r.b([l,E],A,z)})}var l=C[D];g.Components[l]={};D=p[l].length;for(var v=0;v<D;v++)w(v)}for(var g={Components:{},Selections:{},Clear:function(){for(var D=Object.keys(r.a),w=D.length,l=0;l<w;l++)r.a[D[l]].mesh.isVisible=!1},"Remove Existing":{}},e=C.length,k=0;k<e;k++)h(k);return g}function B(h){if(!m.b()){h.Styles["Remove Existing"]={};y.e(h.Styles["Remove Existing"],["Styles","Remove Existing"]);for(var g=
Object.keys(r.a),e=g.length,k=function(w){var l=g[w];!0===r.a[l].mesh.isVisible&&(w=l.replace(/--/g," "),w=w.replace(/{/g,"").replace(/}/g,"").replace(/"/g,""),h.Styles["Remove Existing"][w]=function(){setTimeout(function(){var v=m.c(l);r.b(v[0],v[1],"Hide")},0)})},D=0;D<e;D++)k(D)}}function F(h){function g(t,E,A,z){function I(J){J=H[J];if(1===J.length){var K=J[0];void 0===K?(K="N/A",E[K]=function(){}):(E[K]={},E[K]=n(E[K],t,function(O,P){var M={};M[e[t]]=K;r.b([M],O,P)},z.concat([K])))}else{var N=
"["+J[0].toString()+"-"+J[J.length-1].toString()+"]";E[N]={};g(t,E[N],J,z.concat([N]))}}A.sort(function(J,K){J=isNaN(+J)?J:+J;K=isNaN(+K)?K:+K;return J<K?-1:J>K?1:0});var H=f(A,14);A=H.length;for(var L=0;L<A;L++)I(L);y.e(E,z)}h.Styles.Selections={};y.e(h.Styles.Selections,["Styles","Selections"]);for(var e={"Atom Name":"atom",Chain:"chain",Element:"elem","Residue Index":"resi","Residue Name":"resn","Secondary Structure":"ss"},k=Object.keys(u.a),D=k.length,w=0;w<D;w++){var l=k[w],v=u.a[l];h.Styles.Selections[l]=
{};g(l,h.Styles.Selections[l],v,["Styles","Selections",l])}}function f(h,g){if(2>g)return[h];var e=h.length,k=[],D=0,w;if(0===e%g)for(w=Math.floor(e/g);D<e;)k.push(h.slice(D,D+=w));else for(;D<e;)w=Math.ceil((e-D)/g--),k.push(h.slice(D,D+=w));return k}function n(h,g,e,k){function D(v){function t(I){var H=d[I];h[A].Colors[H]=function(){e(A,H)}}function E(I){var H=b[I];h[A]["Color Schemes"][H]=function(){e(A,H)}}var A=w[v];h[A]={Colors:{},"Color Schemes":{}};v=b.length;for(var z=0;z<v;z++)E(z);v=d.length;
for(z=0;z<v;z++)t(z);h[A].Hide=function(){e(A,"Hide")};void 0!==k&&(v=k.concat([A]),y.e(h[A],v),v=k.concat([A,"Colors"]),z=h[A].Colors,y.e(z,v),v=k.concat([A,"Color Schemes"]),z=h[A]["Color Schemes"],y.e(z,v))}var w=void 0===q[g]?q.Protein:q[g];g=w.length;for(var l=0;l<g;l++)D(l);void 0!==k&&y.e(h,k);return h}a.d(c,"a",function(){return x});a.d(c,"c",function(){return B});a.d(c,"b",function(){return F});var u=a("qmVJ"),r=a("EYe7"),m=a("p11u"),y=a("jIpr"),C=["Protein","Ligand","Ligand Context","Water",
"Nucleic"],p={Ligand:["All"],"Ligand Context":["All"],Nucleic:["All"],Protein:["All","Hydrophobic","Hydrophilic","Charged","Aromatic"],Water:["All"]};G=["Stick","Sphere","Surface"];var q={Ligand:G,"Ligand Context":["Cartoon"].concat(G),Nucleic:G,Protein:["Cartoon"].concat(G),Water:G},d="White Red Blue Green Orange Yellow Purple".split(" "),b=["Element","Amino Acid","Chain","Nucleic","Spectrum"]},EYe7:function(G,c,a){function x(e,k,D,w){void 0===w&&(w=void 0);d.a&&d.b(e,k,D);var l=F(e,k,D);void 0===
w&&(w=function(){});if("Hide"===D){D=Object.keys(b);e=D.length;for(var v=0;v<e;v++){var t=b[D[v]];t.N===l.N&&(t.mesh.isVisible=!1,console.log("Hiding existing mesh..."))}p.b(void 0,C.s.getMeshByName("protein_box"));n()}else void 0!==b[l.aa]?(b[l.aa].mesh.isVisible=!0,console.log("showing existing mesh..."),p.b(void 0,C.s.getMeshByName("protein_box")),n()):(q.e(),D=g[D],e={and:e.map(function(E){return void 0!==h[E]?h[E]:E})},"surface"===k.toLowerCase()?q.a(D,e,function(){B(l,k,w)}):(v={},v[k.toLowerCase()]=
D,q.g(e,v),B(l,k,w)))}function B(e,k,D){q.d(!0,k,function(w){for(var l=Object.keys(b),v=l.length,t=0;t<v;t++){var E=l[t],A=b[E];A.N===e.N&&(u.c(A.mesh),delete b[E],console.log("deleting old mesh..."))}void 0!==w&&("Surface"===k&&(w.material.backFaceCulling=!1),b[e.aa]={N:e.N,mesh:w});n();D()})}function F(e,k,D){e.sort();e=e.map(function(w){return"string"===typeof w?w:JSON.stringify(w)});return{N:e.join("--")+"--"+k,aa:e.join("--")+"--"+k+"--"+D}}function f(e){for(var k=e.map(function(v){return v}),
D=e.length,w=0;w<D;w++){var l=e[w];k.push(l.toUpperCase());k.push(l.toLowerCase())}return k=k.filter(function(v,t){return k.indexOf(v)>=t})}function n(){y.f();m.c(r.b)}a.d(c,"a",function(){return b});a.d(c,"b",function(){return x});var u=a("0fSa"),r=a("jIpr"),m=a("BjG7"),y=a("p11u"),C=a("gqHH"),p=a("YORc"),q=a("PjGz"),d=a("mvtX"),b={},h={All:{},Protein:{resn:f("ALA ARG ASP ASN ASX CYS GLN GLU GLX GLY HIS HSP HYP ILE LEU LYS MET PCA PHE PRO TRP TYR VAL GLU SER THR MSE".split(" "))},Acidic:{resn:f(["ASP",
"GLU"])},Cyclic:{resn:f(["HIS","PHE","PRO","TRP","TYR"])},Aliphatic:{resn:f(["ALA","GLY","ILE","LEU","VAL"])},Aromatic:{resn:f(["HIS","PHE","TRP","TYR"])},Basic:{resn:f(["ARG","HIS","LYS","HSP"])},Charged:{resn:f("ASP GLU ARG HIS LYS HSP".split(" "))},Hydrophobic:{resn:f("ALA LEU VAL ILE PRO PHE MET TRP".split(" "))},Neutral:{resn:f("VAL PHE GLN TYR HIS CYS MET TRP ASX GLX PCA HYP".split(" "))},Nucleic:{resn:f("ADE A GUA G CYT C THY T URA U DA DG DC DT".split(" "))},Purine:{resn:f(["ADE","A","GUA",
"G"])},Pyrimidine:{resn:f("CYT C THY T URA U".split(" "))},Ions:{resn:f("AL BA CA CAL CD CES CLA CL CO CS CU CU1 CUA HG IN IOD K MG MN3 MO3 MO4 MO5 MO6 NA NAW OC7 PB POT PT RB SOD TB TL WO4 YB ZN ZN1 ZN2".split(" "))},Water:{resn:f(["WAT","HOH","TIP","TIP3"])}};h.Ligand={not:{or:[h.Protein,h.Nucleic,h.Ions,h.Water]}};h["Ligand Context"]={byres:!0,within:{distance:4,sel:h.Ligand}};var g={"Amino Acid":{colorscheme:"amino"},Blue:{color:"blue"},Chain:{colorscheme:"chain"},Element:{colorscheme:"default"},
Green:{color:"green"},Nucleic:{colorscheme:"nucleic"},Orange:{color:"orange"},Purple:{color:"purple"},Red:{color:"red"},Spectrum:{color:"spectrum"},White:{color:"white"},Yellow:{color:"yellow"}}},O2BG:function(G,c,a){G.Fa=a.p+"cf4bd43cd8dade4b62f7e691f5d0f8cc.mp3"},PjGz:function(G,c,a){(function(x,B){function F(H){var L=x("#mol-container");L&&L.remove();x("body").append('<div\n        id="mol-container"\n        class="mol-container"\n        style="display:none;"></div>');l=x("#mol-container");v=
{backgroundColor:"white"};w=B.createViewer(l,v);window.viewer=w;H()}function f(){I&&(I=!1,w=null,F(function(){w.addModel(A,"pdb",{keepH:!0})}));w.setStyle({},{})}function n(H,L){x.ajax(H,{success:function(J){A=J;z="pdb";"sdf"===H.slice(H.length-3).toLowerCase()&&(z="sdf");J=w.addModel(J,z,{keepH:!0});L(J)},error:function(J,K,N){J="<p>Could not load molecule: "+H+"</p>";J=J+("<p><pre>"+N+'</pre></p><p>(<a href="')+(window.location.href.split("?")[0]+'">Click to restart...</a>)</p>');e.b("Error Loading Molecule",
J,!1,!1,!0)}})}function u(H,L){void 0!==H.and&&1===Object.keys(H).length&&"{}"===JSON.stringify(H.and[0])&&2===H.and.length&&(H=H.and[1]);0!==w.selectedAtoms(H).length&&(w.setStyle(H,L),w.render())}function r(H,L,J){0!==w.selectedAtoms(L).length&&(I=!0,w.addSurface(B.SurfaceType.MS,H,L,void 0,void 0,function(){J()}))}function m(H,L,J){void 0===J&&(J=function(){});b.r.hideLoadingUI();H&&y(function(){C(L,function(){var K=new BABYLON.StandardMaterial("Material",b.s);K.diffuseColor=new BABYLON.Color3(1,
1,1);K.emissiveColor=new BABYLON.Color3(0,0,0);K.specularColor=new BABYLON.Color3(0,0,0);for(var N=[],O=k.length,P=0;P<O;P++){var M=k[P],Q=[];BABYLON.VertexData.ComputeNormals(M.coors,M.trisIdxs,Q);var R=new BABYLON.VertexData;R.positions=M.coors;R.indices=M.trisIdxs;R.normals=Q;R.colors=M.colors;M=new BABYLON.Mesh("mesh_3dmol_tmp"+P,b.s);R.applyToMesh(M);M.material=K;N.push(M)}if(0<N.length){var S=BABYLON.Mesh.MergeMeshes(N,!0,!0);S.name="MeshFrom3DMol"+Math.random().toString();S.id=S.name;h.c(S,
123456789)}K=S;void 0!==K&&g.b(K,b.s.getMeshByName("protein_box"));J(K);k=[]})})}function y(H){t=w.exportVRML();H()}function C(H,L){k=[];if("undefined"!==typeof Worker)E.onmessage=function(J){J=J.data;var K=J.chunk;J=J.status;if(void 0!==K){for(var N=K[0],O=K[1],P=K[2];k.length<=N;)k.push({coors:new Float32Array(0),colors:new Float32Array(0),trisIdxs:new Uint32Array(0)});K=k[N];N=[k[N][O],P];var M=0;P=N.length;for(var Q=0;Q<P;Q++){var R=N[Q];M+=R.length}M=new ("trisIdxs"===O?Uint32Array:Float32Array)(M);
var S=0;for(Q=0;Q<P;Q++)R=N[Q],M.set(R,S),S+=R.length;K[O]=M}switch(J){case "more":E.postMessage({cmd:"sendDataChunk",data:void 0});break;case "done":L();break;default:console.log("Error here!")}},E.postMessage({cmd:"start",data:t,removeExtraPts:"Stick"===H});else throw e.b("Browser Error","Your browser does not support web workers. Please use a more\n            modern browser when running ProteinVR.",!1),Error("Browser does not support web workers.");}function p(H,L){D[H]+=L;d.f()}function q(H,
L,J){D=new BABYLON.Vector3(H,L,J)}a.d(c,"c",function(){return D});a.d(c,"h",function(){return F});a.d(c,"e",function(){return f});a.d(c,"b",function(){return n});a.d(c,"g",function(){return u});a.d(c,"a",function(){return r});a.d(c,"d",function(){return m});a.d(c,"i",function(){return p});a.d(c,"f",function(){return q});var d=a("p11u"),b=a("gqHH"),h=a("cw8d"),g=a("YORc"),e=a("iC5T"),k=[],D=new BABYLON.Vector3(0,0,0),w,l,v,t,E=new Worker("vrmlWebWorker.js"),A="",z="pdb",I=!1}).call(this,a("EVdn"),
a("VS3o"))},Rr3C:function(G,c,a){function x(){document.getElementById("loadingContainer").outerHTML=""}function B(r){f();n.r.displayLoadingUI();n.r.loadingUIText=r}function F(r){var m=r;clearInterval(u);u=setInterval(function(){m+=.02*(99-m);n.r.displayLoadingUI();n.r.loadingUIText="Loading the main scene... "+m.toFixed(0)+"%<br /><br />(Loading too slow? Reload page, use Incognito<br />mode, or clear browser cache.)"},100)}function f(){clearInterval(u)}a.d(c,"b",function(){return x});a.d(c,"a",function(){return B});
a.d(c,"c",function(){return F});a.d(c,"d",function(){return f});var n=a("gqHH"),u},TqLJ:function(G,c,a){function x(k){e=k}function B(){d.push(p.A.H)}function F(k){d.push(k);b.push(k);C.b(k);r({mesh:k,Z:function(){k.D()}})}function f(k){d.push(k);h.push(k);C.b(k);r({mesh:k})}function n(k){return k.id===p.A.H.id?!0:k.isVisible?-1!==d.indexOf(k):!1}function u(){return void 0===e?1:e===p.A.H?2:-1!==b.indexOf(e)?3:-1!==h.indexOf(e)?4:e===g?5:1}function r(k){void 0===k.Z&&(k.Z=q.a);void 0===k.ca&&(k.ca=
p.s);void 0!==k.mesh&&(k.mesh.actionManager=new BABYLON.ActionManager(k.ca),k.mesh.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){3===p.A.C&&k.Z()})))}function m(){g=BABYLON.Mesh.CreateSphere("padNavSphereAroundCamera",4,p.c-1,p.s);g.flipFaces(!0);var k=new BABYLON.StandardMaterial("padNavSphereAroundCameraMat",p.s);k.diffuseColor=new BABYLON.Color3(1,1,1);k.specularColor=new BABYLON.Color3(0,0,0);k.B=null;g.material=k;g.visibility=0;p.s.registerBeforeRender(function(){g.position=
y.a()});d.push(g)}a.d(c,"h",function(){return g});a.d(c,"i",function(){return x});a.d(c,"d",function(){return e});a.d(c,"j",function(){return B});a.d(c,"a",function(){return F});a.d(c,"b",function(){return f});a.d(c,"c",function(){return n});a.d(c,"e",function(){return u});a.d(c,"f",function(){return r});a.d(c,"g",function(){return m});var y=a("vCcv"),C=a("0fSa"),p=a("gqHH"),q=a("9bcR"),d=[],b=[],h=[],g,e},Vusd:function(G,c,a){(function(x){function B(){n.b("Menu",'<div class="accrd" id="accordion-menu2d"></div>',
!1,!0,!1,!1,!0).then(function(){F("#accordion-menu2d",u.b,[],0)})}function F(m,y,C,p){void 0===p&&(p=0);m=x(m);var q="",d=C.map(function(t){return f(t)}).join("-");q+='<div class="accrd" id="accordion-'+d+'">';for(var b=Object.keys(y),h=b.length,g=0;g<h;g++){var e=b[g];if(-1===["Close Menu \u00d7","Back \u21e6","Last","Exit VR \u00d7"].indexOf(e)){var k=y[e],D=d+(""===d?"":"-")+f(e),w="btn-"+D,l="collapse-"+D,v="background-color: rgb("+(10*Math.sin(p)+245+", "+(10*Math.sin(p+2)+245)+", "+(10*Math.sin(p+
4)+245)+");");q+='\n            <div class="card">\n                <div id="'+w+'"\n                  class="btn btn-sm menu2d-btn"\n                  data-toggle="collapse"\n                  data-target="#'+l+'"\n                  aria-expanded="false"\n                  aria-controls="'+l+'"\n                  style="font-size:'+(150-10*p)+"%; "+v+";\"\n                  data-clickpath='"+JSON.stringify(C.concat([e]))+"'\n                  data-depth='"+(p+1)+"'\n                  title=\""+e+
'">\n                    '+e+"\n                </div>";switch(typeof k){case "object":q+='\n                    <div id="'+l+'" class="collapse" aria-labelledby="'+D+'" data-parent="#accordion-'+d+'">\n                        <div class="card-body pad10" style="'+v+'">\n                        </div> \x3c!-- card body --\x3e\n                    </div>';break;default:r[w]=k}q+="</div>"}}m.html(q+"</div>");m.find(".menu2d-btn").click(function(){var t=x(this),E=t.attr("id");if(void 0!==r[E])void 0!==
r[E]?(r[E](),-1!==E.indexOf("-RemoveExisting-")&&t.hide()):console.warn("Function not defined: "+E);else{var A=t.data("clickpath");E=A.map(function(H){return f(H)});var z=t.data("depth"),I=u.b;for(t=0;t<A.length;t++)I=I[A[t]];F("#collapse-"+E.join("-")+" .card-body",I,A,z);x(".inpath").removeClass("inpath");A=E.length;for(t=0;t<A;t++)x("#btn-"+E.slice(0,E.length-t).join("-")).addClass("inpath")}})}function f(m){m=m.replace(/'/g,"PRIME").replace(/\//g,"");var y="abcdefghijklmnopqrstuvwxyz".split("");
y=y.concat(y.map(function(d){return d.toUpperCase()})).concat("0123456789".split(""));for(var C="",p=0;p<m.length;p++){var q=m.substring(p,p+1);-1!==y.indexOf(q)&&(C+=q)}return C}a.d(c,"a",function(){return B});var n=a("iC5T"),u=a("jIpr"),r={}}).call(this,a("EVdn"))},YORc:function(G,c,a){function x(d,b,h){void 0===h&&(h=!1);var g=F(d);void 0===p&&(p=y.c.clone());d=g.map(function(O){return{mesh:O,position:O.position.clone(),rotation:p.clone(),scaling:O.scaling.clone()}});p=y.c.clone();if(0!==g.length){f(g);
r.s.render();var e=b.getBoundingInfo().boundingBox,k=Object.keys(e.maximumWorld).map(function(O){return e.maximumWorld[O]-e.minimumWorld[O]}),D=0,w,l,v,t=g.length,E=function(O){O=g[O];var P=O.getBoundingInfo().boundingBox,M=Object.keys(P.maximumWorld).map(function(R){return P.maximumWorld[R]-P.minimumWorld[R]}),Q=M[0]*M[1]*M[2];Q>D&&(D=Q,w=P,l=M,v=O)};for(b=0;b<t;b++)E(b);b=k.map(function(O,P){return O/l[P]});b=Math.min.apply(null,b);E=new BABYLON.Vector3(b,b,b);for(b=0;b<t;b++)k=g[b],k.scaling=E;
r.s.render();E=w.centerWorld.subtract(e.centerWorld);for(b=0;b<t;b++)k=g[b],k.position=k.position.subtract(E);r.s.render();E=0;r.t.pa&&(E=B(v,e));for(b=0;b<t;b++)k=g[b],k.position.y=k.position.y-E,k.visibility=1;C=d[0].rotation.clone();if(!0===h)for(h=d.length,b=0;b<h;b++){var A=d[b];t=A.mesh;var z=t.position.clone(),I=t.scaling.clone(),H=t.rotation.clone();k=n("posX","position.x",A.position.x,z.x);E=n("posY","position.y",A.position.y,z.y);z=n("posZ","position.z",A.position.z,z.z);var L=n("scaX",
"scaling.x",A.scaling.x,I.x),J=n("scaY","scaling.y",A.scaling.y,I.y);I=n("scaZ","scaling.z",A.scaling.z,I.z);var K=n("rotX","rotation.x",A.rotation.x,H.x),N=n("rotY","rotation.y",A.rotation.y,H.y);A=n("rotZ","rotation.z",A.rotation.z,H.z);t.animations=[k,E,z,L,J,I,K,N,A];r.s.beginAnimation(t,0,15,!1,1,function(){u.e()})}else u.e()}}function B(d,b){var h=Math.PI;h=d.name+"-"+(d.rotation.x%h).toFixed(3)+"-"+(d.rotation.y%h).toFixed(3)+"-"+(d.rotation.z%h).toFixed(3);if(void 0!==q[h])return q[h];var g=
d.getVerticesData(BABYLON.VertexBuffer.PositionKind),e=1E6,k=g.length;d=d.getWorldMatrix();for(var D=Math.max(1,3*Math.floor(k/3E3)),w=0;w<k;w+=D){var l=new BABYLON.Vector3(g[w],g[w+1],g[w+2]);l=BABYLON.Vector3.TransformCoordinates(l,d);l.y<e&&(e=l.y)}b=e-b.minimumWorld.y-.1;return q[h]=b}function F(d){for(var b=[],h=Object.keys(m.a),g=h.length,e=0;e<g;e++){var k=m.a[h[e]].mesh;!0===k.isVisible&&b.push(k)}void 0!==d&&b.push(d);return b}function f(d){for(var b=d.length,h=0;h<b;h++){var g=d[h];g.animations=
[];!0===g.isVisible&&(g.scaling=new BABYLON.Vector3(1,1,1),g.position=new BABYLON.Vector3(0,0,0),g.rotation=y.c,g.visibility=0)}}function n(d,b,h,g){d=new BABYLON.Animation(d,b,60,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);d.setKeys([{frame:0,value:h},{frame:15,value:g}]);return d}a.d(c,"a",function(){return C});a.d(c,"b",function(){return x});var u=a("0fSa"),r=a("gqHH"),m=a("EYe7"),y=a("PjGz"),C=new BABYLON.Vector3(0,0,0),p=void 0,q={}},cw8d:function(G,c,a){function x(){m.c();
u.A.na&&n.d();return r.d().then(function(){f.e();return Promise.resolve()})}function B(){m.b();if(!0===u.t.ra)if(u.A.H){u.A.H.visibility=1;var p=new BABYLON.StandardMaterial("transparentGround",u.s);p.diffuseColor=new BABYLON.Color3(1,1,1);p.specularColor=new BABYLON.Color3(0,0,0);p.emissiveColor=new BABYLON.Color3(0,0,0);p.alpha=u.i;u.A.H.material=p}else console.log("Warning: Vars.vrVars.groundMesh not defined.");C.b()}function F(p,q){if(void 0!==p.material&&null!==p.material){var d=m.a();void 0===
d.ia?(d=d.ja,d=.95<d?.05:.4>d?.0025:.013636363636363637*d-.0029545454545454545):d=d.ia;p.material.emissiveColor=new BABYLON.Color3(d,d,d);f.a(p)}p.scaling.z=-1;0<q&&(p.scaling.x=-1);m.d&&m.d.getShadowMap().renderList.push(p);y.b(p)}a.d(c,"b",function(){return x});a.d(c,"a",function(){return B});a.d(c,"c",function(){return F});var f=a("0fSa"),n=a("jIpr"),u=a("gqHH"),r=a("qmVJ"),m=a("sqbB"),y=a("TqLJ"),C=a("fcUb")},ejGh:function(G,c,a){function x(){f=F.s.activeCamera;f.keysUp=[87,38];f.keysDown=[83,
40];f.keysLeft=[65,37];f.keysRight=[68,39];F.s.gravity=new BABYLON.Vector3(0,-.1,0);f.applyGravity=!0;B();F.s.collisionsEnabled=!0;f.checkCollisions=!0;f.speed=.1;f.attachControl(F.p,!0);f._updatePosition()}function B(){f.ellipsoid=new BABYLON.Vector3(1,.5*F.o,1)}a.d(c,"b",function(){return x});a.d(c,"a",function(){return B});var F=a("gqHH"),f;new BABYLON.Vector3(0,0,0)},fRJN:function(G,c,a){(function(x){function B(){F()}function F(){function y(g){x("#"+g.id).click(function(){g.D()})}for(var C=[{U:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n                    width="48px" height="48px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve">\n                    <g>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linejoin="round" d="M41.99,17.573v-5.209\n                            c0-0.588-0.717-1.092-1.615-1.092H25.123V8.92c0-0.336-0.449-0.672-0.987-0.672H1.077C0.449,8.248,0,8.583,0,8.92v3.444\n                            c0,0,0,0,0,0.084v25.877c0,0.588,0.717,1.092,1.615,1.092h38.671"/>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linejoin="round" d="M7.985,17.573h38.67\n                            c0.898,0,1.526,0.504,1.347,1.008l-5.295,19.744c-0.089,0.588-0.985,1.092-1.884,1.092H2.064c-0.898,0-1.526-0.504-1.347-1.008\n                            l5.294-19.744C6.19,18.077,7.088,17.573,7.985,17.573L7.985,17.573"/>\n                    </g>\n                    </svg>',
title:"Open Molecule",id:"open-button",T:!1,D:function(){window.PVR_warning=!0;f.b("Load Molecule","pages/load.html")}},{U:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                      x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                      <g>\n                          <path id="rect9967" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M17.678,35.173h27.476\n                              c1.434,0,2.598,1.136,2.598,2.539l0,0c0,1.4-1.164,2.538-2.598,2.538H17.678c-1.434,0-2.596-1.138-2.596-2.538l0,0\n                              C15.082,36.309,16.244,35.173,17.678,35.173z"/>\n                          <path id="rect9969" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M8.676,35.013H2.743\n                              c-1.434,0-2.597,1.176-2.597,2.62l0,0c0,1.441,1.163,2.617,2.597,2.617h5.933c1.435,0,2.598-1.176,2.598-2.617l0,0\n                              C11.274,36.188,10.11,35.013,8.676,35.013z"/>\n                          <path id="svg_60" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M17.533,26.506H45.01\n                              c1.434,0,2.597,1.134,2.597,2.538l0,0c0,1.406-1.163,2.542-2.597,2.542H17.533c-1.434,0-2.597-1.136-2.597-2.542l0,0\n                              C14.936,27.64,16.099,26.506,17.533,26.506z"/>\n                          <path id="svg_61" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M8.529,26.349H2.596\n                              C1.162,26.349,0,27.52,0,28.966l0,0c0,1.445,1.162,2.62,2.596,2.62h5.933c1.434,0,2.598-1.175,2.598-2.62l0,0\n                              C11.127,27.52,9.963,26.349,8.529,26.349z"/>\n                          <path id="svg_63" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M17.533,17.049H45.01\n                              c1.434,0,2.597,1.138,2.597,2.537l0,0c0,1.405-1.163,2.54-2.597,2.54H17.533c-1.434,0-2.597-1.135-2.597-2.54l0,0\n                              C14.936,18.187,16.099,17.049,17.533,17.049z"/>\n                          <path id="svg_64" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M8.529,16.891H2.596\n                              C1.162,16.891,0,18.059,0,19.507l0,0c0,1.45,1.162,2.625,2.596,2.625h5.933c1.434,0,2.598-1.175,2.598-2.625l0,0\n                              C11.127,18.059,9.963,16.891,8.529,16.891z"/>\n                          <path id="svg_66" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M17.793,8.605h27.476\n                              c1.435,0,2.598,1.136,2.598,2.54l0,0c0,1.402-1.163,2.54-2.598,2.54H17.793c-1.435,0-2.597-1.138-2.597-2.54l0,0\n                              C15.196,9.742,16.358,8.605,17.793,8.605z"/>\n                          <path id="svg_67" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M8.789,8.447H2.855\n                              c-1.434,0-2.597,1.172-2.597,2.619l0,0c0,1.447,1.163,2.622,2.597,2.622h5.933c1.435,0,2.598-1.175,2.598-2.622l0,0\n                              C11.387,9.619,10.224,8.447,8.789,8.447z"/>\n                      </g>\n                 </svg>\n       ',
title:"Menu",id:"menu-button",T:!1,D:function(){m.a()}},{U:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                    x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="\n                            M35.5,9.8c1.7,5.4-0.6,8-1.6,8.9c-1.9,1.9-4.5,4.7-5.8,7c-1.5,2.7-4.1,12-6.8,4.4c-3.2-9.1,1.3-11.6,3.5-13.4\n                            c1.5-1.3,3.4-4.3,0.5-5.3c-4-1.3-6.1,5.3-10.7,4c-3-0.8-3.2-4.1-2.2-6.6C15.4,1.7,32.5,0.6,35.5,9.8L35.5,9.8z"/>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" d="M28.3,39.6c0-5.5-8.5-5.5-8.5,0S28.3,45.1,28.3,39.6"/>\n                  </svg>',
title:"Help",id:"help-button",T:!1,D:function(){f.b("Help: ProteinVR "+n.k,"pages/help.html",!0,!0)}},{U:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n             \t    x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                    <path fill="none" stroke="#FFFFFF" stroke-width="1.5" d="M35.4,4.6c-3.2,0-5.8,2.4-5.8,5.8l0,0c0,0.5,0.2,1.1,0.5,1.4l-13.4,7.8\n             \t    c-1-1.4-2.6-1.8-4.1-1.8c-3.2,0-5.8,2.4-5.8,5.8l0,0c0,2.9,2.6,5.8,5.8,5.8l0,0c1.3,0,2.2-0.5,3.2-1.4l13.6,8.3\n             \t    c-0.3,0.4-0.3,0.9-0.3,1.4c0,3.4,2.7,5.8,5.9,5.8l0,0c3.2,0,5.6-2.4,5.6-5.8l0,0c0-2.9-2.4-5.9-5.6-5.9l0,0c-1.7,0-3.2,1.1-4.4,2\n             \t    l-13.1-7.3c0.5-0.9,0.7-2,0.7-2.9c0-0.5,0-1.4-0.2-2l13.3-7.3c1,0.9,2.5,1.5,4.1,1.5c3.2,0,5.9-2.5,5.9-5.4l0,0\n             \t    C41.3,6.9,38.5,4.6,35.4,4.6L35.4,4.6L35.4,4.6z"/>\n                 </svg>',
title:"Share (Leader)",id:"leader",T:!1,D:function(){u.e()}},{U:'<svg style="position:relative; left:0.5px;" width="48px" height="48px" xmlns="http://www.w3.org/2000/svg"\n                    xmlns:svg="http://www.w3.org/2000/svg" clip-rule="evenodd">\n                    <g class="layer">\n                        <path d="m47.799999,43.649999l-47.699999,0l0,-39.749999l47.699999,0l0,39.749999zm-1.9875,-37.762499l-43.724999,0l0,35.774999l43.724999,0l0,-35.774999zm-7.95,13.9125l-1.9875,0l0,-6.441487l-22.341487,22.341487l6.441487,0l0,1.9875l-9.9375,0l0,-9.9375l1.9875,0l0,6.441487l22.341487,-22.341487l-6.441487,0l0,-1.9875l9.9375,0l0,9.9375z" fill="#ffffff" id="svg_1"/>\n                    </g>\n                  </svg>',
title:"Full Screen",id:"fullscreen-button",T:!0,D:function(){n.r.switchFullscreen(!0);x("#renderCanvas").focus()}}],p="",q=60,d=0,b=C.reverse();d<b.length;d++){var h=b[d];if(void 0===r.h||!0===h.T)p+='\n                <button\n                    title="'+h.title+'"\n                    id="'+h.id+'"\n                    class="ui-button"\n                    style="color:white;\n                        width:80px;\n                        height:50px;\n                        right:5px;\n                        position:absolute;\n                        bottom:'+
q.toString()+'px;\n                        background-color:rgba(51,51,51,0.7);\n                        border:none;\n                        outline:none;\n                        cursor:pointer;">\n                        '+h.U+"\n                </button>",q+=55}x("body").append(p);for(p=0;p<C.length;p++)h=C[p],y(h);C=document.getElementById("babylonVRiconbtn");null!==C&&(C.style.opacity="1.0",C.style.filter="alpha(opacity=1.0)")}a.d(c,"a",function(){return B});var f=a("iC5T"),n=a("gqHH"),u=a("mvtX"),
r=a("p11u"),m=a("Vusd")}).call(this,a("EVdn"))},fcUb:function(G,c,a){(function(x){function B(){e.x();h.b();F();f(function(){C.a();D.b()?(e.A.C=3,e.s.getMeshByID("ground").visibility=0,e.A.ba.isVisible=!1):(d.b(),b.j());q.b().then(function(){g.a()})});window.addEventListener("resize",function(){e.r.resize()})}function F(){var l=BABYLON.Mesh.CreateSphere("navTargetMesh",4,.1,e.s),v=new BABYLON.StandardMaterial("myMaterial",e.s);v.diffuseColor=new BABYLON.Color3(1,0,1);l.material=v;l.Ka=2;e.y({ba:l});
p.a();k.d()}function f(l){h.a("Loading the main scene...");BABYLON.SceneLoader.LoadAssetContainer(e.u,"scene.babylon",e.s,function(v){h.c(90);e.s.executeWhenReady(function(){w.a();x.getJSON(e.u+"scene_info.json",function(t){!1===t.menuActive&&(e.A.na=!1);void 0!==t.positionOnFloor&&(e.t.pa=t.positionOnFloor);void 0!==t.infiniteDistanceSkyBox&&(e.t.la=t.infiniteDistanceSkyBox);void 0!==t.transparentGround&&(e.t.ra=t.transparentGround);v.addAllToScene();e.s.activeCamera=e.s.cameras.filter(function(E){return-1===
E.name.indexOf("VR")})[0];n();u();r();m();l()})})},function(v){v.lengthComputable&&h.a("Loading the main scene... "+Math.round(90*v.loaded/v.total).toString()+"%")})}function n(){for(var l=!1,v=0;1<e.s.lights.length;){var t=e.s.lights[v].name.toLowerCase();-1===t.indexOf("shadowlight")&&-1===t.indexOf("shadow_light")?e.s.lights[v].dispose():l?e.s.lights[v].dispose():(l=!0,v++)}}function u(){for(var l=e.s.meshes.length,v=0;v<l;v++){var t=e.s.meshes[v];"protein_box"===t.name?t.isVisible=!1:-1!==t.name.toLowerCase().indexOf("skybox")&&
e.t.la&&(t.material.disableLighting=!0,t.infiniteDistance=!0)}}function r(){for(var l=e.s.meshes.length,v=0;v<l;v++){var t=e.s.meshes[v];t.material&&t.material.emissiveTexture&&(t.material.emissiveColor=new BABYLON.Color3(1,1,1),t.material.albedoColor=new BABYLON.Color3(0,0,0),t.material.Ea=new BABYLON.Color3(0,0,0))}}function m(){for(var l=e.s.meshes.length,v=0;v<l;v++)if(e.s.meshes[v].material){var t=e.s.meshes[v];if(void 0===t.material.emissiveTexture||null===t.material.emissiveTexture)t.material.emissiveTexture=
t.material.diffuseTexture,t.material.diffuseColor=new BABYLON.Color3(0,0,0),t.material.specularColor=new BABYLON.Color3(0,0,0),t.material.emissiveColor=new BABYLON.Color3(0,0,0);k.a(t,!1);b.f({mesh:t,ca:e.s})}}function y(){setTimeout(k.e,1E3);h.d();e.s.activeCamera.maxZ=250;e.s.activeCamera.minZ=0;e.r.runRenderLoop(function(){e.s.render()})}a.d(c,"a",function(){return B});a.d(c,"b",function(){return y});var C=a("1RHl"),p=a("nV79"),q=a("cw8d"),d=a("9bcR"),b=a("TqLJ"),h=a("Rr3C"),g=a("fRJN"),e=a("gqHH"),
k=a("0fSa"),D=a("p11u"),w=a("vMIs")}).call(this,a("EVdn"))},gg4m:function(G,c,a){function x(u){void 0===u&&(u="");var r="<p>ProteinVR has encountered an error while running in leader mode. ";F.b("Leader Error",""!==u?r+" Here are the details:</p><p><pre>"+(u+"</pre></p>"):r+"</p>",!1)}function B(){x("Leader connection destroyed. Please refresh.")}a.d(c,"a",function(){return f});a.d(c,"b",function(){return n});a.d(c,"c",function(){return x});a.d(c,"d",function(){return B});var F=a("iC5T"),f=!1,n=function(){function u(){this.F=
this.O=null;this.xa();this.Ca()}u.prototype.xa=function(){var r="act add age ago aid aim air all and any arm art ask bag ban bar bed bet big bit box bus but buy can cap car cat ceo cow cry cup day dig dna rna dog dry due ear eat egg end era etc eye fan far fee few fit fix fly for fun gap get guy hat hey hip hit hot how ice its jet job joy key kid lab law lay let lie lot low map may mix net new nod nor not now nut odd off oil old one our out owe own pan pay per pet pie pop put raw red rid row run say sea see set sit six ski sky sue sun tap tax ten the toe too top toy try two use via war way wet who why win yes yet you".split(" "),
m="pvr"+this.qa();m+=r[Math.floor(Math.random()*r.length)]+this.qa();m=m.replace(/\./g,"");this.F=new Peer(m,{debug:2,config:{iceServers:[{urls:"stun:0.peerjs.com"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:durrantlab.com/apps/protein-vr/stun"}]}})};u.prototype.Ca=function(){var r=this;this.F.on("disconnected",function(){B();!0===f&&console.log("Connection lost. Please reconnect");r.F.id=r.O;r.F.Da=r.O;r.F.Ja()});this.F.on("error",function(m){x(m)})};u.prototype.qa=function(){return Math.random().toString().replace(/\./g,
"").replace(/0/g,"").slice(0,3)};return u}()},gqHH:function(G,c,a){function x(g){q=g}function B(){m=document.getElementById("renderCanvas");y=new BABYLON.Engine(m,!0);BABYLON.Database.IDBStorageEnabled=!0;C=new BABYLON.Scene(y);window.scene=C}function F(){if(void 0===b){var g=new BABYLON.Ray(C.activeCamera.position,new BABYLON.Vector3(0,-1,0),50);b=C.pickWithRay(g,function(e){return"ground"===e.name}).distance}}function f(g){b=g}function n(g){h=g;u.b()||(p=C.createDefaultVRExperience({createDeviceOrientationCamera:!0,
useMultiview:!1}),g=document.getElementById("babylonVRiconbtn"),null!==g&&(g.style.opacity="0.0",g.style.filter="alpha(opacity=0)"),h.na=!0)}a.d(c,"k",function(){return r});a.d(c,"p",function(){return m});a.d(c,"r",function(){return y});a.d(c,"s",function(){return C});a.d(c,"z",function(){return p});a.d(c,"u",function(){return q});a.d(c,"w",function(){return x});a.d(c,"t",function(){return d});a.d(c,"o",function(){return b});a.d(c,"j",function(){return 11});a.d(c,"b",function(){return 1.5});a.d(c,
"g",function(){return 1});a.d(c,"d",function(){return 2E3});a.d(c,"a",function(){return 1.2});a.d(c,"f",function(){return 2.5});a.d(c,"e",function(){return.05});a.d(c,"h",function(){return.01});a.d(c,"n",function(){return 500});a.d(c,"m",function(){return 750});a.d(c,"l",function(){return.1});a.d(c,"c",function(){return 15});a.d(c,"i",function(){return.05});a.d(c,"A",function(){return h});a.d(c,"x",function(){return B});a.d(c,"q",function(){return F});a.d(c,"v",function(){return f});a.d(c,"y",function(){return n});
var u=a("p11u"),r="1.0.3",m,y,C,p,q="environs/day/",d={pa:!1,la:!0,ra:!1},b,h={}},iC5T:function(G,c,a){(function(x){function B(b,h,g,e,k,D,w){void 0===g&&(g=!0);void 0===k&&(k=!1);void 0===D&&(D=!0);void 0===w&&(w=!1);p=D;d=w;return new Promise(function(l){q=l;f||(f=!0,document.head.insertAdjacentHTML("beforeend","<link rel=stylesheet href=pages/css/bootstrap.min.css>"),document.body.insertAdjacentHTML("beforeend",'\n                \x3c!-- The Modal --\x3e\n                <div class="modal fade" id="msgModal" role="dialog">\n                    <div class="modal-dialog" role="document">\n                        <div class="modal-content">\n\n                        \x3c!-- Modal Header --\x3e\n                        <div class="modal-header">\n                            <h4 class="modal-title">Modal Heading</h4>\n                            <button id="modal-close-button" type="button" class="close" data-dismiss="modal">&times;</button>\n                        </div>\n\n                        \x3c!-- Modal body --\x3e\n                        <div class="modal-body">\n                            \x3c!-- <div id="iframe-container" style="height:350px;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch">\n                                <iframe frameBorder="0" src="" style="width:100%;height:100%;"></iframe>\n                            </div> --\x3e\n                            <span id="msg-container"></span>\n                        </div>\n\n                        \x3c!-- Modal footer --\x3e\n                        <div id="modal-footer" class="modal-footer">\n                            <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>\n                        </div>\n                    </div>\n                </div>\n                <link rel="stylesheet" type="text/css" href="pages/css/style.css">\n            '));
F(b,h,g,e,k)})}function F(b,h,g,e,k){void 0===n&&(n=x("#msgModal"),r=n.find(".modal-dialog"),u=n.find("h4.modal-title"),m=n.find("#msg-container"),y=n.find("#modal-footer"),n.on("hidden.bs.modal",function(){C=!1}),x(".modal-header").on("mousedown",function(D){var w=x(this),l=D.pageX-w.offset().left,v=D.pageY-w.offset().top;x("body").on("mousemove.draggable",function(t){w.closest(".modal-dialog").offset({left:t.pageX-l,top:t.pageY-v})});x("body").one("mouseup",function(){x("body").off("mousemove.draggable")});
w.closest(".modal").one("bs.modal.hide",function(){x("body").off("mousemove.draggable")})}),n.on("shown.bs.modal",function(){C=!0;q()}));m.html("");u.html(b);!0===g?(void 0===e&&y.hide(),m.css("text-align","initial"),b=new XMLHttpRequest,b.onreadystatechange=function(){4===this.readyState&&200===this.status&&(m.html(this.responseText),setTimeout(function(){var D=document.createElement("script");D.src=h.replace(".html",".html.js");document.head.appendChild(D)},0))},b.open("GET",h,!0),b.send()):(m.css("text-align",
"center"),m.html(h),void 0===e&&y.show());!0===e?y.show():!1===e&&y.hide();e={};!0===k&&(x("#modal-close-button").hide(),n.on("shown.bs.modal",function(){x(".modal-backdrop.show").css("opacity",1)}),e={backdrop:"static",keyboard:!1});n.modal(e);k=x(".modal-backdrop");!0===p?k.css("background-color","rgb(0,0,0)"):k.css("background-color","transparent");!0===d?r.addClass("skinny-modal"):r.removeClass("skinny-modal")}a.d(c,"a",function(){return C});a.d(c,"b",function(){return B});var f=!1,n,u,r,m,y,
C=!1,p=!0,q,d=!1}).call(this,a("EVdn"))},jIpr:function(G,c,a){function x(){l=[];v=[];k={Styles:g.a(),Rotate:h.b()};void 0===t&&(t=new BABYLON.GUI.GUI3DManager(p.s));f();E=new BABYLON.TransformNode("");B();void 0===w&&u();void 0===D&&(D=new BABYLON.Sound("click-button",e.ha,p.s,null,{loop:!1,autoplay:!1,La:!0,volume:.1}));m()}function B(){function A(H){H=H.toString();l.push(new b({D:function(){},default:!1,R:H,ma:function(L){L.isVisible(!1)},level:1,name:"menu-visible-button-"+H,oa:z,V:H,color:"yellow"}))}
var z=new BABYLON.GUI.SpherePanel;z.radius=p.f;z.margin=p.e;t.addControl(z);z.blockLayout=!0;for(var I=0;16>I;I++)A(I);z.columns=4;z.linkToTransformNode(E);z.blockLayout=!1}function F(A){function z(I,H){A(I,H);for(var L=Object.keys(I),J=L.length,K=0;K<J;K++){var N=L[K],O=I[N];switch(typeof O){case "object":z(O,H.concat([N]))}}}z(k,[])}function f(){F(function(A,z){n(A,z)})}function n(A,z){0<z.length&&(A["Back \u21e6"]=function(){r(z.slice(0,z.length-1))});A["Close Menu \u00d7"]=function(){w.ea()}}
function u(){var A=new BABYLON.GUI.StackPanel3D;t.addControl(A);w=new b({D:function(I){I.value?r([]):r(void 0);E.position.copyFrom(y.a());E.rotation.y=y.c()},default:!1,R:"Show Menu",level:0,name:"menu-visible-button",oa:A,V:"Hide Menu"});w.button.position.y=.75;w.button.position.z=.75;var z=new BABYLON.TransformNode("");A.linkToTransformNode(z);z.rotation.x=.5*Math.PI;z.position.copyFrom(C.b);z.position.y+=.1;z.rotation.y=y.c();z.rotation.x=.4*Math.PI;p.s.registerBeforeRender(function(){z.position.copyFrom(C.b);
z.position.y+=.1;z.rotation.y=y.c()})}function r(A){void 0!==A&&0<A.length&&(v=A,void 0===k.Last&&(k.Last=function(){console.log("Going to",v);r(v)}));for(var z=l.length,I=0;I<z;I++)l[I].isVisible(!1);if(void 0!==A){var H=k;z=A.length;for(I=0;I<z;I++)H=H[A[I]];var L=Object.keys(H),J=["Close Menu \u00d7","Exit VR \u00d7"],K=["Back \u21e6"],N=J.concat(K);L.sort(function(M,Q){var R=-1!==N.indexOf(M),S=-1!==N.indexOf(Q);return R&&!S?1:!R&&S?-1:M.localeCompare(Q)});var O=[];O=4>=L.length?[7,6,5,4]:8>=
L.length?[7,6,5,4,11,10,9,8]:12>=L.length?[3,2,1,0,7,6,5,4,11,10,9,8]:[3,2,1,0,7,6,5,4,11,10,9,8,15,14,13,12];z=L.length;var P=function(M){var Q=L[M],R=H[Q];M=l[O[M]];M.fa(Q);switch(typeof R){case "object":M.D=function(){r(A.concat(Q))};M.W("green");break;case "function":M.D=R,M.W("default")}-1!==J.indexOf(Q)?M.W("red"):-1!==K.indexOf(Q)&&M.W("yellow");M.isVisible(!0)};for(I=0;I<z;I++)P(I)}}function m(){function A(z,I){var H=Object.keys(z);if(3===H.length){var L=H.filter(function(P){return"Close Menu \u00d7"===
P||"Back \u21e6"===P?!1:!0});if(1===L.length){H=L[0];var J=I[I.length-1],K=J+": "+H;I=I.slice(0,I.length-1).concat([K]);z=k;var N=I.slice(0,I.length-1),O=N.length;for(L=0;L<O;L++)z=z[N[L]];z[K]=z[J][H];delete z[J];z=z[K];H=Object.keys(z)}}J=H.length;for(L=0;L<J;L++)switch(K=H[L],N=z[K],typeof N){case "object":A(N,I.concat([K]))}}A(k,[])}var y=a("vCcv"),C=a("ph2Y"),p=a("gqHH"),q=a("TqLJ"),d=new BABYLON.Vector3(.75,.75,.75),b=function(){function A(z){var I=this;this.button=new BABYLON.GUI.HolographicButton(z.name);
z.oa.addControl(this.button);this.X();void 0!==z.color&&this.W(z.color);this.level=z.level;this.B=new BABYLON.GUI.TextBlock;this.B.color="white";this.B.B=!0;this.value=z.default;this.V=z.V;this.R=z.R;this.D=z.D;this.fa();this.button.scaling=d.clone();this.J=BABYLON.Mesh.CreateSphere(z.name+"-container-mesh",2,p.a,p.s);this.J.position=this.button.node.absolutePosition;this.J.visibility=0;this.J.scaling=d.clone();this.J.D=function(){I.ea()};q.a(this.J);void 0!==z.ma&&z.ma(this)}A.prototype.W=function(z){switch(z){case "default":this.button.mesh.material=
this.G;break;case void 0:this.button.mesh.material=this.G;break;case "green":this.button.mesh.material=this.I;break;case "yellow":this.button.mesh.material=this.L;break;case "red":this.button.mesh.material=this.K}};A.prototype.isVisible=function(z){if(void 0===z)return this.button.isVisible;this.button.isVisible=z;this.J.isVisible=z};A.prototype.ea=function(){D.setPosition(this.J.position.clone());D.play();this.value=!this.value;this.D(this);this.fa()};A.prototype.fa=function(z){void 0===z?this.B.text=
this.value?this.V:this.R:this.R=this.V=this.B.text=z;this.B.text=this.Y(this.B.text);this.button.content.dispose();this.button.content=this.B};A.prototype.Y=function(z){return z.replace(/(?![^\n]{1,25}$)([^\n]{1,25})\s/g,"$1\n")};A.prototype.X=function(){this.G=this.button.mesh.material;this.I=this.button.mesh.material.clone();this.I.albedoColor=new BABYLON.Color3(.3,.35+.1,.4);this.L=this.button.mesh.material.clone();this.L.albedoColor=new BABYLON.Color3(.4,.35+.1,.4);this.K=this.button.mesh.material.clone();
this.K.albedoColor=new BABYLON.Color3(.4,.35,.4)};return A}(),h=a("nKXq"),g=a("BjG7");G=a("O2BG");var e=a.n(G);a.d(c,"b",function(){return k});a.d(c,"a",function(){return D});a.d(c,"c",function(){return w});a.d(c,"d",function(){return x});a.d(c,"e",function(){return n});var k,D=void 0,w,l,v,t,E},mvtX:function(G,c,a){function x(){y=!0;C=new p;C.ka.then(function(q){window.PVR_webRTCID=q;u.b("Leader","pages/leader.html",!0,!0)});setInterval(function(){var q=n.a(),d=n.b();C.S({type:"locrot",val:[q.x,
q.y,q.z,1*d.x,1*d.y,1*d.z,1*d.w]})},100);setInterval(function(){C.S({type:"initialUrl",val:window.location.href})},2E3)}function B(q,d,b){C.S({type:"toggleRep",val:{filters:q,repName:d,colorScheme:b}})}function F(q){C.S({type:"molAxisRotation",val:q})}function f(){C.S({type:"molUndoRot",val:void 0})}a.d(c,"a",function(){return y});a.d(c,"e",function(){return x});a.d(c,"b",function(){return B});a.d(c,"d",function(){return F});a.d(c,"c",function(){return f});var n=a("vCcv"),u=a("iC5T"),r=a("gg4m"),
m=function(){function q(d,b){q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var e in g)g.hasOwnProperty(e)&&(h[e]=g[e])};return q(d,b)}return function(d,b){function h(){this.constructor=d}q(d,b);d.prototype=null===b?Object.create(b):(h.prototype=b.prototype,new h)}}(),y=!1,C,p=function(q){function d(){var b=q.call(this)||this;b.ka=null;b.za=null;b.P=[];var h;b.za=new Promise(function(g){h=g});b.ka=new Promise(function(g){b.da(g,h)});return b}
m(d,q);d.prototype.S=function(b){!0===r.a&&console.log("Send:",b);for(var h=this.P.length,g=0;g<h;g++)this.P[g].send(b)};d.prototype.da=function(b,h){var g=this;this.F.on("open",function(){null===g.F.id?(r.c("Received null id from peer open."),g.F.id=g.O):g.O=g.F.id;b(g.O);!0===r.a&&console.log(g.O)});this.F.on("connection",function(e){g.P.push(e);h();!0===r.a&&console.log("Lecturer: added a connection")});this.F.on("close",function(){for(var e=g.P.length,k=0;k<e;k++)g.P[k]=null;r.d()})};return d}(r.b)},
nKXq:function(G,c,a){function x(){return{"Undo Rotate":function(){F()},"X Axis":function(){B("x")},"Y Axis":function(){B("y")},"Z Axis":function(){B("z")}}}function B(m){n.i(m,15*Math.PI/180);f.b(void 0,u.s.getMeshByName("protein_box"),!0);r.a&&r.d(m)}function F(){var m=f.a;n.f(m.x,m.y,m.z);f.b(void 0,u.s.getMeshByName("protein_box"),!0);r.a&&r.c()}a.d(c,"b",function(){return x});a.d(c,"a",function(){return B});a.d(c,"c",function(){return F});var f=a("YORc"),n=a("PjGz"),u=a("gqHH"),r=a("mvtX")},nV79:function(G,
c,a){(function(x){function B(){p.b()||(f(),C.a(),setInterval(function(){var b=(new Date).getTime();void 0===d&&(d=b);2E3<b-d&&F();d=b},1E3))}function F(){void 0!==y.z&&(y.z.exitVR(),y.s.getEngine().exitFullscreen())}function f(){y.z.onEnteringVRObservable.add(function(){y.A.C=2;u();r.i(void 0);m.e();x(".ui-button").hide();x(".babylonVRicon").hide();C.b();q.b["Exit VR \u00d7"]=function(){F()};window.vrHelper=y.z});y.z.onExitingVRObservable.add(function(){y.A.C=3;r.i(void 0);m.e();x(".ui-button").show();
x(".babylonVRicon").show();delete q.b["Exit VR \u00d7"];console.log(q.b)})}function n(){var b=new BABYLON.Mesh("vrNavTargetMesh",y.s),h=new BABYLON.VertexData;h.Ia=[0,0,0];h.Ga=[0];h.applyToMesh(b);b.isVisible=!1;return b}function u(){y.z.raySelectionPredicate=function(b){return r.c(b)};y.z.gazeTrackerMesh=n();y.z.updateGazeTrackerScale=!1;y.z.displayGaze=!0;y.z.enableGazeEvenWhenNoPointerLock=!0;y.z.enableInteractions()}a.d(c,"a",function(){return B});a.d(c,"b",function(){return u});var r=a("TqLJ"),
m=a("0fSa"),y=a("gqHH"),C=a("pAUf"),p=a("p11u"),q=a("jIpr"),d}).call(this,a("EVdn"))},p11u:function(G,c,a){(function(x){function B(l){return(Math.round(1E5*l)/1E5).toString()}function F(){var l=[],v=d.c.x;0!==v&&l.push("rx="+B(v));v=d.c.y;0!==v&&l.push("ry="+B(v));v=d.c.z;0!==v&&l.push("rz="+B(v));l.push("s="+p.b);void 0!==k&&(console.log("setting webrtc..."),l.push("f="+k));v=0;for(var t=[],E=Object.keys(q.a),A=E.length,z=0;z<A;z++){var I=E[z];q.a[I].mesh.isVisible&&(t.push("st"+v.toString()+"="+
I),v++)}l=l.concat(t);v=g.a();t=g.b();l.push("cx="+B(v.x));l.push("cy="+B(v.y));l.push("cz="+B(v.z));l.push("crx="+B(t.x));l.push("cry="+B(t.y));l.push("crz="+B(t.z));l.push("crw="+B(t.w));l.push("e="+h.u);void 0===D&&(D=!1);l.push("sh="+D.toString());window.history.pushState({},document.title,window.location.href.split("?")[0]+"?"+l.join("&"))}function f(){var l=window.location.href,v=l?l.split("?")[1]:window.location.search.slice(1);l={};if(v){v=v.split("#")[0];v=v.split("&");for(var t=v.length,
E=0;E<t;E++){var A=v[E].split("=");l[A[0]]=void 0===A[1]?!0:A[1]}}w=l;l=w.e;void 0!==l&&h.w(l)}function n(){k=w.f;if(void 0!==k){b.a(k);h.s.activeCamera.inputs.clear();x("#help-button").hide();x("#leader").hide();x("#babylonVRiconbtn").hide();x("#open-button").hide();var l=x("#fullscreen-button"),v=l.css("bottom");void 0!==v&&(v=+v.replace(/px/g,""),l.css("bottom",(v-60).toString()+"px"));x("#capture-clicks").remove();var t=x("#followerModeWarning");t.fadeIn(500);setTimeout(function(){t.fadeOut(500)},
8E3)}l=w.rx;v=w.ry;var E=w.rz;d.f(void 0===l?0:+l,void 0===v?0:+v,void 0===E?0:+E);l=w.s;void 0!==l&&""!==l&&(4===l.length&&-1===l.indexOf(".")&&(l="https://files.rcsb.org/view/"+l.toUpperCase()+".pdb"),p.c(l));l=Object.keys(w);v=l.length;for(E=0;E<v;E++){var A=l[E];"st"===A.slice(0,2)&&(A=u(w[A]),e.push(A))}0===e.length&&(e.push([["Protein","All"],"Cartoon","Spectrum"]),e.push([["Nucleic","All"],"Stick","Element"]),e.push([["Ligand","All"],"Stick","Element"]));l=w.cx;v=w.cy;E=w.cz;void 0!==l&&void 0!==
v&&void 0!==E&&g.e(new BABYLON.Vector3(+l,+v,+E));l=w.crx;v=w.cry;E=w.crz;A=w.crw;void 0!==l&&void 0!==v&&void 0!==E&&void 0!==A&&g.f(new BABYLON.Quaternion(+l,+v,+E,+A));D=w.sh;C()}function u(l){l=l.split("--");var v=decodeURIComponent(l[l.length-2]),t=decodeURIComponent(l[l.length-1]);return[l.slice(0,l.length-2).map(function(E){E=decodeURIComponent(E);"{"===E.charAt(0)&&(E=JSON.parse(E));return E}),v,t]}function r(){if(0<e.length){var l=e.pop();q.b(l[0],l[1],l[2],function(){r()})}}function m(){return-1!==
window.location.href.indexOf("f=")}function y(){return-1!==window.location.href.indexOf("sh=t")}function C(){setInterval(function(){"block"!==x("#msgModal").css("display")&&F()},1E3)}a.d(c,"h",function(){return k});a.d(c,"f",function(){return F});a.d(c,"d",function(){return f});a.d(c,"e",function(){return n});a.d(c,"c",function(){return u});a.d(c,"g",function(){return r});a.d(c,"b",function(){return m});a.d(c,"a",function(){return y});var p=a("qmVJ"),q=a("EYe7"),d=a("PjGz"),b=a("uBLq"),h=a("gqHH"),
g=a("vCcv"),e=[],k=void 0,D=!1,w}).call(this,a("EVdn"))},pAUf:function(G,c,a){function x(){function g(e){m.A.C=1;C.b();F(e);f(e)}u.g();m.z.webVRCamera.onControllerMeshLoadedObservable.add(function(e){g(e)});m.z.onControllerMeshLoaded.add(function(e){g(e)})}function B(){}function F(g){g.onTriggerStateChangedObservable.add(function(e){e.pressed&&(e=(new Date).getTime(),e-p>m.n&&(p=e,n.a()))})}function f(g){g.onPadStateChangedObservable.add(function(e){(h=e.pressed)&&Math.abs(d)<m.l&&Math.abs(b)<m.l&&
console.log("Would reset camera view if you didn't get an error below...")});g.onPadValuesChangedObservable.add(function(e){d=e.y;b=e.x;Math.abs(b)<m.l&&Math.abs(d)<m.l?b=d=0:.5>Math.abs(b)?b=0:(b+=0<b?-.5:.5,b=2*b)});m.s.registerBeforeRender(function(){if(h){if(!r.a.equals(r.e)){var e=y.a(),k=r.a.subtract(e);k.normalize();k=k.scale(d*m.h*m.s.getAnimationRatio());y.e(e.subtract(k))}0!==b&&(e=(new Date).getTime(),e-q<m.m||(q=e,e=m.z.webVRCamera.rotationQuaternion.toEulerAngles(),e.y+=.25*Math.sign(b)*
Math.PI,m.z.webVRCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(e)))}})}a.d(c,"a",function(){return x});a.d(c,"b",function(){return B});var n=a("9bcR"),u=a("TqLJ"),r=a("ph2Y"),m=a("gqHH"),y=a("vCcv"),C=a("nV79"),p=0,q=0,d=0,b=0,h=!1},ph2Y:function(G,c,a){function x(){var q=1.5*n.a;n.s.registerBeforeRender(function(){a:{if(3===n.A.C)var d=n.s.activeCamera.getForwardRay();else if(2===n.A.C||1===n.A.C){d=void 0;1===n.A.C?(d=n.z.rightControllerGazeTrackerMesh,d||(d=n.z.leftControllerGazeTrackerMesh)):
2===n.A.C&&(d=n.z.gazeTrackerMesh);if(!d){console.log("error!");break a}d.isVisible?p.copyFrom(d.absolutePosition):p.copyFrom(m);d=f.a();d=new BABYLON.Ray(d,p.subtract(d))}else console.log("Unexpected error.");B(d)}void 0===p?(p.copyFrom(m),u.i(void 0)):10<BABYLON.Vector3.Distance(f.a(),p)&&(p.copyFrom(m),u.i(void 0));n.A.ba.position.copyFrom(p);void 0!==u.d&&(n.A.ba.isVisible=u.d!==u.h);d=f.a();var b=F(d).pickedPoint;b&&(y=b,d.y-b.y<q?(r.c.button.isVisible=!1,r.c.J.isVisible=!1):(r.c.button.isVisible=
!0,r.c.J.isVisible=!0));(b=F(p).pickedPoint)&&(C=b)})}function B(q,d){void 0===d&&(d=!0);q=n.s.pickWithRay(q,function(h){return u.c(h)});var b=q.distance;q.hit&&b<n.c?(d&&p.copyFrom(q.pickedPoint),u.i(q.pickedMesh)):(p.copyFrom(m),u.i(void 0))}function F(q){q=new BABYLON.Ray(q,new BABYLON.Vector3(0,-1,0),50);return n.s.pickWithRay(q,function(d){return d.id===n.A.H.id})}a.d(c,"e",function(){return m});a.d(c,"b",function(){return y});a.d(c,"c",function(){return C});a.d(c,"a",function(){return p});a.d(c,
"f",function(){return x});a.d(c,"d",function(){return F});var f=a("vCcv"),n=a("gqHH"),u=a("TqLJ"),r=a("jIpr"),m=new BABYLON.Vector3(-1E3,1E3,1E3),y=new BABYLON.Vector3(0,0,0),C=new BABYLON.Vector3(0,0,0),p=new BABYLON.Vector3(0,0,0)},qmVJ:function(G,c,a){function x(d){q=d}function B(){return new Promise(function(d){F(d)})}function F(d){C.h(function(){m.e();C.b(q,function(b){m.f();m.b()||(f(b),u.b(n.b));m.g();y.a();"nanokid.sdf"===q&&!1===m.b()&&setTimeout(function(){r.b("Load Molecule","pages/load.html")},
3E3);d()})})}function f(d){var b=d.selectedAtoms({});p={"Atom Name":[],Chain:[],Element:[],"Residue Index":[],"Residue Name":[],"Secondary Structure":[]};var h=b.length;for(d=0;d<h;d++){var g=b[d];p["Atom Name"].push(g.atom);p.Chain.push(g.chain);p.Element.push(g.elem);p["Residue Name"].push(g.resn);p["Residue Index"].push(g.resi);p["Secondary Structure"].push(g.ss)}b=Object.keys(p);h=b.length;for(d=0;d<h;d++){var e=b[d];g=p;var k=e;e=p[e];for(var D={},w=[],l=0,v=e.length;l<v;++l)D.hasOwnProperty(e[l])||
(w.push(e[l]),D[e[l]]=1);g[k]=w}}a.d(c,"a",function(){return p});a.d(c,"b",function(){return q});a.d(c,"c",function(){return x});a.d(c,"d",function(){return B});var n=a("jIpr"),u=a("BjG7"),r=a("iC5T"),m=a("p11u"),y=a("cw8d"),C=a("PjGz"),p={},q="nanokid.sdf"},sqbB:function(G,c,a){function x(){var r=f.s.lights[0],m=B();n.a()&&(u=new BABYLON.ShadowGenerator(4096,r),u.useBlurExponentialShadowMap=!0,u.G=!0,u.B=m.blur,u.setDarkness(m.ja))}function B(){var r=f.s.lights[0],m=64,y=.9625,C=void 0,p=r.name.match(/blur_([0-9\.]+)/g);
null!==p&&(m=+p[0].substr(5));p=r.name.match(/dark_([0-9\.]+)/g);null!==p&&(y=+p[0].substr(5));r=r.name.match(/ambient_([0-9\.]+)/g);null!==r&&(C=+r[0].substr(8));return{blur:m,ja:y,ia:C}}function F(){for(var r=f.s.meshes.length,m=0;m<r;m++){var y=f.s.meshes[m];if(-1!==y.name.toLowerCase().indexOf("shadowcatcher")||-1!==y.name.toLowerCase().indexOf("shadow_catcher"))y.material=new BABYLON.ShadowOnlyMaterial("shadow_catch"+m.toString(),f.s),y.material.activeLight=f.s.lights[0],y.receiveShadows=!0}}
a.d(c,"d",function(){return u});a.d(c,"c",function(){return x});a.d(c,"a",function(){return B});a.d(c,"b",function(){return F});var f=a("gqHH"),n=a("p11u"),u},uBLq:function(G,c,a){function x(d){p=new Float32Array(F.a().asArray());q=new Float32Array(F.b().asArray());(new C(function(b){!0===f.a&&console.log("stud1 got data",b);var h=b.val;switch(b.type){case "locrot":p=new Float32Array([h[0],h[1],h[2]]);q=new Float32Array([h[3],h[4],h[5],h[6]]);break;case "initialUrl":-1!==window.location.href.indexOf("nanokid.sdf")&&
(b=h+"&f="+y,b=b.replace(/sh=true/g,"sh=false"),top.location.href=b);break;case "toggleRep":u.b(h.filters,h.repName,h.colorScheme,void 0);break;case "molAxisRotation":r.a(h);break;case "molUndoRot":r.c()}})).Aa(d);n.s.registerBeforeRender(function(){var b=new Float32Array(F.a().asArray());b=B(b,p);b=BABYLON.Vector3.FromArray(b);F.e(b);b=new Float32Array(F.b().asArray());b=B(b,q);b=BABYLON.Quaternion.FromArray(b);F.f(b)})}function B(d,b){for(var h=d.length,g=new Float32Array(h),e=0;e<h;e++)g[e]=b[e]-
d[e];b=n.s.getAnimationRatio();var k=new Float32Array(h);for(e=0;e<h;e++)k[e]=d[e]+.02*b*g[e];return k}a.d(c,"a",function(){return x});var F=a("vCcv"),f=a("gg4m"),n=a("gqHH"),u=a("EYe7"),r=a("nKXq"),m=function(){function d(b,h){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,e){g.__proto__=e}||function(g,e){for(var k in e)e.hasOwnProperty(k)&&(g[k]=e[k])};return d(b,h)}return function(b,h){function g(){this.constructor=b}d(b,h);b.prototype=null===h?Object.create(h):(g.prototype=
h.prototype,new g)}}(),y,C=function(d){function b(h){var g=d.call(this)||this;g.M=null;g.ya=h;g.da();return g}m(b,d);b.prototype.Aa=function(h){var g=this;this.M&&this.M.close();this.M=this.F.connect(h,{reliable:!0});this.Ba();this.M.on("open",function(){!0===f.a&&console.log("Connected to: "+g.M.F)});y=h};b.prototype.da=function(){var h=this;this.F.on("close",function(){h.M=null;f.d()})};b.prototype.Ba=function(){var h=this;this.M.on("data",function(g){!0===f.a&&console.log("Received:",g);h.ya(g)});
this.M.on("close",function(){f.c("Leader connection closed.")})};return b}(f.b),p=null,q=null},vCcv:function(G,c,a){function x(){var p=m.s.activeCamera,q=p.position.clone();if(2===m.A.C||1===m.A.C)p.leftCamera?q.copyFrom(p.leftCamera.globalPosition):console.log("Prob here");return q}function B(p){if(3===m.A.C){var q=m.s.activeCamera;q.position.copyFrom(p)}else if(2===m.A.C||1===m.A.C)q=m.z.webVRCamera,q.position.copyFrom(p.subtract(u()))}function F(){if(2===m.A.C||1===m.A.C){var p=m.z.webVRCamera.deviceRotationQuaternion;
return 0!==p.x?p:m.s.activeCamera.rotationQuaternion}return m.s.activeCamera.rotationQuaternion}function f(p){2===m.A.C||1===m.A.C?console.log("PROBLEM!"):(m.s.activeCamera.rotationQuaternion=p.clone(),m.s.activeCamera.rotation=m.s.activeCamera.rotationQuaternion.toEulerAngles())}function n(){if(2===m.A.C||1===m.A.C){var p=r.c.subtract(r.b),q=BABYLON.Vector3.GetAngleBetweenVectors(p,y,C);for(0>p.z&&(q=-q);0>q;)q+=2*Math.PI;for(;q>2*Math.PI;)q-=2*Math.PI;return q+=.5*Math.PI}return m.s.activeCamera.rotation.clone().y}
function u(){if(3===m.A.C)return new BABYLON.Vector3(0,0,0);var p=m.z.webVRCamera,q;p.leftCamera?q=p.leftCamera.globalPosition.subtract(p.position):q=new BABYLON.Vector3(0,0,0);return q}a.d(c,"a",function(){return x});a.d(c,"e",function(){return B});a.d(c,"b",function(){return F});a.d(c,"f",function(){return f});a.d(c,"c",function(){return n});a.d(c,"d",function(){return u});var r=a("ph2Y"),m=a("gqHH"),y=new BABYLON.Vector3(1,0,0),C=new BABYLON.Vector3(1,0,0)},vMIs:function(G,c,a){function x(){BABYLON.SceneLoader.ImportMeshAsync(null,
"environs/arrow/","arrow.babylon",B.s).then(function(f){var n=f.meshes[0];n.scaling=new BABYLON.Vector3(.2,.2,.2);f=new BABYLON.StandardMaterial("arrowMat",B.s);f.diffuseColor=new BABYLON.Color3(.3,.35,.4);f.specularColor=new BABYLON.Color3(0,0,0);f.emissiveColor=new BABYLON.Color3(.3,.35,.4);n.material=f;var u=null;B.s.registerBeforeRender(function(){if(null===u&&(u=B.s.getMeshByName("protein_box"),null===u))return;n.position=F.b;n.lookAt(u.position)})})}a.d(c,"a",function(){return x});var B=a("gqHH"),
F=a("ph2Y")}},[["/7QA",1,2]]]);}).call(this || window)
