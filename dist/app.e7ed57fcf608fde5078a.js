(function(){'use strict';function T(D){var c=0;return function(){return c<D.length?{done:!1,value:D[c++]}:{done:!0}}}var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(D,c,a){D!=Array.prototype&&D!=Object.prototype&&(D[c]=a.value)},U="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;
function V(D,c){if(c){var a=U;D=D.split(".");for(var y=0;y<D.length-1;y++){var z=D[y];z in a||(a[z]={});a=a[z]}D=D[D.length-1];y=a[D];c=c(y);c!=y&&null!=c&&aa(a,D,{configurable:!0,writable:!0,value:c})}}V("Array.prototype.find",function(D){return D?D:function(c,a){a:{var y=this;y instanceof String&&(y=String(y));for(var z=y.length,C=0;C<z;C++){var f=y[C];if(c.call(a,f,C,y)){c=f;break a}}c=void 0}return c}});var W;
if("function"==typeof Object.setPrototypeOf)W=Object.setPrototypeOf;else{var X;a:{var ba={fa:!0},Y={};try{Y.__proto__=ba;X=Y.fa;break a}catch(D){}X=!1}W=X?function(D,c){D.__proto__=c;if(D.__proto__!==c)throw new TypeError(D+" is not extensible");return D}:null}var ca=W;V("Object.setPrototypeOf",function(D){return D||ca});function Z(D){var c="undefined"!=typeof Symbol&&Symbol.iterator&&D[Symbol.iterator];return c?c.call(D):{next:T(D)}}
V("Promise",function(D){function c(f){this.G=0;this.L=void 0;this.B=[];var q=this.I();try{f(q.resolve,q.reject)}catch(u){q.reject(u)}}function a(){this.B=null}function y(f){return f instanceof c?f:new c(function(q){q(f)})}if(D)return D;a.prototype.G=function(f){if(null==this.B){this.B=[];var q=this;this.I(function(){q.L()})}this.B.push(f)};var z=U.setTimeout;a.prototype.I=function(f){z(f,0)};a.prototype.L=function(){for(;this.B&&this.B.length;){var f=this.B;this.B=[];for(var q=0;q<f.length;++q){var u=
f[q];f[q]=null;try{u()}catch(t){this.K(t)}}}this.B=null};a.prototype.K=function(f){this.I(function(){throw f;})};c.prototype.I=function(){function f(t){return function(k){u||(u=!0,t.call(q,k))}}var q=this,u=!1;return{resolve:f(this.ta),reject:f(this.K)}};c.prototype.ta=function(f){if(f===this)this.K(new TypeError("A Promise cannot resolve to itself"));else if(f instanceof c)this.ua(f);else{a:switch(typeof f){case "object":var q=null!=f;break a;case "function":q=!0;break a;default:q=!1}q?this.sa(f):
this.W(f)}};c.prototype.sa=function(f){var q=void 0;try{q=f.then}catch(u){this.K(u);return}"function"==typeof q?this.va(q,f):this.W(f)};c.prototype.K=function(f){this.X(2,f)};c.prototype.W=function(f){this.X(1,f)};c.prototype.X=function(f,q){if(0!=this.G)throw Error("Cannot settle("+f+", "+q+"): Promise already settled in state"+this.G);this.G=f;this.L=q;this.ra()};c.prototype.ra=function(){if(null!=this.B){for(var f=0;f<this.B.length;++f)C.G(this.B[f]);this.B=null}};var C=new a;c.prototype.ua=function(f){var q=
this.I();f.Z(q.resolve,q.reject)};c.prototype.va=function(f,q){var u=this.I();try{f.call(q,u.resolve,u.reject)}catch(t){u.reject(t)}};c.prototype.then=function(f,q){function u(B,r){return"function"==typeof B?function(p){try{t(B(p))}catch(d){k(d)}}:r}var t,k,x=new c(function(B,r){t=B;k=r});this.Z(u(f,t),u(q,k));return x};c.prototype.catch=function(f){return this.then(void 0,f)};c.prototype.Z=function(f,q){function u(){switch(t.G){case 1:f(t.L);break;case 2:q(t.L);break;default:throw Error("Unexpected state: "+
t.G);}}var t=this;null==this.B?C.G(u):this.B.push(u)};c.resolve=y;c.reject=function(f){return new c(function(q,u){u(f)})};c.race=function(f){return new c(function(q,u){for(var t=Z(f),k=t.next();!k.done;k=t.next())y(k.value).Z(q,u)})};c.all=function(f){var q=Z(f),u=q.next();return u.done?y([]):new c(function(t,k){function x(p){return function(d){B[p]=d;r--;0==r&&t(B)}}var B=[],r=0;do B.push(void 0),r++,y(u.value).Z(x(B.length-1),k),u=q.next();while(!u.done)})};return c});
V("Math.sign",function(D){return D?D:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}});
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"/7QA":function(D,c,a){a.r(c);D=a("fcUb");c=a("SYky");a.n(c);c=a("p11u");a=a("gqHH");console.log("ProteinVR "+a.k);document.title="ProteinVR "+a.k;"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("service-worker.js",{scope:"./"}).then(function(y){console.log("SW registered: ",y)}).catch(function(y){console.log("SW registration failed: ",y)})});c.d();D.a();-1!==window.location.href.indexOf("durrantlab")&&
setTimeout(function(){(function(y,z,C,f,q,u,t){y.GoogleAnalyticsObject=q;y[q]=y[q]||function(){(y[q].q=y[q].q||[]).push(arguments)};y[q].Ga=(new Date).getTime();u=z.createElement(C);t=z.getElementsByTagName(C)[0];u.async=1;u.src=f;t.parentNode.insertBefore(u,t)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create","UA-144382730-1",{name:"proteinvr"});ga("proteinvr.send",{hitType:"event",eventCategory:"proteinvr",eventAction:"pageview",eventLabel:window.location.href})},
0)},"0fSa":function(D,c,a){function y(){setTimeout(function(){BABYLON.SceneOptimizer.OptimizeAsync(x.s,u())},5E3);x.s.autoClear=!1;x.s.autoClearDepthAndStencil=!1;for(var d=x.s.meshes.length,b=new BABYLON.Color3(0,0,0),m=0;m<d;m++){var g=x.s.meshes[m];-1!==g.name.indexOf("baked")&&void 0!==g.material&&(g.material.diffuseColor=b,g.material.specularColor=b,g.material.emissiveTexture=g.material.diffuseTexture,g.material.diffuseTexture=null,g.freezeWorldMatrix())}}function z(d){if(void 0!==d){d=d.getVerticesData(BABYLON.VertexBuffer.PositionKind);
if(null===d)return null;d=d.length/3}else d=0;return d}function C(d){var b=z(d);null===b||100>b||(b=1+Math.floor(b/x.d),1<b&&d.subdivide(b))}function f(d,b){void 0===b&&(b=!0);b&&d.material.freeze()}function q(){k.d&&(x.s.lights[0].autoUpdateExtends=!0,k.d.getShadowMap().refreshRate=BABYLON.RenderTargetTexture.REFRESHRATE_RENDER_ONCE,x.s.lights[0].autoUpdateExtends=!1)}function u(){var d=new BABYLON.SceneOptimizerOptions(25,2E3),b=0;d.optimizations.push(new BABYLON.ShadowsOptimization(b));d.optimizations.push(new BABYLON.LensFlaresOptimization(b));
d.optimizations.push(new BABYLON.PostProcessesOptimization(b));d.optimizations.push(new BABYLON.ParticlesOptimization(b));d.optimizations.push(new B(b));b++;d.optimizations.push(new r(b));d.optimizations.push(new B(b));b++;d.optimizations.push(new BABYLON.TextureOptimization(b,512));d.optimizations.push(new B(b));b++;d.optimizations.push(new BABYLON.RenderTargetsOptimization(b));d.optimizations.push(new BABYLON.TextureOptimization(b,256));d.optimizations.push(new B(b));b++;d.optimizations.push(new BABYLON.HardwareScalingOptimization(b,
4));d.optimizations.push(new p(b,500));d.optimizations.push(new B(b));return d}function t(d){null!==d&&d.dispose()}a.d(c,"d",function(){return y});a.d(c,"b",function(){return C});a.d(c,"a",function(){return f});a.d(c,"e",function(){return q});a.d(c,"c",function(){return t});var k=a("sqbB"),x=a("gqHH"),B=function(){return function(d){var b=this;void 0===d&&(d=0);this.priority=d;this.apply=function(){console.log("Optimization priority:",b.priority);console.log("FPS:",x.r.getFps());console.log("");return!0};
this.getDescription=function(){return"Reports the current priority. For debugging."}}}(),r=function(){return function(d){"undefined"===typeof d&&(d=0);this.priority=d;this.apply=function(){var b=x.s.getMeshByName("surfaces.wrl");t(b);return!0};this.getDescription=function(){return"Removes surface representations."}}}(),p=function(){return function(d,b,m){void 0===m&&(m=void 0);"undefined"===typeof d&&(d=0);this.priority=d;this.apply=function(){for(var g=[],e=x.s.meshes.length,n=0;n<e;n++){var E=x.s.meshes[n];
if(-1===E.name.indexOf("Decimated")){var v=z(E);null!==v&&(v<b||g.push([v,E,void 0===m?1-b/v:m]))}}g.sort(function(l,F){return F[0]-l[0]});e=g.length;for(n=0;n<e;n++){v=g[n];E=v[1];for(v=v[2];0<E.getLODLevels().length;){var h=E.getLODLevels()[0].mesh;E.removeLODLevel(h);t(h)}E.simplify([{quality:v,distance:.001}],!1,BABYLON.SimplificationType.QUADRATIC,function(){})}return!0};this.getDescription=function(){return"Simplifies the geometry of complex objects in the scene."}}}()},"1RHl":function(D,c,
a){function y(){f=z.s.cameras.filter(function(u){return-1===u.name.indexOf("VR")})[0];var q=new BABYLON.DeviceOrientationCamera("DevOr_camera",f.position.clone(),z.s,!0);q.rotation=f.rotation.clone();z.s.activeCamera=q;z.s.activeCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(f.rotation);z.q();C.b()}a.d(c,"a",function(){return y});var z=a("gqHH"),C=a("ejGh"),f},"9bcR":function(D,c,a){(function(y){function z(){p.A.H=p.s.getMeshByID("ground");null===p.A.H&&alert("No mesh named ground");
p.A.H.checkCollisions=!0;p.A.H.visibility=0;r.b(p.A.H);d.f({Y:q,mesh:p.A.H});p.A.C=3;f();b.f();k();C()}function C(){e=x.a();p.s.registerBeforeRender(function(){var l=x.a();null===b.d(l).pickedMesh&&n===p.s.activeCamera.id?x.e(e):(e=l,n=p.s.activeCamera.id)})}function f(){y("body").keypress(function(l){32===l.charCode?q():109===l.charCode&&g.c.N()})}function q(){if(void 0===m.h){var l=(new Date).getTime();if(!(250>l-E))switch(E=l,d.e()){case 2:console.log("teleport");u();break;case 4:t();break;case 3:d.d.F()}}}
function u(l,F){void 0===l&&(l=void 0);void 0===F&&(F=void 0);void 0===F&&(F=function(){});p.z.gazeTrackerMesh.isVisible=!1;var G=new BABYLON.Animation("animationCameraTeleportation","position",90,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),A=x.a();void 0===l&&(l=new BABYLON.Vector3(b.a.x,b.a.y+p.o,b.a.z));var w=x.d();l=l.subtract(w);A=A.subtract(w);G.setKeys([{frame:0,value:A},{frame:p.j,value:l}]);var I=p.s.activeCamera;I.animations=[];I.animations.push(G);
p.s.beginAnimation(I,0,p.j,!1,1,function(){p.z.gazeTrackerMesh.isVisible=!0;I.animations=[];F()})}function t(){var l=b.c,F=x.a(),G=b.a.subtract(F),A=G.length(),w;.1*A<p.g?w=b.a.subtract(G.normalize().scale(p.g)):.1*A>p.b?w=b.a.subtract(G.normalize().scale(p.b)):.1*A<p.b&&(w=F.add(G.scale(.9)));w.y=b.a.y;w.y-l.y<.5*p.a+.1&&(w.y=l.y+.5*p.a+.1);p.v(b.a.y-l.y);u(w,function(){B.a()})}function k(){v=y("#capture-clicks");v.click(function(){console.log("clicked!");q()});p.s.registerBeforeRender(function(){var l=
p.s.activeCamera.inputs.attached.deviceOrientation;(l=l?0!==l._alpha||0!==l._beta||0!==l._gamma:!1)&&!h?(h=!0,v.show()):!l&&h&&(h=!1,v.hide())})}a.d(c,"b",function(){return z});a.d(c,"a",function(){return q});var x=a("vCcv"),B=a("ejGh"),r=a("0fSa"),p=a("gqHH"),d=a("TqLJ"),b=a("ph2Y"),m=a("p11u"),g=a("jIpr"),e,n="",E=0,v=void 0,h=!1}).call(this,a("EVdn"))},BjG7:function(D,c,a){function y(){function m(E){function v(F){var G=r[h][F];g.Components[h][G]=q({},h,function(A,w){t.b([h,G],A,w)})}var h=B[E];
g.Components[h]={};E=r[h].length;for(var l=0;l<E;l++)v(l)}for(var g={Components:{},Selections:{},Clear:function(){for(var E=Object.keys(t.a),v=E.length,h=0;h<v;h++)t.a[E[h]].mesh.isVisible=!1;x.c.N()},"Remove Existing":{}},e=B.length,n=0;n<e;n++)m(n);return g}function z(m){if(!k.b()){m.Styles["Remove Existing"]={};x.e(m.Styles["Remove Existing"],["Styles","Remove Existing"]);for(var g=Object.keys(t.a),e=g.length,n=function(v){var h=g[v];!0===t.a[h].mesh.isVisible&&(v=h.replace(/--/g," "),v=v.replace(/{/g,
"").replace(/}/g,"").replace(/"/g,""),m.Styles["Remove Existing"][v]=function(){x.c.N();setTimeout(function(){var l=k.c(h);t.b(l[0],l[1],"Hide")},0)})},E=0;E<e;E++)n(E)}}function C(m){function g(F,G,A,w){function I(J){J=H[J];if(1===J.length){var K=J[0];G[K]={};G[K]=q(G[K],F,function(O,P){var M={};M[e[F]]=K;t.b([M],O,P)},w.concat([K]))}else{var N="["+J[0].toString()+"-"+J[J.length-1].toString()+"]";G[N]={};g(F,G[N],J,w.concat([N]))}}A.sort(function(J,K){J=isNaN(+J)?J:+J;K=isNaN(+K)?K:+K;return J<K?
-1:J>K?1:0});var H=f(A,14);A=H.length;for(var L=0;L<A;L++)I(L);x.e(G,w)}m.Styles.Selections={};x.e(m.Styles.Selections,["Styles","Selections"]);for(var e={"Atom Name":"atom",Chain:"chain",Element:"elem","Residue Index":"resi","Residue Name":"resn","Secondary Structure":"ss"},n=Object.keys(u.a),E=n.length,v=0;v<E;v++){var h=n[v],l=u.a[h];m.Styles.Selections[h]={};g(h,m.Styles.Selections[h],l,["Styles","Selections",h])}}function f(m,g){if(2>g)return[m];var e=m.length,n=[],E=0,v;if(0===e%g)for(v=Math.floor(e/
g);E<e;)n.push(m.slice(E,E+=v));else for(;E<e;)v=Math.ceil((e-E)/g--),n.push(m.slice(E,E+=v));return n}function q(m,g,e,n){function E(l){function F(I){var H=d[I];m[A].Colors[H]=function(){e(A,H);x.c.N()}}function G(I){var H=b[I];m[A]["Color Schemes"][H]=function(){e(A,H);x.c.N()}}var A=v[l];m[A]={Colors:{},"Color Schemes":{}};l=b.length;for(var w=0;w<l;w++)G(w);l=d.length;for(w=0;w<l;w++)F(w);m[A].Hide=function(){e(A,"Hide");x.c.N()};void 0!==n&&(l=n.concat([A]),x.e(m[A],l),l=n.concat([A,"Colors"]),
w=m[A].Colors,x.e(w,l),l=n.concat([A,"Color Schemes"]),w=m[A]["Color Schemes"],x.e(w,l))}var v=void 0===p[g]?p.Protein:p[g];g=v.length;for(var h=0;h<g;h++)E(h);void 0!==n&&x.e(m,n);return m}a.d(c,"a",function(){return y});a.d(c,"c",function(){return z});a.d(c,"b",function(){return C});var u=a("qmVJ"),t=a("EYe7"),k=a("p11u"),x=a("jIpr"),B=["Protein","Ligand","Ligand Context","Water","Nucleic"],r={Ligand:["All"],"Ligand Context":["All"],Nucleic:["All"],Protein:["All","Hydrophobic","Hydrophilic","Charged",
"Aromatic"],Water:["All"]};D=["Stick","Sphere","Surface"];var p={Ligand:D,"Ligand Context":["Cartoon"].concat(D),Nucleic:D,Protein:["Cartoon"].concat(D),Water:D},d="White Red Blue Green Orange Yellow Purple".split(" "),b=["Element","Amino Acid","Chain","Nucleic","Spectrum"]},EYe7:function(D,c,a){function y(e,n,E,v){void 0===v&&(v=void 0);d.a&&d.b(e,n,E);var h=C(e,n,E);void 0===v&&(v=function(){});if("Hide"===E){E=Object.keys(b);e=E.length;for(var l=0;l<e;l++){var F=b[E[l]];F.O===h.O&&(F.mesh.isVisible=
!1,console.log("Hiding existing mesh..."))}r.b(void 0,B.s.getMeshByName("protein_box"));q()}else void 0!==b[h.aa]?(b[h.aa].mesh.isVisible=!0,console.log("showing existing mesh..."),r.b(void 0,B.s.getMeshByName("protein_box")),q()):(p.e(),E=g[E],e={and:e.map(function(G){return void 0!==m[G]?m[G]:G})},"surface"===n.toLowerCase()?p.a(E,e,function(){z(h,n,v)}):(l={},l[n.toLowerCase()]=E,p.g(e,l),z(h,n,v)))}function z(e,n,E){p.d(!0,n,function(v){for(var h=Object.keys(b),l=h.length,F=0;F<l;F++){var G=h[F],
A=b[G];A.O===e.O&&(u.c(A.mesh),delete b[G],console.log("deleting old mesh..."))}void 0!==v&&("Surface"===n&&(v.material.backFaceCulling=!1),b[e.aa]={O:e.O,mesh:v});q();E()})}function C(e,n,E){e.sort();e=e.map(function(v){return"string"===typeof v?v:JSON.stringify(v)});return{O:e.join("--")+"--"+n,aa:e.join("--")+"--"+n+"--"+E}}function f(e){for(var n=e.map(function(l){return l}),E=e.length,v=0;v<E;v++){var h=e[v];n.push(h.toUpperCase());n.push(h.toLowerCase())}return n=n.filter(function(l,F){return n.indexOf(l)>=
F})}function q(){x.f();k.c(t.b)}a.d(c,"a",function(){return b});a.d(c,"b",function(){return y});var u=a("0fSa"),t=a("jIpr"),k=a("BjG7"),x=a("p11u"),B=a("gqHH"),r=a("YORc"),p=a("PjGz"),d=a("mvtX"),b={},m={All:{},Protein:{resn:f("ALA ARG ASP ASN ASX CYS GLN GLU GLX GLY HIS HSP HYP ILE LEU LYS MET PCA PHE PRO TRP TYR VAL GLU SER THR MSE".split(" "))},Acidic:{resn:f(["ASP","GLU"])},Cyclic:{resn:f(["HIS","PHE","PRO","TRP","TYR"])},Aliphatic:{resn:f(["ALA","GLY","ILE","LEU","VAL"])},Aromatic:{resn:f(["HIS",
"PHE","TRP","TYR"])},Basic:{resn:f(["ARG","HIS","LYS","HSP"])},Charged:{resn:f("ASP GLU ARG HIS LYS HSP".split(" "))},Hydrophobic:{resn:f("ALA LEU VAL ILE PRO PHE MET TRP".split(" "))},Neutral:{resn:f("VAL PHE GLN TYR HIS CYS MET TRP ASX GLX PCA HYP".split(" "))},Nucleic:{resn:f("ADE A GUA G CYT C THY T URA U DA DG DC DT".split(" "))},Purine:{resn:f(["ADE","A","GUA","G"])},Pyrimidine:{resn:f("CYT C THY T URA U".split(" "))},Ions:{resn:f("AL BA CA CAL CD CES CLA CL CO CS CU CU1 CUA HG IN IOD K MG MN3 MO3 MO4 MO5 MO6 NA NAW OC7 PB POT PT RB SOD TB TL WO4 YB ZN ZN1 ZN2".split(" "))},
Water:{resn:f(["WAT","HOH","TIP","TIP3"])}};m.Ligand={not:{or:[m.Protein,m.Nucleic,m.Ions,m.Water]}};m["Ligand Context"]={byres:!0,within:{distance:4,sel:m.Ligand}};var g={"Amino Acid":{colorscheme:"amino"},Blue:{color:"blue"},Chain:{colorscheme:"chain"},Element:{colorscheme:"default"},Green:{color:"green"},Nucleic:{colorscheme:"nucleic"},Orange:{color:"orange"},Purple:{color:"purple"},Red:{color:"red"},Spectrum:{color:"spectrum"},White:{color:"white"},Yellow:{color:"yellow"}}},O2BG:function(D,c,
a){D.Ea=a.p+"cf4bd43cd8dade4b62f7e691f5d0f8cc.mp3"},PjGz:function(D,c,a){(function(y,z){function C(H){var L=y("#mol-container");L&&L.remove();y("body").append('<div\n        id="mol-container"\n        class="mol-container"\n        style="display:none;"></div>');h=y("#mol-container");l={backgroundColor:"white"};v=z.createViewer(h,l);window.viewer=v;H()}function f(){I&&(I=!1,v=null,C(function(){v.addModel(A,"pdb")}));v.setStyle({},{})}function q(H,L){y.ajax(H,{success:function(J){A=J;w="pdb";"sdf"===
H.slice(H.length-3).toLowerCase()&&(w="sdf");J=v.addModel(J,w);L(J)},error:function(J,K,N){J="<p>Could not load molecule: "+H+"</p>";J=J+("<p><pre>"+N+'</pre></p><p>(<a href="')+(window.location.href.split("?")[0]+'">Click to restart...</a>)</p>');e.a("Error Loading Molecule",J,!1,!1)}})}function u(H,L){void 0!==H.and&&1===Object.keys(H).length&&"{}"===JSON.stringify(H.and[0])&&2===H.and.length&&(H=H.and[1]);v.setStyle(H,L);v.render()}function t(H,L,J){I=!0;v.addSurface(z.SurfaceType.MS,H,L,void 0,
void 0,function(){J()})}function k(H,L,J){void 0===J&&(J=function(){});b.r.hideLoadingUI();H&&x(function(){B(L,function(){var K=new BABYLON.StandardMaterial("Material",b.s);K.diffuseColor=new BABYLON.Color3(1,1,1);K.emissiveColor=new BABYLON.Color3(0,0,0);K.specularColor=new BABYLON.Color3(0,0,0);for(var N=[],O=n.length,P=0;P<O;P++){var M=n[P],Q=[];BABYLON.VertexData.ComputeNormals(M.coors,M.trisIdxs,Q);var R=new BABYLON.VertexData;R.positions=M.coors;R.indices=M.trisIdxs;R.normals=Q;R.colors=M.colors;
M=new BABYLON.Mesh("mesh_3dmol_tmp"+P,b.s);R.applyToMesh(M);M.material=K;N.push(M)}if(0<N.length){var S=BABYLON.Mesh.MergeMeshes(N,!0,!0);S.name="MeshFrom3DMol"+Math.random().toString();S.id=S.name;m.c(S,123456789)}K=S;void 0!==K&&g.b(K,b.s.getMeshByName("protein_box"));J(K);n=[]})})}function x(H){F=v.exportVRML();H()}function B(H,L){n=[];if("undefined"!==typeof Worker)G.onmessage=function(J){J=J.data;var K=J.chunk;J=J.status;if(void 0!==K){var N=K[0],O=K[1],P=K[2];n.length===N&&n.push({coors:new Float32Array(0),
colors:new Float32Array(0),trisIdxs:new Uint32Array(0)});K=n[N];N=[n[N][O],P];var M=0;P=N.length;for(var Q=0;Q<P;Q++){var R=N[Q];M+=R.length}M=new ("trisIdxs"===O?Uint32Array:Float32Array)(M);var S=0;for(Q=0;Q<P;Q++)R=N[Q],M.set(R,S),S+=R.length;K[O]=M}switch(J){case "more":G.postMessage({cmd:"sendDataChunk",data:void 0});break;case "done":L();break;default:console.log("Error here!")}},G.postMessage({cmd:"start",data:F,removeExtraPts:"Stick"===H});else throw e.a("Browser Error","Your browser does not support web workers. Please use a more\n            modern browser when running ProteinVR.",
!1),Error("Browser does not support web workers.");}function r(H,L){E[H]+=L;d.f()}function p(H,L,J){E=new BABYLON.Vector3(H,L,J)}a.d(c,"c",function(){return E});a.d(c,"h",function(){return C});a.d(c,"e",function(){return f});a.d(c,"b",function(){return q});a.d(c,"g",function(){return u});a.d(c,"a",function(){return t});a.d(c,"d",function(){return k});a.d(c,"i",function(){return r});a.d(c,"f",function(){return p});var d=a("p11u"),b=a("gqHH"),m=a("cw8d"),g=a("YORc"),e=a("iC5T"),n=[],E=new BABYLON.Vector3(0,
0,0),v,h,l,F,G=new Worker("vrmlWebWorker.js"),A="",w="pdb",I=!1}).call(this,a("EVdn"),a("VS3o"))},Rr3C:function(D,c,a){function y(){document.getElementById("loadingContainer").outerHTML=""}function z(t){f();q.r.displayLoadingUI();q.r.loadingUIText=t}function C(t){var k=t;clearInterval(u);u=setInterval(function(){k+=.02*(99-k);q.r.displayLoadingUI();q.r.loadingUIText="Loading the main scene... "+k.toFixed(0)+"%"},100)}function f(){clearInterval(u)}a.d(c,"b",function(){return y});a.d(c,"a",function(){return z});
a.d(c,"c",function(){return C});a.d(c,"d",function(){return f});var q=a("gqHH"),u},TqLJ:function(D,c,a){function y(n){e=n}function z(){d.push(r.A.H)}function C(n){d.push(n);b.push(n);B.b(n);t({mesh:n,Y:function(){n.F()}})}function f(n){d.push(n);m.push(n);B.b(n);t({mesh:n})}function q(n){return n.id===r.A.H.id?!0:n.isVisible?-1!==d.indexOf(n):!1}function u(){return void 0===e?1:e===r.A.H?2:-1!==b.indexOf(e)?3:-1!==m.indexOf(e)?4:e===g?5:1}function t(n){void 0===n.Y&&(n.Y=p.a);void 0===n.ca&&(n.ca=
r.s);void 0!==n.mesh&&(n.mesh.actionManager=new BABYLON.ActionManager(n.ca),n.mesh.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){3===r.A.C&&n.Y()})))}function k(){g=BABYLON.Mesh.CreateSphere("padNavSphereAroundCamera",4,r.c-1,r.s);g.flipFaces(!0);var n=new BABYLON.StandardMaterial("padNavSphereAroundCameraMat",r.s);n.diffuseColor=new BABYLON.Color3(1,1,1);n.specularColor=new BABYLON.Color3(0,0,0);n.B=null;g.material=n;g.visibility=0;r.s.registerBeforeRender(function(){g.position=
x.a()});d.push(g)}a.d(c,"h",function(){return g});a.d(c,"i",function(){return y});a.d(c,"d",function(){return e});a.d(c,"j",function(){return z});a.d(c,"a",function(){return C});a.d(c,"b",function(){return f});a.d(c,"c",function(){return q});a.d(c,"e",function(){return u});a.d(c,"f",function(){return t});a.d(c,"g",function(){return k});var x=a("vCcv"),B=a("0fSa"),r=a("gqHH"),p=a("9bcR"),d=[],b=[],m=[],g,e},YORc:function(D,c,a){function y(d,b,m){void 0===m&&(m=!1);var g=C(d);void 0===r&&(r=x.c.clone());
d=g.map(function(O){return{mesh:O,position:O.position.clone(),rotation:r.clone(),scaling:O.scaling.clone()}});r=x.c.clone();if(0!==g.length){f(g);t.s.render();var e=b.getBoundingInfo().boundingBox,n=Object.keys(e.maximumWorld).map(function(O){return e.maximumWorld[O]-e.minimumWorld[O]}),E=0,v,h,l,F=g.length,G=function(O){O=g[O];var P=O.getBoundingInfo().boundingBox,M=Object.keys(P.maximumWorld).map(function(R){return P.maximumWorld[R]-P.minimumWorld[R]}),Q=M[0]*M[1]*M[2];Q>E&&(E=Q,v=P,h=M,l=O)};for(b=
0;b<F;b++)G(b);b=n.map(function(O,P){return O/h[P]});b=Math.min.apply(null,b);G=new BABYLON.Vector3(b,b,b);for(b=0;b<F;b++)n=g[b],n.scaling=G;t.s.render();G=v.centerWorld.subtract(e.centerWorld);for(b=0;b<F;b++)n=g[b],n.position=n.position.subtract(G);t.s.render();G=0;t.t.oa&&(G=z(l,e));for(b=0;b<F;b++)n=g[b],n.position.y=n.position.y-G,n.visibility=1;B=d[0].rotation.clone();if(!0===m)for(m=d.length,b=0;b<m;b++){var A=d[b];F=A.mesh;var w=F.position.clone(),I=F.scaling.clone(),H=F.rotation.clone();
n=q("posX","position.x",A.position.x,w.x);G=q("posY","position.y",A.position.y,w.y);w=q("posZ","position.z",A.position.z,w.z);var L=q("scaX","scaling.x",A.scaling.x,I.x),J=q("scaY","scaling.y",A.scaling.y,I.y);I=q("scaZ","scaling.z",A.scaling.z,I.z);var K=q("rotX","rotation.x",A.rotation.x,H.x),N=q("rotY","rotation.y",A.rotation.y,H.y);A=q("rotZ","rotation.z",A.rotation.z,H.z);F.animations=[n,G,w,L,J,I,K,N,A];t.s.beginAnimation(F,0,15,!1,1,function(){u.e()})}else u.e()}}function z(d,b){var m=Math.PI;
m=d.name+"-"+(d.rotation.x%m).toFixed(3)+"-"+(d.rotation.y%m).toFixed(3)+"-"+(d.rotation.z%m).toFixed(3);if(void 0!==p[m])return p[m];var g=d.getVerticesData(BABYLON.VertexBuffer.PositionKind),e=1E6,n=g.length;d=d.getWorldMatrix();for(var E=Math.max(1,3*Math.floor(n/3E3)),v=0;v<n;v+=E){var h=new BABYLON.Vector3(g[v],g[v+1],g[v+2]);h=BABYLON.Vector3.TransformCoordinates(h,d);h.y<e&&(e=h.y)}b=e-b.minimumWorld.y-.1;return p[m]=b}function C(d){for(var b=[],m=Object.keys(k.a),g=m.length,e=0;e<g;e++){var n=
k.a[m[e]].mesh;!0===n.isVisible&&b.push(n)}void 0!==d&&b.push(d);return b}function f(d){for(var b=d.length,m=0;m<b;m++){var g=d[m];g.animations=[];!0===g.isVisible&&(g.scaling=new BABYLON.Vector3(1,1,1),g.position=new BABYLON.Vector3(0,0,0),g.rotation=x.c,g.visibility=0)}}function q(d,b,m,g){d=new BABYLON.Animation(d,b,60,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);d.setKeys([{frame:0,value:m},{frame:15,value:g}]);return d}a.d(c,"a",function(){return B});a.d(c,
"b",function(){return y});var u=a("0fSa"),t=a("gqHH"),k=a("EYe7"),x=a("PjGz"),B=new BABYLON.Vector3(0,0,0),r=void 0,p={}},cw8d:function(D,c,a){function y(){k.c();t.d();u.A.ma&&q.d();f.e()}function z(){k.b();if(!0===u.t.qa)if(u.A.H){u.A.H.visibility=1;var r=new BABYLON.StandardMaterial("transparentGround",u.s);r.diffuseColor=new BABYLON.Color3(1,1,1);r.specularColor=new BABYLON.Color3(0,0,0);r.emissiveColor=new BABYLON.Color3(0,0,0);r.alpha=u.i;u.A.H.material=r}else console.log("Warning: Vars.vrVars.groundMesh not defined.");
B.b()}function C(r,p){if(void 0!==r.material&&null!==r.material){var d=k.a();void 0===d.ha?(d=d.ia,d=.95<d?.05:.4>d?.0025:.013636363636363637*d-.0029545454545454545):d=d.ha;r.material.emissiveColor=new BABYLON.Color3(d,d,d);f.a(r)}r.scaling.z=-1;0<p&&(r.scaling.x=-1);k.d&&k.d.getShadowMap().renderList.push(r);x.b(r)}a.d(c,"b",function(){return y});a.d(c,"a",function(){return z});a.d(c,"c",function(){return C});var f=a("0fSa"),q=a("jIpr"),u=a("gqHH"),t=a("qmVJ"),k=a("sqbB"),x=a("TqLJ"),B=a("fcUb")},
ejGh:function(D,c,a){function y(){f=C.s.activeCamera;f.keysUp=[87,38];f.keysDown=[83,40];f.keysLeft=[65,37];f.keysRight=[68,39];C.s.gravity=new BABYLON.Vector3(0,-.1,0);f.applyGravity=!0;z();C.s.collisionsEnabled=!0;f.checkCollisions=!0;f.speed=.1;f.attachControl(C.p,!0);f._updatePosition()}function z(){f.ellipsoid=new BABYLON.Vector3(1,.5*C.o,1)}a.d(c,"b",function(){return y});a.d(c,"a",function(){return z});var C=a("gqHH"),f;new BABYLON.Vector3(0,0,0)},fRJN:function(D,c,a){(function(y){function z(){C()}
function C(){function t(b){y("#"+b.id).click(function(){b.F()})}for(var k=[{$:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n                    width="48px" height="48px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve">\n                    <g>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linejoin="round" d="M41.99,17.573v-5.209\n                            c0-0.588-0.717-1.092-1.615-1.092H25.123V8.92c0-0.336-0.449-0.672-0.987-0.672H1.077C0.449,8.248,0,8.583,0,8.92v3.444\n                            c0,0,0,0,0,0.084v25.877c0,0.588,0.717,1.092,1.615,1.092h38.671"/>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linejoin="round" d="M7.985,17.573h38.67\n                            c0.898,0,1.526,0.504,1.347,1.008l-5.295,19.744c-0.089,0.588-0.985,1.092-1.884,1.092H2.064c-0.898,0-1.526-0.504-1.347-1.008\n                            l5.294-19.744C6.19,18.077,7.088,17.573,7.985,17.573L7.985,17.573"/>\n                    </g>\n                    </svg>',
title:"open",id:"open-button",F:function(){window.PVR_warning=!0;f.a("Load Molecule","pages/load.html")}},{$:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                    x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="\n                            M35.5,9.8c1.7,5.4-0.6,8-1.6,8.9c-1.9,1.9-4.5,4.7-5.8,7c-1.5,2.7-4.1,12-6.8,4.4c-3.2-9.1,1.3-11.6,3.5-13.4\n                            c1.5-1.3,3.4-4.3,0.5-5.3c-4-1.3-6.1,5.3-10.7,4c-3-0.8-3.2-4.1-2.2-6.6C15.4,1.7,32.5,0.6,35.5,9.8L35.5,9.8z"/>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" d="M28.3,39.6c0-5.5-8.5-5.5-8.5,0S28.3,45.1,28.3,39.6"/>\n                  </svg>',
title:"Help",id:"help-button",F:function(){f.a("Help: ProteinVR "+q.k,"pages/help.html",!0,!0)}},{$:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n             \t    x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                    <path fill="none" stroke="#FFFFFF" stroke-width="1.5" d="M35.4,4.6c-3.2,0-5.8,2.4-5.8,5.8l0,0c0,0.5,0.2,1.1,0.5,1.4l-13.4,7.8\n             \t    c-1-1.4-2.6-1.8-4.1-1.8c-3.2,0-5.8,2.4-5.8,5.8l0,0c0,2.9,2.6,5.8,5.8,5.8l0,0c1.3,0,2.2-0.5,3.2-1.4l13.6,8.3\n             \t    c-0.3,0.4-0.3,0.9-0.3,1.4c0,3.4,2.7,5.8,5.9,5.8l0,0c3.2,0,5.6-2.4,5.6-5.8l0,0c0-2.9-2.4-5.9-5.6-5.9l0,0c-1.7,0-3.2,1.1-4.4,2\n             \t    l-13.1-7.3c0.5-0.9,0.7-2,0.7-2.9c0-0.5,0-1.4-0.2-2l13.3-7.3c1,0.9,2.5,1.5,4.1,1.5c3.2,0,5.9-2.5,5.9-5.4l0,0\n             \t    C41.3,6.9,38.5,4.6,35.4,4.6L35.4,4.6L35.4,4.6z"/>\n                 </svg>',
title:"Share (Leader)",id:"leader",F:function(){u.e()}},{$:'<svg style="position:relative; left:0.5px;" width="48px" height="48px" xmlns="http://www.w3.org/2000/svg"\n                    xmlns:svg="http://www.w3.org/2000/svg" clip-rule="evenodd">\n                    <g class="layer">\n                        <path d="m47.799999,43.649999l-47.699999,0l0,-39.749999l47.699999,0l0,39.749999zm-1.9875,-37.762499l-43.724999,0l0,35.774999l43.724999,0l0,-35.774999zm-7.95,13.9125l-1.9875,0l0,-6.441487l-22.341487,22.341487l6.441487,0l0,1.9875l-9.9375,0l0,-9.9375l1.9875,0l0,6.441487l22.341487,-22.341487l-6.441487,0l0,-1.9875l9.9375,0l0,9.9375z" fill="#ffffff" id="svg_1"/>\n                    </g>\n                  </svg>',
title:"Full Screen",id:"fullscreen-button",F:function(){q.r.switchFullscreen(!0);y("#renderCanvas").focus()}}],x="",B=60,r=0,p=k.reverse();r<p.length;r++){var d=p[r];x+='\n            <button\n                title="'+d.title+'"\n                id="'+d.id+'"\n                class="ui-button"\n                style="color:white;\n                    width:80px;\n                    height:50px;\n                    right:5px;\n                    position:absolute;\n                    bottom:'+
B.toString()+'px;\n                    background-color:rgba(51,51,51,0.7);\n                    border:none;\n                    outline:none;\n                    cursor:pointer;">\n                    '+d.$+"\n            </button>";B+=55}y("body").append(x);for(x=0;x<k.length;x++)d=k[x],t(d);k=document.getElementById("babylonVRiconbtn");null!==k&&(k.style.opacity="1.0",k.style.filter="alpha(opacity=1.0)")}a.d(c,"a",function(){return z});var f=a("iC5T"),q=a("gqHH"),u=a("mvtX")}).call(this,a("EVdn"))},
fcUb:function(D,c,a){(function(y){function z(){e.x();m.b();C();f(function(){B.a();E.b()?(e.A.C=3,e.s.getMeshByID("ground").visibility=0,e.A.ba.isVisible=!1):(d.b(),b.j());p.b();g.a()});window.addEventListener("resize",function(){e.r.resize()})}function C(){var v=BABYLON.Mesh.CreateSphere("navTargetMesh",4,.1,e.s),h=new BABYLON.StandardMaterial("myMaterial",e.s);h.diffuseColor=new BABYLON.Color3(1,0,1);v.material=h;v.Ja=2;e.y({ba:v});r.a();n.d()}function f(v){m.a("Loading the main scene...");BABYLON.SceneLoader.LoadAssetContainer(e.u,
"scene.babylon",e.s,function(h){m.c(90);e.s.executeWhenReady(function(){y.getJSON(e.u+"scene_info.json",function(l){!1===l.menuActive&&(e.A.ma=!1);void 0!==l.positionOnFloor&&(e.t.oa=l.positionOnFloor);void 0!==l.infiniteDistanceSkyBox&&(e.t.ka=l.infiniteDistanceSkyBox);void 0!==l.transparentGround&&(e.t.qa=l.transparentGround);h.addAllToScene();e.s.activeCamera=e.s.cameras.filter(function(F){return-1===F.name.indexOf("VR")})[0];q();u();t();k();v()})})},function(h){h.lengthComputable&&m.a("Loading the main scene... "+
Math.round(90*h.loaded/h.total).toString()+"%")})}function q(){for(var v=!1,h=0;1<e.s.lights.length;){var l=e.s.lights[h].name.toLowerCase();-1===l.indexOf("shadowlight")&&-1===l.indexOf("shadow_light")?e.s.lights[h].dispose():v?e.s.lights[h].dispose():(v=!0,h++)}}function u(){for(var v=e.s.meshes.length,h=0;h<v;h++){var l=e.s.meshes[h];"protein_box"===l.name?l.isVisible=!1:-1!==l.name.toLowerCase().indexOf("skybox")&&e.t.ka&&(l.material.disableLighting=!0,l.infiniteDistance=!0)}}function t(){for(var v=
e.s.meshes.length,h=0;h<v;h++){var l=e.s.meshes[h];l.material&&l.material.emissiveTexture&&(l.material.emissiveColor=new BABYLON.Color3(1,1,1),l.material.albedoColor=new BABYLON.Color3(0,0,0),l.material.Da=new BABYLON.Color3(0,0,0))}}function k(){for(var v=e.s.meshes.length,h=0;h<v;h++)if(e.s.meshes[h].material){var l=e.s.meshes[h];if(void 0===l.material.emissiveTexture||null===l.material.emissiveTexture)l.material.emissiveTexture=l.material.diffuseTexture,l.material.diffuseColor=new BABYLON.Color3(0,
0,0),l.material.specularColor=new BABYLON.Color3(0,0,0),l.material.emissiveColor=new BABYLON.Color3(0,0,0);n.a(l,!1);b.f({mesh:l,ca:e.s})}}function x(){setTimeout(n.e,1E3);m.d();e.s.activeCamera.maxZ=250;e.s.activeCamera.minZ=0;e.r.runRenderLoop(function(){e.s.render()})}a.d(c,"a",function(){return z});a.d(c,"b",function(){return x});var B=a("1RHl"),r=a("nV79"),p=a("cw8d"),d=a("9bcR"),b=a("TqLJ"),m=a("Rr3C"),g=a("fRJN"),e=a("gqHH"),n=a("0fSa"),E=a("p11u")}).call(this,a("EVdn"))},gg4m:function(D,c,
a){function y(u){void 0===u&&(u="");var t="<p>ProteinVR has encountered an error while running in leader mode. ";C.a("Leader Error",""!==u?t+" Here are the details:</p><p><pre>"+(u+"</pre></p>"):t+"</p>",!1)}function z(){y("Leader connection destroyed. Please refresh.")}a.d(c,"a",function(){return f});a.d(c,"b",function(){return q});a.d(c,"c",function(){return y});a.d(c,"d",function(){return z});var C=a("iC5T"),f=!1,q=function(){function u(){this.D=this.P=null;this.wa();this.Ba()}u.prototype.wa=function(){var t=
"act add age ago aid aim air all and any arm art ask bag ban bar bed bet big bit box bus but buy can cap car cat ceo cow cry cup day dig dna rna dog dry due ear eat egg end era etc eye fan far fee few fit fix fly for fun gap get guy hat hey hip hit hot how ice its jet job joy key kid lab law lay let lie lot low map may mix net new nod nor not now nut odd off oil old one our out owe own pan pay per pet pie pop put raw red rid row run say sea see set sit six ski sky sue sun tap tax ten the toe too top toy try two use via war way wet who why win yes yet you".split(" "),
k="pvr"+this.pa();k+=t[Math.floor(Math.random()*t.length)]+this.pa();k=k.replace(/\./g,"");this.D=new Peer(k,{debug:2,config:{iceServers:[{urls:"stun:0.peerjs.com"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:durrantlab.com/apps/protein-vr/stun"}]}})};u.prototype.Ba=function(){var t=this;this.D.on("disconnected",function(){z();!0===f&&console.log("Connection lost. Please reconnect");t.D.id=t.P;t.D.Ca=t.P;t.D.Ia()});this.D.on("error",function(k){y(k)})};u.prototype.pa=function(){return Math.random().toString().replace(/\./g,
"").replace(/0/g,"").slice(0,3)};return u}()},gqHH:function(D,c,a){function y(g){p=g}function z(){k=document.getElementById("renderCanvas");x=new BABYLON.Engine(k,!0);BABYLON.Database.IDBStorageEnabled=!0;B=new BABYLON.Scene(x);window.scene=B}function C(){if(void 0===b){var g=new BABYLON.Ray(B.activeCamera.position,new BABYLON.Vector3(0,-1,0),50);b=B.pickWithRay(g,function(e){return"ground"===e.name}).distance}}function f(g){b=g}function q(g){m=g;u.b()||(g={createDeviceOrientationCamera:!0,useMultiview:!1},
B.getEngine().getCaps().multiview&&(g.useMultiview=!0),r=B.createDefaultVRExperience(g),g=document.getElementById("babylonVRiconbtn"),null!==g&&(g.style.opacity="0.0",g.style.filter="alpha(opacity=0)"),m.ma=!0)}a.d(c,"k",function(){return t});a.d(c,"p",function(){return k});a.d(c,"r",function(){return x});a.d(c,"s",function(){return B});a.d(c,"z",function(){return r});a.d(c,"u",function(){return p});a.d(c,"w",function(){return y});a.d(c,"t",function(){return d});a.d(c,"o",function(){return b});a.d(c,
"j",function(){return 11});a.d(c,"b",function(){return 1.5});a.d(c,"g",function(){return 1});a.d(c,"d",function(){return 2E3});a.d(c,"a",function(){return 1.2});a.d(c,"f",function(){return 2.5});a.d(c,"e",function(){return.05});a.d(c,"h",function(){return.01});a.d(c,"n",function(){return 500});a.d(c,"m",function(){return 750});a.d(c,"l",function(){return.1});a.d(c,"c",function(){return 15});a.d(c,"i",function(){return.05});a.d(c,"A",function(){return m});a.d(c,"x",function(){return z});a.d(c,"q",
function(){return C});a.d(c,"v",function(){return f});a.d(c,"y",function(){return q});var u=a("p11u"),t="1.0.0",k,x,B,r,p="environs/day/",d={oa:!1,ka:!0,qa:!1},b,m={}},iC5T:function(D,c,a){(function(y){function z(x,B,r,p){void 0===r&&(r=!0);f||(f=!0,document.head.insertAdjacentHTML("beforeend","<link rel=stylesheet href=pages/css/bootstrap.min.css>"),document.body.insertAdjacentHTML("beforeend",'\n            \x3c!-- The Modal --\x3e\n            <div class="modal fade" id="msgModal" role="dialog">\n                <div class="modal-dialog" role="document">\n                    <div class="modal-content">\n\n                    \x3c!-- Modal Header --\x3e\n                    <div class="modal-header">\n                        <h4 class="modal-title">Modal Heading</h4>\n                        <button type="button" class="close" data-dismiss="modal">&times;</button>\n                    </div>\n\n                    \x3c!-- Modal body --\x3e\n                    <div class="modal-body">\n                        \x3c!-- TODO: Check if works on both iPhone and Firefox. Used to be overflow-y:auto;overflow-x:hidden; --\x3e\n                        \x3c!-- <div id="iframe-container" style="height:350px;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch">\n                            <iframe frameBorder="0" src="" style="width:100%;height:100%;"></iframe>\n                        </div> --\x3e\n                        <span id="msg-container"></span>\n                    </div>\n\n                    \x3c!-- Modal footer --\x3e\n                    <div id="modal-footer" class="modal-footer">\n                        <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>\n                    </div>\n                </div>\n            </div>\n            <link rel="stylesheet" type="text/css" href="pages/css/style.css">\n        '));
C(x,B,r,p)}function C(x,B,r,p){void 0===q&&(q=y("#msgModal"),u=q.find("h4.modal-title"),t=q.find("#msg-container"),k=q.find("#modal-footer"));t.html("");u.html(x);!0===r?(void 0===p&&k.hide(),t.css("text-align","initial"),x=new XMLHttpRequest,x.onreadystatechange=function(){4===this.readyState&&200===this.status&&(t.html(this.responseText),setTimeout(function(){var d=document.createElement("script");d.src=B.replace(".html",".html.js");document.head.appendChild(d)},0))},x.open("GET",B,!0),x.send()):
(t.css("text-align","center"),t.html(B),void 0===p&&k.show());!0===p?k.show():!1===p&&k.hide();q.modal()}a.d(c,"a",function(){return z});var f=!1,q,u,t,k}).call(this,a("EVdn"))},jIpr:function(D,c,a){function y(){h=[];l=[];n={Styles:g.a(),Rotate:m.b()};void 0===F&&(F=new BABYLON.GUI.GUI3DManager(r.s));f();G=new BABYLON.TransformNode("");z();void 0===v&&u();void 0===E&&(E=new BABYLON.Sound("click-button",e.fa,r.s,null,{loop:!1,autoplay:!1,Ka:!0,volume:.1}));k()}function z(){function A(H){H=H.toString();
h.push(new b({F:function(){},default:!1,S:H,la:function(L){L.isVisible(!1)},level:1,name:"menu-visible-button-"+H,na:w,U:H,color:"yellow"}))}var w=new BABYLON.GUI.SpherePanel;w.radius=r.f;w.margin=r.e;F.addControl(w);w.blockLayout=!0;for(var I=0;16>I;I++)A(I);w.columns=4;w.linkToTransformNode(G);w.blockLayout=!1}function C(A){function w(I,H){A(I,H);for(var L=Object.keys(I),J=L.length,K=0;K<J;K++){var N=L[K],O=I[N];switch(typeof O){case "object":w(O,H.concat([N]))}}}w(n,[])}function f(){C(function(A,
w){q(A,w)})}function q(A,w){0<w.length&&(A["Back \u21e6"]=function(){t(w.slice(0,w.length-1))});A["Close Menu \u00d7"]=function(){v.N()}}function u(){var A=new BABYLON.GUI.StackPanel3D;F.addControl(A);v=new b({F:function(I){I.value?t([]):t(void 0);G.position.copyFrom(x.a());G.rotation.y=x.c()},default:!1,S:"Show Menu",level:0,name:"menu-visible-button",na:A,U:"Hide Menu"});var w=new BABYLON.TransformNode("");A.linkToTransformNode(w);w.rotation.x=.5*Math.PI;w.position.copyFrom(B.b);w.position.y+=.1;
w.rotation.y=x.c();r.s.registerBeforeRender(function(){w.position.copyFrom(B.b);w.position.y+=.1;w.rotation.y=x.c()})}function t(A){void 0!==A&&0<A.length&&(l=A,void 0===n.Last&&(n.Last=function(){console.log("Going to",l);t(l)}));for(var w=h.length,I=0;I<w;I++)h[I].isVisible(!1);if(void 0!==A){var H=n;w=A.length;for(I=0;I<w;I++)H=H[A[I]];var L=Object.keys(H),J=["Close Menu \u00d7"],K=["Back \u21e6"],N=J.concat(K);L.sort(function(M,Q){var R=-1!==N.indexOf(M),S=-1!==N.indexOf(Q);return R&&!S?1:!R&&
S?-1:M.localeCompare(Q)});var O=[];O=4>=L.length?[7,6,5,4]:8>=L.length?[7,6,5,4,11,10,9,8]:12>=L.length?[3,2,1,0,7,6,5,4,11,10,9,8]:[3,2,1,0,7,6,5,4,11,10,9,8,15,14,13,12];w=L.length;var P=function(M){var Q=L[M],R=H[Q];M=h[O[M]];M.ea(Q);switch(typeof R){case "object":M.F=function(){t(A.concat(Q))};M.V("green");break;case "function":M.F=R,M.V("default")}-1!==J.indexOf(Q)?M.V("red"):-1!==K.indexOf(Q)&&M.V("yellow");M.isVisible(!0)};for(I=0;I<w;I++)P(I)}}function k(){function A(w,I){var H=Object.keys(w);
if(3===H.length){var L=H.filter(function(P){return"Close Menu \u00d7"===P||"Back \u21e6"===P?!1:!0});if(1===L.length){H=L[0];var J=I[I.length-1],K=J+": "+H;I=I.slice(0,I.length-1).concat([K]);w=n;var N=I.slice(0,I.length-1),O=N.length;for(L=0;L<O;L++)w=w[N[L]];w[K]=w[J][H];delete w[J];w=w[K];H=Object.keys(w)}}J=H.length;for(L=0;L<J;L++)switch(K=H[L],N=w[K],typeof N){case "object":A(N,I.concat([K]))}}A(n,[])}var x=a("vCcv"),B=a("ph2Y"),r=a("gqHH"),p=a("TqLJ"),d=new BABYLON.Vector3(.75,.75,.75),b=function(){function A(w){var I=
this;this.button=new BABYLON.GUI.HolographicButton(w.name);w.na.addControl(this.button);this.W();void 0!==w.color&&this.V(w.color);this.level=w.level;this.B=new BABYLON.GUI.TextBlock;this.B.color="white";this.B.B=!0;this.value=w.default;this.U=w.U;this.S=w.S;this.F=w.F;this.ea();this.button.scaling=d.clone();this.J=BABYLON.Mesh.CreateSphere(w.name+"-container-mesh",2,r.a,r.s);this.J.position=this.button.node.absolutePosition;this.J.visibility=0;this.J.scaling=d.clone();this.J.F=function(){I.N()};
p.a(this.J);void 0!==w.la&&w.la(this)}A.prototype.V=function(w){switch(w){case "default":this.button.mesh.material=this.G;break;case void 0:this.button.mesh.material=this.G;break;case "green":this.button.mesh.material=this.I;break;case "yellow":this.button.mesh.material=this.L;break;case "red":this.button.mesh.material=this.K}};A.prototype.isVisible=function(w){if(void 0===w)return this.button.isVisible;this.button.isVisible=w;this.J.isVisible=w};A.prototype.N=function(){E.setPosition(this.J.position.clone());
E.play();this.value=!this.value;this.F(this);this.ea()};A.prototype.ea=function(w){void 0===w?this.B.text=this.value?this.U:this.S:this.S=this.U=this.B.text=w;this.B.text=this.X(this.B.text);this.button.content.dispose();this.button.content=this.B};A.prototype.X=function(w){return w.replace(/(?![^\n]{1,25}$)([^\n]{1,25})\s/g,"$1\n")};A.prototype.W=function(){this.G=this.button.mesh.material;this.I=this.button.mesh.material.clone();this.I.albedoColor=new BABYLON.Color3(.3,.35+.1,.4);this.L=this.button.mesh.material.clone();
this.L.albedoColor=new BABYLON.Color3(.4,.35+.1,.4);this.K=this.button.mesh.material.clone();this.K.albedoColor=new BABYLON.Color3(.4,.35,.4)};return A}(),m=a("nKXq"),g=a("BjG7");D=a("O2BG");var e=a.n(D);a.d(c,"b",function(){return n});a.d(c,"a",function(){return E});a.d(c,"c",function(){return v});a.d(c,"d",function(){return y});a.d(c,"e",function(){return q});var n,E=void 0,v,h,l,F,G},mvtX:function(D,c,a){function y(){x=!0;B=new r;B.ja.then(function(p){window.PVR_webRTCID=p;u.a("Leader","pages/leader.html",
!0,!0)});setInterval(function(){var p=q.a(),d=q.b();B.T({type:"locrot",val:[p.x,p.y,p.z,1*d.x,1*d.y,1*d.z,1*d.w]})},100);setInterval(function(){B.T({type:"initialUrl",val:window.location.href})},2E3)}function z(p,d,b){B.T({type:"toggleRep",val:{filters:p,repName:d,colorScheme:b}})}function C(p){B.T({type:"molAxisRotation",val:p})}function f(){B.T({type:"molUndoRot",val:void 0})}a.d(c,"a",function(){return x});a.d(c,"e",function(){return y});a.d(c,"b",function(){return z});a.d(c,"d",function(){return C});
a.d(c,"c",function(){return f});var q=a("vCcv"),u=a("iC5T"),t=a("gg4m"),k=function(){function p(d,b){p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,g){m.__proto__=g}||function(m,g){for(var e in g)g.hasOwnProperty(e)&&(m[e]=g[e])};return p(d,b)}return function(d,b){function m(){this.constructor=d}p(d,b);d.prototype=null===b?Object.create(b):(m.prototype=b.prototype,new m)}}(),x=!1,B,r=function(p){function d(){var b=p.call(this)||this;b.ja=null;b.ya=null;b.R=[];var m;b.ya=new Promise(function(g){m=
g});b.ja=new Promise(function(g){b.da(g,m)});return b}k(d,p);d.prototype.T=function(b){!0===t.a&&console.log("Send:",b);for(var m=this.R.length,g=0;g<m;g++)this.R[g].send(b)};d.prototype.da=function(b,m){var g=this;this.D.on("open",function(){null===g.D.id?(t.c("Received null id from peer open."),g.D.id=g.P):g.P=g.D.id;b(g.P);!0===t.a&&console.log(g.P)});this.D.on("connection",function(e){g.R.push(e);m();!0===t.a&&console.log("Lecturer: added a connection")});this.D.on("close",function(){for(var e=
g.R.length,n=0;n<e;n++)g.R[n]=null;t.d()})};return d}(t.b)},nKXq:function(D,c,a){function y(){return{"Undo Rotate":function(){C()},"X Axis":function(){z("x")},"Y Axis":function(){z("y")},"Z Axis":function(){z("z")}}}function z(k){q.i(k,15*Math.PI/180);f.b(void 0,u.s.getMeshByName("protein_box"),!0);t.a&&t.d(k)}function C(){var k=f.a;q.f(k.x,k.y,k.z);f.b(void 0,u.s.getMeshByName("protein_box"),!0);t.a&&t.c()}a.d(c,"b",function(){return y});a.d(c,"a",function(){return z});a.d(c,"c",function(){return C});
var f=a("YORc"),q=a("PjGz"),u=a("gqHH"),t=a("mvtX")},nV79:function(D,c,a){(function(y){function z(){B.b()||(C(),x.a(),setInterval(function(){var p=(new Date).getTime();void 0===r&&(r=p);2E3<p-r&&void 0!==k.z&&(k.z.exitVR(),k.s.getEngine().exitFullscreen());r=p},1E3))}function C(){k.z.onEnteringVRObservable.add(function(){k.A.C=2;q();u.i(void 0);t.e();y(".ui-button").hide();y(".babylonVRicon").hide();x.b();window.vrHelper=k.z});k.z.onExitingVRObservable.add(function(){k.A.C=3;u.i(void 0);t.e();y(".ui-button").show();
y(".babylonVRicon").show()})}function f(){var p=new BABYLON.Mesh("vrNavTargetMesh",k.s),d=new BABYLON.VertexData;d.Ha=[0,0,0];d.Fa=[0];d.applyToMesh(p);p.isVisible=!1;return p}function q(){k.z.raySelectionPredicate=function(p){return u.c(p)};k.z.gazeTrackerMesh=f();k.z.updateGazeTrackerScale=!1;k.z.displayGaze=!0;k.z.enableGazeEvenWhenNoPointerLock=!0;k.z.enableInteractions()}a.d(c,"a",function(){return z});a.d(c,"b",function(){return q});var u=a("TqLJ"),t=a("0fSa"),k=a("gqHH"),x=a("pAUf"),B=a("p11u"),
r}).call(this,a("EVdn"))},p11u:function(D,c,a){(function(y){function z(h){return(Math.round(1E5*h)/1E5).toString()}function C(){var h=[],l=d.c.x;0!==l&&h.push("rx="+z(l));l=d.c.y;0!==l&&h.push("ry="+z(l));l=d.c.z;0!==l&&h.push("rz="+z(l));h.push("s="+r.b);void 0!==n&&(console.log("setting webrtc..."),h.push("f="+n));l=0;for(var F=[],G=Object.keys(p.a),A=G.length,w=0;w<A;w++){var I=G[w];p.a[I].mesh.isVisible&&(F.push("st"+l.toString()+"="+I),l++)}h=h.concat(F);l=g.a();F=g.b();h.push("cx="+z(l.x));
h.push("cy="+z(l.y));h.push("cz="+z(l.z));h.push("crx="+z(F.x));h.push("cry="+z(F.y));h.push("crz="+z(F.z));h.push("crw="+z(F.w));h.push("e="+m.u);void 0===E&&(E=!1);h.push("sh="+E.toString());window.history.pushState({},document.title,window.location.href.split("?")[0]+"?"+h.join("&"))}function f(){var h=window.location.href,l=h?h.split("?")[1]:window.location.search.slice(1);h={};if(l){l=l.split("#")[0];l=l.split("&");for(var F=l.length,G=0;G<F;G++){var A=l[G].split("=");h[A[0]]=void 0===A[1]?!0:
A[1]}}v=h;h=v.e;void 0!==h&&m.w(h)}function q(){n=v.f;if(void 0!==n){b.a(n);m.s.activeCamera.inputs.clear();y("#help-button").hide();y("#leader").hide();y("#babylonVRiconbtn").hide();y("#open-button").hide();var h=y("#fullscreen-button"),l=h.css("bottom");void 0!==l&&(l=+l.replace(/px/g,""),h.css("bottom",(l-60).toString()+"px"));y("#capture-clicks").remove()}h=v.rx;l=v.ry;var F=v.rz;d.f(void 0===h?0:+h,void 0===l?0:+l,void 0===F?0:+F);h=v.s;void 0!==h&&""!==h&&(4===h.length&&-1===h.indexOf(".")&&
(h="https://files.rcsb.org/view/"+h.toUpperCase()+".pdb"),r.c(h));h=Object.keys(v);l=h.length;for(F=0;F<l;F++){var G=h[F];"st"===G.slice(0,2)&&(G=u(v[G]),e.push(G))}0===e.length&&(e.push([["Protein","All"],"Cartoon","Spectrum"]),e.push([["Nucleic","All"],"Stick","Element"]),e.push([["Ligand","All"],"Stick","Element"]));h=v.cx;l=v.cy;F=v.cz;void 0!==h&&void 0!==l&&void 0!==F&&g.e(new BABYLON.Vector3(+h,+l,+F));h=v.crx;l=v.cry;F=v.crz;G=v.crw;void 0!==h&&void 0!==l&&void 0!==F&&void 0!==G&&g.f(new BABYLON.Quaternion(+h,
+l,+F,+G));E=v.sh;B()}function u(h){h=h.split("--");var l=decodeURIComponent(h[h.length-2]),F=decodeURIComponent(h[h.length-1]);return[h.slice(0,h.length-2).map(function(G){G=decodeURIComponent(G);"{"===G.charAt(0)&&(G=JSON.parse(G));return G}),l,F]}function t(){if(0<e.length){var h=e.pop();p.b(h[0],h[1],h[2],function(){t()})}}function k(){return-1!==window.location.href.indexOf("f=")}function x(){return-1!==window.location.href.indexOf("sh=t")}function B(){setInterval(function(){"block"!==y("#msgModal").css("display")&&
C()},1E3)}a.d(c,"h",function(){return n});a.d(c,"f",function(){return C});a.d(c,"d",function(){return f});a.d(c,"e",function(){return q});a.d(c,"c",function(){return u});a.d(c,"g",function(){return t});a.d(c,"b",function(){return k});a.d(c,"a",function(){return x});var r=a("qmVJ"),p=a("EYe7"),d=a("PjGz"),b=a("uBLq"),m=a("gqHH"),g=a("vCcv"),e=[],n=void 0,E=!1,v}).call(this,a("EVdn"))},pAUf:function(D,c,a){function y(){function g(e){k.A.C=1;B.b();C(e);f(e)}u.g();k.z.webVRCamera.onControllerMeshLoadedObservable.add(function(e){g(e)});
k.z.onControllerMeshLoaded.add(function(e){g(e)})}function z(){}function C(g){g.onTriggerStateChangedObservable.add(function(e){e.pressed&&(e=(new Date).getTime(),e-r>k.n&&(r=e,q.a()))})}function f(g){g.onPadStateChangedObservable.add(function(e){(m=e.pressed)&&Math.abs(d)<k.l&&Math.abs(b)<k.l&&console.log("Would reset camera view if you didn't get an error below...")});g.onPadValuesChangedObservable.add(function(e){d=e.y;b=e.x;Math.abs(b)<k.l&&Math.abs(d)<k.l?b=d=0:.5>Math.abs(b)?b=0:(b+=0<b?-.5:
.5,b=2*b)});k.s.registerBeforeRender(function(){if(m){if(!t.a.equals(t.e)){var e=x.a(),n=t.a.subtract(e);n.normalize();n=n.scale(d*k.h*k.s.getAnimationRatio());x.e(e.subtract(n))}0!==b&&(e=(new Date).getTime(),e-p<k.m||(p=e,e=k.z.webVRCamera.rotationQuaternion.toEulerAngles(),e.y+=.25*Math.sign(b)*Math.PI,k.z.webVRCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(e)))}})}a.d(c,"a",function(){return y});a.d(c,"b",function(){return z});var q=a("9bcR"),u=a("TqLJ"),t=a("ph2Y"),k=a("gqHH"),
x=a("vCcv"),B=a("nV79"),r=0,p=0,d=0,b=0,m=!1},ph2Y:function(D,c,a){function y(){var p=1.5*q.a;q.s.registerBeforeRender(function(){a:{if(3===q.A.C)var d=q.s.activeCamera.getForwardRay();else if(2===q.A.C||1===q.A.C){d=void 0;1===q.A.C?(d=q.z.rightControllerGazeTrackerMesh,d||(d=q.z.leftControllerGazeTrackerMesh)):2===q.A.C&&(d=q.z.gazeTrackerMesh);if(!d){console.log("error!");break a}d.isVisible?r.copyFrom(d.absolutePosition):r.copyFrom(k);d=f.a();d=new BABYLON.Ray(d,r.subtract(d))}else console.log("Unexpected error.");
z(d)}void 0===r?(r.copyFrom(k),u.i(void 0)):10<BABYLON.Vector3.Distance(f.a(),r)&&(r.copyFrom(k),u.i(void 0));q.A.ba.position.copyFrom(r);void 0!==u.d&&(q.A.ba.isVisible=u.d!==u.h);d=f.a();var b=C(d).pickedPoint;b&&(x=b,d.y-b.y<p?(t.c.button.isVisible=!1,t.c.J.isVisible=!1):(t.c.button.isVisible=!0,t.c.J.isVisible=!0));(b=C(r).pickedPoint)&&(B=b)})}function z(p,d){void 0===d&&(d=!0);p=q.s.pickWithRay(p,function(m){return u.c(m)});var b=p.distance;p.hit&&b<q.c?(d&&r.copyFrom(p.pickedPoint),u.i(p.pickedMesh)):
(r.copyFrom(k),u.i(void 0))}function C(p){p=new BABYLON.Ray(p,new BABYLON.Vector3(0,-1,0),50);return q.s.pickWithRay(p,function(d){return d.id===q.A.H.id})}a.d(c,"e",function(){return k});a.d(c,"b",function(){return x});a.d(c,"c",function(){return B});a.d(c,"a",function(){return r});a.d(c,"f",function(){return y});a.d(c,"d",function(){return C});var f=a("vCcv"),q=a("gqHH"),u=a("TqLJ"),t=a("jIpr"),k=new BABYLON.Vector3(-1E3,1E3,1E3),x=new BABYLON.Vector3(0,0,0),B=new BABYLON.Vector3(0,0,0),r=new BABYLON.Vector3(0,
0,0)},qmVJ:function(D,c,a){function y(d){p=d}function z(){C()}function C(){B.h(function(){k.e();B.b(p,function(d){k.f();k.b()||(f(d),u.b(q.b));k.g();x.a();"nanokid.sdf"===p&&!1===k.b()&&setTimeout(function(){t.a("Load Molecule","pages/load.html")},3E3)})})}function f(d){var b=d.selectedAtoms({});r={"Atom Name":[],Chain:[],Element:[],"Residue Index":[],"Residue Name":[],"Secondary Structure":[]};var m=b.length;for(d=0;d<m;d++){var g=b[d];r["Atom Name"].push(g.atom);r.Chain.push(g.chain);r.Element.push(g.elem);
r["Residue Name"].push(g.resn);r["Residue Index"].push(g.resi);r["Secondary Structure"].push(g.ss)}b=Object.keys(r);m=b.length;for(d=0;d<m;d++){var e=b[d];g=r;var n=e;e=r[e];for(var E={},v=[],h=0,l=e.length;h<l;++h)E.hasOwnProperty(e[h])||(v.push(e[h]),E[e[h]]=1);g[n]=v}}a.d(c,"a",function(){return r});a.d(c,"b",function(){return p});a.d(c,"c",function(){return y});a.d(c,"d",function(){return z});var q=a("jIpr"),u=a("BjG7"),t=a("iC5T"),k=a("p11u"),x=a("cw8d"),B=a("PjGz"),r={},p="nanokid.sdf"},sqbB:function(D,
c,a){function y(){var t=f.s.lights[0],k=z();q.a()?(u=new BABYLON.ShadowGenerator(4096,t),u.useBlurExponentialShadowMap=!0,u.G=!0,u.B=k.blur,u.setDarkness(k.ia)):console.log("iOS, so not generating shadows... causes an error... See https://forum.babylonjs.com/t/issues-between-shadowgenerator-and-ios-osx/795")}function z(){var t=f.s.lights[0],k=64,x=.9625,B=void 0,r=t.name.match(/blur_([0-9\.]+)/g);null!==r&&(k=+r[0].substr(5));r=t.name.match(/dark_([0-9\.]+)/g);null!==r&&(x=+r[0].substr(5));t=t.name.match(/ambient_([0-9\.]+)/g);
null!==t&&(B=+t[0].substr(8));return{blur:k,ia:x,ha:B}}function C(){for(var t=f.s.meshes.length,k=0;k<t;k++){var x=f.s.meshes[k];if(-1!==x.name.toLowerCase().indexOf("shadowcatcher")||-1!==x.name.toLowerCase().indexOf("shadow_catcher"))x.material=new BABYLON.ShadowOnlyMaterial("shadow_catch"+k.toString(),f.s),x.material.activeLight=f.s.lights[0],x.receiveShadows=!0}}a.d(c,"d",function(){return u});a.d(c,"c",function(){return y});a.d(c,"a",function(){return z});a.d(c,"b",function(){return C});var f=
a("gqHH"),q=a("p11u"),u},uBLq:function(D,c,a){function y(d){r=new Float32Array(C.a().asArray());p=new Float32Array(C.b().asArray());(new B(function(b){!0===f.a&&console.log("stud1 got data",b);var m=b.val;switch(b.type){case "locrot":r=new Float32Array([m[0],m[1],m[2]]);p=new Float32Array([m[3],m[4],m[5],m[6]]);break;case "initialUrl":-1!==window.location.href.indexOf("nanokid.sdf")&&(b=m+"&f="+x,b=b.replace(/sh=true/g,"sh=false"),top.location.href=b);break;case "toggleRep":u.b(m.filters,m.repName,
m.colorScheme,void 0);break;case "molAxisRotation":t.a(m);break;case "molUndoRot":t.c()}})).za(d);q.s.registerBeforeRender(function(){var b=new Float32Array(C.a().asArray());b=z(b,r);b=BABYLON.Vector3.FromArray(b);C.e(b);b=new Float32Array(C.b().asArray());b=z(b,p);b=BABYLON.Quaternion.FromArray(b);C.f(b)})}function z(d,b){for(var m=d.length,g=new Float32Array(m),e=0;e<m;e++)g[e]=b[e]-d[e];b=q.s.getAnimationRatio();var n=new Float32Array(m);for(e=0;e<m;e++)n[e]=d[e]+.02*b*g[e];return n}a.d(c,"a",
function(){return y});var C=a("vCcv"),f=a("gg4m"),q=a("gqHH"),u=a("EYe7"),t=a("nKXq"),k=function(){function d(b,m){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,e){g.__proto__=e}||function(g,e){for(var n in e)e.hasOwnProperty(n)&&(g[n]=e[n])};return d(b,m)}return function(b,m){function g(){this.constructor=b}d(b,m);b.prototype=null===m?Object.create(m):(g.prototype=m.prototype,new g)}}(),x,B=function(d){function b(m){var g=d.call(this)||this;g.M=null;g.xa=m;g.da();return g}k(b,
d);b.prototype.za=function(m){var g=this;this.M&&this.M.close();this.M=this.D.connect(m,{reliable:!0});this.Aa();this.M.on("open",function(){!0===f.a&&console.log("Connected to: "+g.M.D)});x=m};b.prototype.da=function(){var m=this;this.D.on("close",function(){m.M=null;f.d()})};b.prototype.Aa=function(){var m=this;this.M.on("data",function(g){!0===f.a&&console.log("Received:",g);m.xa(g)});this.M.on("close",function(){f.c("Leader connection closed.")})};return b}(f.b),r=null,p=null},vCcv:function(D,
c,a){function y(){var r=k.s.activeCamera,p=r.position.clone();if(2===k.A.C||1===k.A.C)r.leftCamera?p.copyFrom(r.leftCamera.globalPosition):console.log("Prob here");return p}function z(r){if(3===k.A.C){var p=k.s.activeCamera;p.position.copyFrom(r)}else if(2===k.A.C||1===k.A.C)p=k.z.webVRCamera,p.position.copyFrom(r.subtract(u()))}function C(){if(2===k.A.C||1===k.A.C){var r=k.z.webVRCamera.deviceRotationQuaternion;return 0!==r.x?r:k.s.activeCamera.rotationQuaternion}return k.s.activeCamera.rotationQuaternion}
function f(r){2===k.A.C||1===k.A.C?console.log("PROBLEM!"):(k.s.activeCamera.rotationQuaternion=r.clone(),k.s.activeCamera.rotation=k.s.activeCamera.rotationQuaternion.toEulerAngles())}function q(){if(2===k.A.C||1===k.A.C){var r=t.c.subtract(t.b),p=BABYLON.Vector3.GetAngleBetweenVectors(r,x,B);for(0>r.z&&(p=-p);0>p;)p+=2*Math.PI;for(;p>2*Math.PI;)p-=2*Math.PI;return p+=.5*Math.PI}return k.s.activeCamera.rotation.clone().y}function u(){if(3===k.A.C)return new BABYLON.Vector3(0,0,0);var r=k.z.webVRCamera,
p;r.leftCamera?p=r.leftCamera.globalPosition.subtract(r.position):p=new BABYLON.Vector3(0,0,0);return p}a.d(c,"a",function(){return y});a.d(c,"e",function(){return z});a.d(c,"b",function(){return C});a.d(c,"f",function(){return f});a.d(c,"c",function(){return q});a.d(c,"d",function(){return u});var t=a("ph2Y"),k=a("gqHH"),x=new BABYLON.Vector3(1,0,0),B=new BABYLON.Vector3(1,0,0)}},[["/7QA",1,2]]]);}).call(this || window)
