/**
 * ProteinVR (The 3-Clause BSD License)
 * 
 * Copyright 2019 Jacob D. Durrant.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holder nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
(function(){'use strict';function T(E){var c=0;return function(){return c<E.length?{done:!1,value:E[c++]}:{done:!0}}}var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(E,c,a){E!=Array.prototype&&E!=Object.prototype&&(E[c]=a.value)},U="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;
function V(E,c){if(c){var a=U;E=E.split(".");for(var x=0;x<E.length-1;x++){var A=E[x];A in a||(a[A]={});a=a[A]}E=E[E.length-1];x=a[E];c=c(x);c!=x&&null!=c&&aa(a,E,{configurable:!0,writable:!0,value:c})}}V("Array.prototype.find",function(E){return E?E:function(c,a){a:{var x=this;x instanceof String&&(x=String(x));for(var A=x.length,D=0;D<A;D++){var f=x[D];if(c.call(a,f,D,x)){c=f;break a}}c=void 0}return c}});var W;
if("function"==typeof Object.setPrototypeOf)W=Object.setPrototypeOf;else{var X;a:{var ba={ha:!0},Y={};try{Y.__proto__=ba;X=Y.ha;break a}catch(E){}X=!1}W=X?function(E,c){E.__proto__=c;if(E.__proto__!==c)throw new TypeError(E+" is not extensible");return E}:null}var ca=W;V("Object.setPrototypeOf",function(E){return E||ca});function Z(E){var c="undefined"!=typeof Symbol&&Symbol.iterator&&E[Symbol.iterator];return c?c.call(E):{next:T(E)}}
V("Promise",function(E){function c(f){this.G=0;this.L=void 0;this.B=[];var p=this.I();try{f(p.resolve,p.reject)}catch(u){p.reject(u)}}function a(){this.B=null}function x(f){return f instanceof c?f:new c(function(p){p(f)})}if(E)return E;a.prototype.G=function(f){if(null==this.B){this.B=[];var p=this;this.I(function(){p.L()})}this.B.push(f)};var A=U.setTimeout;a.prototype.I=function(f){A(f,0)};a.prototype.L=function(){for(;this.B&&this.B.length;){var f=this.B;this.B=[];for(var p=0;p<f.length;++p){var u=
f[p];f[p]=null;try{u()}catch(r){this.K(r)}}}this.B=null};a.prototype.K=function(f){this.I(function(){throw f;})};c.prototype.I=function(){function f(r){return function(h){u||(u=!0,r.call(p,h))}}var p=this,u=!1;return{resolve:f(this.ua),reject:f(this.K)}};c.prototype.ua=function(f){if(f===this)this.K(new TypeError("A Promise cannot resolve to itself"));else if(f instanceof c)this.va(f);else{a:switch(typeof f){case "object":var p=null!=f;break a;case "function":p=!0;break a;default:p=!1}p?this.ta(f):
this.W(f)}};c.prototype.ta=function(f){var p=void 0;try{p=f.then}catch(u){this.K(u);return}"function"==typeof p?this.wa(p,f):this.W(f)};c.prototype.K=function(f){this.X(2,f)};c.prototype.W=function(f){this.X(1,f)};c.prototype.X=function(f,p){if(0!=this.G)throw Error("Cannot settle("+f+", "+p+"): Promise already settled in state"+this.G);this.G=f;this.L=p;this.sa()};c.prototype.sa=function(){if(null!=this.B){for(var f=0;f<this.B.length;++f)D.G(this.B[f]);this.B=null}};var D=new a;c.prototype.va=function(f){var p=
this.I();f.Z(p.resolve,p.reject)};c.prototype.wa=function(f,p){var u=this.I();try{f.call(p,u.resolve,u.reject)}catch(r){u.reject(r)}};c.prototype.then=function(f,p){function u(B,q){return"function"==typeof B?function(n){try{r(B(n))}catch(d){h(d)}}:q}var r,h,y=new c(function(B,q){r=B;h=q});this.Z(u(f,r),u(p,h));return y};c.prototype.catch=function(f){return this.then(void 0,f)};c.prototype.Z=function(f,p){function u(){switch(r.G){case 1:f(r.L);break;case 2:p(r.L);break;default:throw Error("Unexpected state: "+
r.G);}}var r=this;null==this.B?D.G(u):this.B.push(u)};c.resolve=x;c.reject=function(f){return new c(function(p,u){u(f)})};c.race=function(f){return new c(function(p,u){for(var r=Z(f),h=r.next();!h.done;h=r.next())x(h.value).Z(p,u)})};c.all=function(f){var p=Z(f),u=p.next();return u.done?x([]):new c(function(r,h){function y(n){return function(d){B[n]=d;q--;0==q&&r(B)}}var B=[],q=0;do B.push(void 0),q++,x(u.value).Z(y(B.length-1),h),u=p.next();while(!u.done)})};return c});
V("Math.sign",function(E){return E?E:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}});
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"/7QA":function(E,c,a){a.r(c);E=a("fcUb");c=a("SYky");a.n(c);c=a("p11u");a=a("gqHH");console.log("ProteinVR "+a.k);document.title="ProteinVR "+a.k;"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("service-worker.js",{scope:"./"}).then(function(x){console.log("SW registered: ",x)}).catch(function(x){console.log("SW registration failed: ",x)})});c.d();E.a();-1!==window.location.href.indexOf("durrantlab")&&
setTimeout(function(){(function(A,D,f,p,u,r,h){A.GoogleAnalyticsObject=u;A[u]=A[u]||function(){(A[u].q=A[u].q||[]).push(arguments)};A[u].Ha=(new Date).getTime();r=D.createElement(f);h=D.getElementsByTagName(f)[0];r.async=1;r.src=p;h.parentNode.insertBefore(r,h)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create","UA-144382730-1",{name:"proteinvr"});var x=window.location.href;-1!==x.indexOf("?")&&(x=x.split("?")[0]+"?PARAMS_REMOVED");ga("proteinvr.send",{hitType:"event",
eventCategory:"proteinvr",eventAction:"pageview",eventLabel:x})},0)},"0fSa":function(E,c,a){function x(){setTimeout(function(){BABYLON.SceneOptimizer.OptimizeAsync(y.s,u())},5E3);y.s.autoClear=!1;y.s.autoClearDepthAndStencil=!1;for(var d=y.s.meshes.length,b=new BABYLON.Color3(0,0,0),l=0;l<d;l++){var k=y.s.meshes[l];-1!==k.name.indexOf("baked")&&void 0!==k.material&&(k.material.diffuseColor=b,k.material.specularColor=b,k.material.emissiveTexture=k.material.diffuseTexture,k.material.diffuseTexture=
null,k.freezeWorldMatrix())}}function A(d){if(void 0!==d){d=d.getVerticesData(BABYLON.VertexBuffer.PositionKind);if(null===d)return null;d=d.length/3}else d=0;return d}function D(d){var b=A(d);null===b||100>b||(b=1+Math.floor(b/y.d),1<b&&d.subdivide(b))}function f(d,b){void 0===b&&(b=!0);b&&d.material.freeze()}function p(){h.d&&(y.s.lights[0].autoUpdateExtends=!0,h.d.getShadowMap().refreshRate=BABYLON.RenderTargetTexture.REFRESHRATE_RENDER_ONCE,y.s.lights[0].autoUpdateExtends=!1)}function u(){var d=
new BABYLON.SceneOptimizerOptions(25,2E3),b=0;d.optimizations.push(new BABYLON.ShadowsOptimization(b));d.optimizations.push(new BABYLON.LensFlaresOptimization(b));d.optimizations.push(new BABYLON.PostProcessesOptimization(b));d.optimizations.push(new BABYLON.ParticlesOptimization(b));d.optimizations.push(new B(b));b++;d.optimizations.push(new q(b));d.optimizations.push(new B(b));b++;d.optimizations.push(new BABYLON.TextureOptimization(b,512));d.optimizations.push(new B(b));b++;d.optimizations.push(new BABYLON.RenderTargetsOptimization(b));
d.optimizations.push(new BABYLON.TextureOptimization(b,256));d.optimizations.push(new B(b));b++;d.optimizations.push(new BABYLON.HardwareScalingOptimization(b,4));d.optimizations.push(new n(b,500));d.optimizations.push(new B(b));return d}function r(d){null!==d&&d.dispose()}a.d(c,"d",function(){return x});a.d(c,"b",function(){return D});a.d(c,"a",function(){return f});a.d(c,"e",function(){return p});a.d(c,"c",function(){return r});var h=a("sqbB"),y=a("gqHH"),B=function(){return function(d){var b=this;
void 0===d&&(d=0);this.priority=d;this.apply=function(){console.log("Optimization priority:",b.priority);console.log("FPS:",y.r.getFps());console.log("");return!0};this.getDescription=function(){return"Reports the current priority. For debugging."}}}(),q=function(){return function(d){"undefined"===typeof d&&(d=0);this.priority=d;this.apply=function(){var b=y.s.getMeshByName("surfaces.wrl");r(b);return!0};this.getDescription=function(){return"Removes surface representations."}}}(),n=function(){return function(d,
b,l){void 0===l&&(l=void 0);"undefined"===typeof d&&(d=0);this.priority=d;this.apply=function(){for(var k=[],e=y.s.meshes.length,m=0;m<e;m++){var F=y.s.meshes[m];if(-1===F.name.indexOf("Decimated")){var v=A(F);null!==v&&(v<b||k.push([v,F,void 0===l?1-b/v:l]))}}k.sort(function(t,C){return C[0]-t[0]});e=k.length;for(m=0;m<e;m++){v=k[m];F=v[1];for(v=v[2];0<F.getLODLevels().length;){var g=F.getLODLevels()[0].mesh;F.removeLODLevel(g);r(g)}F.simplify([{quality:v,distance:.001}],!1,BABYLON.SimplificationType.QUADRATIC,
function(){})}return!0};this.getDescription=function(){return"Simplifies the geometry of complex objects in the scene."}}}()},"1RHl":function(E,c,a){function x(){f=A.s.cameras.filter(function(u){return-1===u.name.indexOf("VR")})[0];var p=new BABYLON.DeviceOrientationCamera("DevOr_camera",f.position.clone(),A.s,!0);p.rotation=f.rotation.clone();A.s.activeCamera=p;A.s.activeCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(f.rotation);A.q();D.b()}a.d(c,"a",function(){return x});var A=a("gqHH"),
D=a("ejGh"),f},"9bcR":function(E,c,a){(function(x){function A(){n.A.H=n.s.getMeshByID("ground");null===n.A.H&&alert("No mesh named ground");n.A.H.checkCollisions=!0;n.A.H.visibility=0;q.b(n.A.H);d.f({Y:p,mesh:n.A.H});n.A.C=3;f();b.f();h();D()}function D(){m=y.a();n.s.registerBeforeRender(function(){var C=y.a();null===b.d(C).pickedMesh&&F===n.s.activeCamera.id?y.e(m):(m=C,F=n.s.activeCamera.id)})}function f(){x("body").keypress(function(C){!1===e.a&&(32===C.charCode?p():109===C.charCode&&k.c.N())})}
function p(){if(void 0===l.h){var C=(new Date).getTime();if(!(250>C-v))switch(v=C,d.e()){case 2:u();break;case 4:r();break;case 3:d.d.F()}}}function u(C,G){void 0===C&&(C=void 0);void 0===G&&(G=void 0);void 0===G&&(G=function(){});n.z.gazeTrackerMesh.isVisible=!1;var z=new BABYLON.Animation("animationCameraTeleportation","position",90,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),w=y.a();void 0===C&&(C=new BABYLON.Vector3(b.a.x,b.a.y+n.o,b.a.z));var I=y.d();
C=C.subtract(I);w=w.subtract(I);z.setKeys([{frame:0,value:w},{frame:n.j,value:C}]);var H=n.s.activeCamera;H.animations=[];H.animations.push(z);n.s.beginAnimation(H,0,n.j,!1,1,function(){n.z.gazeTrackerMesh.isVisible=!0;H.animations=[];G()})}function r(){var C=b.c,G=y.a(),z=b.a.subtract(G),w=z.length(),I;.1*w<n.g?I=b.a.subtract(z.normalize().scale(n.g)):.1*w>n.b?I=b.a.subtract(z.normalize().scale(n.b)):.1*w<n.b&&(I=G.add(z.scale(.9)));I.y=b.a.y;I.y-C.y<.5*n.a+.1&&(I.y=C.y+.5*n.a+.1);n.v(b.a.y-C.y);
u(I,function(){B.a()})}function h(){g=x("#capture-clicks");g.click(function(){p()});n.s.registerBeforeRender(function(){var C=n.s.activeCamera.inputs.attached.deviceOrientation;(C=C?0!==C._alpha||0!==C._beta||0!==C._gamma:!1)&&!t?(t=!0,g.show()):!C&&t&&(t=!1,g.hide())})}a.d(c,"b",function(){return A});a.d(c,"a",function(){return p});var y=a("vCcv"),B=a("ejGh"),q=a("0fSa"),n=a("gqHH"),d=a("TqLJ"),b=a("ph2Y"),l=a("p11u"),k=a("jIpr"),e=a("iC5T"),m,F="",v=0,g=void 0,t=!1}).call(this,a("EVdn"))},BjG7:function(E,
c,a){function x(){function l(F){function v(C){var G=q[g][C];k.Components[g][G]=p({},g,function(z,w){r.b([g,G],z,w)})}var g=B[F];k.Components[g]={};F=q[g].length;for(var t=0;t<F;t++)v(t)}for(var k={Components:{},Selections:{},Clear:function(){for(var F=Object.keys(r.a),v=F.length,g=0;g<v;g++)r.a[F[g]].mesh.isVisible=!1;y.c.N()},"Remove Existing":{}},e=B.length,m=0;m<e;m++)l(m);return k}function A(l){if(!h.b()){l.Styles["Remove Existing"]={};y.e(l.Styles["Remove Existing"],["Styles","Remove Existing"]);
for(var k=Object.keys(r.a),e=k.length,m=function(v){var g=k[v];!0===r.a[g].mesh.isVisible&&(v=g.replace(/--/g," "),v=v.replace(/{/g,"").replace(/}/g,"").replace(/"/g,""),l.Styles["Remove Existing"][v]=function(){y.c.N();setTimeout(function(){var t=h.c(g);r.b(t[0],t[1],"Hide")},0)})},F=0;F<e;F++)m(F)}}function D(l){function k(C,G,z,w){function I(J){J=H[J];if(1===J.length){var K=J[0];G[K]={};G[K]=p(G[K],C,function(O,P){var M={};M[e[C]]=K;r.b([M],O,P)},w.concat([K]))}else{var N="["+J[0].toString()+"-"+
J[J.length-1].toString()+"]";G[N]={};k(C,G[N],J,w.concat([N]))}}z.sort(function(J,K){J=isNaN(+J)?J:+J;K=isNaN(+K)?K:+K;return J<K?-1:J>K?1:0});var H=f(z,14);z=H.length;for(var L=0;L<z;L++)I(L);y.e(G,w)}l.Styles.Selections={};y.e(l.Styles.Selections,["Styles","Selections"]);for(var e={"Atom Name":"atom",Chain:"chain",Element:"elem","Residue Index":"resi","Residue Name":"resn","Secondary Structure":"ss"},m=Object.keys(u.a),F=m.length,v=0;v<F;v++){var g=m[v],t=u.a[g];l.Styles.Selections[g]={};k(g,l.Styles.Selections[g],
t,["Styles","Selections",g])}}function f(l,k){if(2>k)return[l];var e=l.length,m=[],F=0,v;if(0===e%k)for(v=Math.floor(e/k);F<e;)m.push(l.slice(F,F+=v));else for(;F<e;)v=Math.ceil((e-F)/k--),m.push(l.slice(F,F+=v));return m}function p(l,k,e,m){function F(t){function C(I){var H=d[I];l[z].Colors[H]=function(){e(z,H);y.c.N()}}function G(I){var H=b[I];l[z]["Color Schemes"][H]=function(){e(z,H);y.c.N()}}var z=v[t];l[z]={Colors:{},"Color Schemes":{}};t=b.length;for(var w=0;w<t;w++)G(w);t=d.length;for(w=0;w<
t;w++)C(w);l[z].Hide=function(){e(z,"Hide");y.c.N()};void 0!==m&&(t=m.concat([z]),y.e(l[z],t),t=m.concat([z,"Colors"]),w=l[z].Colors,y.e(w,t),t=m.concat([z,"Color Schemes"]),w=l[z]["Color Schemes"],y.e(w,t))}var v=void 0===n[k]?n.Protein:n[k];k=v.length;for(var g=0;g<k;g++)F(g);void 0!==m&&y.e(l,m);return l}a.d(c,"a",function(){return x});a.d(c,"c",function(){return A});a.d(c,"b",function(){return D});var u=a("qmVJ"),r=a("EYe7"),h=a("p11u"),y=a("jIpr"),B=["Protein","Ligand","Ligand Context","Water",
"Nucleic"],q={Ligand:["All"],"Ligand Context":["All"],Nucleic:["All"],Protein:["All","Hydrophobic","Hydrophilic","Charged","Aromatic"],Water:["All"]};E=["Stick","Sphere","Surface"];var n={Ligand:E,"Ligand Context":["Cartoon"].concat(E),Nucleic:E,Protein:["Cartoon"].concat(E),Water:E},d="White Red Blue Green Orange Yellow Purple".split(" "),b=["Element","Amino Acid","Chain","Nucleic","Spectrum"]},EYe7:function(E,c,a){function x(e,m,F,v){void 0===v&&(v=void 0);d.a&&d.b(e,m,F);var g=D(e,m,F);void 0===
v&&(v=function(){});if("Hide"===F){F=Object.keys(b);e=F.length;for(var t=0;t<e;t++){var C=b[F[t]];C.O===g.O&&(C.mesh.isVisible=!1,console.log("Hiding existing mesh..."))}q.b(void 0,B.s.getMeshByName("protein_box"));p()}else void 0!==b[g.ba]?(b[g.ba].mesh.isVisible=!0,console.log("showing existing mesh..."),q.b(void 0,B.s.getMeshByName("protein_box")),p()):(n.e(),F=k[F],e={and:e.map(function(G){return void 0!==l[G]?l[G]:G})},"surface"===m.toLowerCase()?n.a(F,e,function(){A(g,m,v)}):(t={},t[m.toLowerCase()]=
F,n.g(e,t),A(g,m,v)))}function A(e,m,F){n.d(!0,m,function(v){for(var g=Object.keys(b),t=g.length,C=0;C<t;C++){var G=g[C],z=b[G];z.O===e.O&&(u.c(z.mesh),delete b[G],console.log("deleting old mesh..."))}void 0!==v&&("Surface"===m&&(v.material.backFaceCulling=!1),b[e.ba]={O:e.O,mesh:v});p();F()})}function D(e,m,F){e.sort();e=e.map(function(v){return"string"===typeof v?v:JSON.stringify(v)});return{O:e.join("--")+"--"+m,ba:e.join("--")+"--"+m+"--"+F}}function f(e){for(var m=e.map(function(t){return t}),
F=e.length,v=0;v<F;v++){var g=e[v];m.push(g.toUpperCase());m.push(g.toLowerCase())}return m=m.filter(function(t,C){return m.indexOf(t)>=C})}function p(){y.f();h.c(r.b)}a.d(c,"a",function(){return b});a.d(c,"b",function(){return x});var u=a("0fSa"),r=a("jIpr"),h=a("BjG7"),y=a("p11u"),B=a("gqHH"),q=a("YORc"),n=a("PjGz"),d=a("mvtX"),b={},l={All:{},Protein:{resn:f("ALA ARG ASP ASN ASX CYS GLN GLU GLX GLY HIS HSP HYP ILE LEU LYS MET PCA PHE PRO TRP TYR VAL GLU SER THR MSE".split(" "))},Acidic:{resn:f(["ASP",
"GLU"])},Cyclic:{resn:f(["HIS","PHE","PRO","TRP","TYR"])},Aliphatic:{resn:f(["ALA","GLY","ILE","LEU","VAL"])},Aromatic:{resn:f(["HIS","PHE","TRP","TYR"])},Basic:{resn:f(["ARG","HIS","LYS","HSP"])},Charged:{resn:f("ASP GLU ARG HIS LYS HSP".split(" "))},Hydrophobic:{resn:f("ALA LEU VAL ILE PRO PHE MET TRP".split(" "))},Neutral:{resn:f("VAL PHE GLN TYR HIS CYS MET TRP ASX GLX PCA HYP".split(" "))},Nucleic:{resn:f("ADE A GUA G CYT C THY T URA U DA DG DC DT".split(" "))},Purine:{resn:f(["ADE","A","GUA",
"G"])},Pyrimidine:{resn:f("CYT C THY T URA U".split(" "))},Ions:{resn:f("AL BA CA CAL CD CES CLA CL CO CS CU CU1 CUA HG IN IOD K MG MN3 MO3 MO4 MO5 MO6 NA NAW OC7 PB POT PT RB SOD TB TL WO4 YB ZN ZN1 ZN2".split(" "))},Water:{resn:f(["WAT","HOH","TIP","TIP3"])}};l.Ligand={not:{or:[l.Protein,l.Nucleic,l.Ions,l.Water]}};l["Ligand Context"]={byres:!0,within:{distance:4,sel:l.Ligand}};var k={"Amino Acid":{colorscheme:"amino"},Blue:{color:"blue"},Chain:{colorscheme:"chain"},Element:{colorscheme:"default"},
Green:{color:"green"},Nucleic:{colorscheme:"nucleic"},Orange:{color:"orange"},Purple:{color:"purple"},Red:{color:"red"},Spectrum:{color:"spectrum"},White:{color:"white"},Yellow:{color:"yellow"}}},O2BG:function(E,c,a){E.Fa=a.p+"cf4bd43cd8dade4b62f7e691f5d0f8cc.mp3"},PjGz:function(E,c,a){(function(x,A){function D(H){var L=x("#mol-container");L&&L.remove();x("body").append('<div\n        id="mol-container"\n        class="mol-container"\n        style="display:none;"></div>');g=x("#mol-container");t=
{backgroundColor:"white"};v=A.createViewer(g,t);window.viewer=v;H()}function f(){I&&(I=!1,v=null,D(function(){v.addModel(z,"pdb",{keepH:!0})}));v.setStyle({},{})}function p(H,L){x.ajax(H,{success:function(J){z=J;w="pdb";"sdf"===H.slice(H.length-3).toLowerCase()&&(w="sdf");J=v.addModel(J,w,{keepH:!0});L(J)},error:function(J,K,N){J="<p>Could not load molecule: "+H+"</p>";J=J+("<p><pre>"+N+'</pre></p><p>(<a href="')+(window.location.href.split("?")[0]+'">Click to restart...</a>)</p>');e.b("Error Loading Molecule",
J,!1,!1,!0)}})}function u(H,L){void 0!==H.and&&1===Object.keys(H).length&&"{}"===JSON.stringify(H.and[0])&&2===H.and.length&&(H=H.and[1]);v.setStyle(H,L);v.render()}function r(H,L,J){I=!0;v.addSurface(A.SurfaceType.MS,H,L,void 0,void 0,function(){J()})}function h(H,L,J){void 0===J&&(J=function(){});b.r.hideLoadingUI();H&&y(function(){B(L,function(){var K=new BABYLON.StandardMaterial("Material",b.s);K.diffuseColor=new BABYLON.Color3(1,1,1);K.emissiveColor=new BABYLON.Color3(0,0,0);K.specularColor=
new BABYLON.Color3(0,0,0);for(var N=[],O=m.length,P=0;P<O;P++){var M=m[P],Q=[];BABYLON.VertexData.ComputeNormals(M.coors,M.trisIdxs,Q);var R=new BABYLON.VertexData;R.positions=M.coors;R.indices=M.trisIdxs;R.normals=Q;R.colors=M.colors;M=new BABYLON.Mesh("mesh_3dmol_tmp"+P,b.s);R.applyToMesh(M);M.material=K;N.push(M)}if(0<N.length){var S=BABYLON.Mesh.MergeMeshes(N,!0,!0);S.name="MeshFrom3DMol"+Math.random().toString();S.id=S.name;l.c(S,123456789)}K=S;void 0!==K&&k.b(K,b.s.getMeshByName("protein_box"));
J(K);m=[]})})}function y(H){C=v.exportVRML();H()}function B(H,L){m=[];if("undefined"!==typeof Worker)G.onmessage=function(J){J=J.data;var K=J.chunk;J=J.status;if(void 0!==K){for(var N=K[0],O=K[1],P=K[2];m.length<=N;)m.push({coors:new Float32Array(0),colors:new Float32Array(0),trisIdxs:new Uint32Array(0)});K=m[N];N=[m[N][O],P];var M=0;P=N.length;for(var Q=0;Q<P;Q++){var R=N[Q];M+=R.length}M=new ("trisIdxs"===O?Uint32Array:Float32Array)(M);var S=0;for(Q=0;Q<P;Q++)R=N[Q],M.set(R,S),S+=R.length;K[O]=
M}switch(J){case "more":G.postMessage({cmd:"sendDataChunk",data:void 0});break;case "done":L();break;default:console.log("Error here!")}},G.postMessage({cmd:"start",data:C,removeExtraPts:"Stick"===H});else throw e.b("Browser Error","Your browser does not support web workers. Please use a more\n            modern browser when running ProteinVR.",!1),Error("Browser does not support web workers.");}function q(H,L){F[H]+=L;d.f()}function n(H,L,J){F=new BABYLON.Vector3(H,L,J)}a.d(c,"c",function(){return F});
a.d(c,"h",function(){return D});a.d(c,"e",function(){return f});a.d(c,"b",function(){return p});a.d(c,"g",function(){return u});a.d(c,"a",function(){return r});a.d(c,"d",function(){return h});a.d(c,"i",function(){return q});a.d(c,"f",function(){return n});var d=a("p11u"),b=a("gqHH"),l=a("cw8d"),k=a("YORc"),e=a("iC5T"),m=[],F=new BABYLON.Vector3(0,0,0),v,g,t,C,G=new Worker("vrmlWebWorker.js"),z="",w="pdb",I=!1}).call(this,a("EVdn"),a("VS3o"))},Rr3C:function(E,c,a){function x(){document.getElementById("loadingContainer").outerHTML=
""}function A(r){f();p.r.displayLoadingUI();p.r.loadingUIText=r}function D(r){var h=r;clearInterval(u);u=setInterval(function(){h+=.02*(99-h);p.r.displayLoadingUI();p.r.loadingUIText="Loading the main scene... "+h.toFixed(0)+"%<br /><br />(Loading too slow? Reload page, use Incognito<br />mode, or clear browser cache.)"},100)}function f(){clearInterval(u)}a.d(c,"b",function(){return x});a.d(c,"a",function(){return A});a.d(c,"c",function(){return D});a.d(c,"d",function(){return f});var p=a("gqHH"),
u},TqLJ:function(E,c,a){function x(m){e=m}function A(){d.push(q.A.H)}function D(m){d.push(m);b.push(m);B.b(m);r({mesh:m,Y:function(){m.F()}})}function f(m){d.push(m);l.push(m);B.b(m);r({mesh:m})}function p(m){return m.id===q.A.H.id?!0:m.isVisible?-1!==d.indexOf(m):!1}function u(){return void 0===e?1:e===q.A.H?2:-1!==b.indexOf(e)?3:-1!==l.indexOf(e)?4:e===k?5:1}function r(m){void 0===m.Y&&(m.Y=n.a);void 0===m.da&&(m.da=q.s);void 0!==m.mesh&&(m.mesh.actionManager=new BABYLON.ActionManager(m.da),m.mesh.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,
function(){3===q.A.C&&m.Y()})))}function h(){k=BABYLON.Mesh.CreateSphere("padNavSphereAroundCamera",4,q.c-1,q.s);k.flipFaces(!0);var m=new BABYLON.StandardMaterial("padNavSphereAroundCameraMat",q.s);m.diffuseColor=new BABYLON.Color3(1,1,1);m.specularColor=new BABYLON.Color3(0,0,0);m.B=null;k.material=m;k.visibility=0;q.s.registerBeforeRender(function(){k.position=y.a()});d.push(k)}a.d(c,"h",function(){return k});a.d(c,"i",function(){return x});a.d(c,"d",function(){return e});a.d(c,"j",function(){return A});
a.d(c,"a",function(){return D});a.d(c,"b",function(){return f});a.d(c,"c",function(){return p});a.d(c,"e",function(){return u});a.d(c,"f",function(){return r});a.d(c,"g",function(){return h});var y=a("vCcv"),B=a("0fSa"),q=a("gqHH"),n=a("9bcR"),d=[],b=[],l=[],k,e},YORc:function(E,c,a){function x(d,b,l){void 0===l&&(l=!1);var k=D(d);void 0===q&&(q=y.c.clone());d=k.map(function(O){return{mesh:O,position:O.position.clone(),rotation:q.clone(),scaling:O.scaling.clone()}});q=y.c.clone();if(0!==k.length){f(k);
r.s.render();var e=b.getBoundingInfo().boundingBox,m=Object.keys(e.maximumWorld).map(function(O){return e.maximumWorld[O]-e.minimumWorld[O]}),F=0,v,g,t,C=k.length,G=function(O){O=k[O];var P=O.getBoundingInfo().boundingBox,M=Object.keys(P.maximumWorld).map(function(R){return P.maximumWorld[R]-P.minimumWorld[R]}),Q=M[0]*M[1]*M[2];Q>F&&(F=Q,v=P,g=M,t=O)};for(b=0;b<C;b++)G(b);b=m.map(function(O,P){return O/g[P]});b=Math.min.apply(null,b);G=new BABYLON.Vector3(b,b,b);for(b=0;b<C;b++)m=k[b],m.scaling=G;
r.s.render();G=v.centerWorld.subtract(e.centerWorld);for(b=0;b<C;b++)m=k[b],m.position=m.position.subtract(G);r.s.render();G=0;r.t.pa&&(G=A(t,e));for(b=0;b<C;b++)m=k[b],m.position.y=m.position.y-G,m.visibility=1;B=d[0].rotation.clone();if(!0===l)for(l=d.length,b=0;b<l;b++){var z=d[b];C=z.mesh;var w=C.position.clone(),I=C.scaling.clone(),H=C.rotation.clone();m=p("posX","position.x",z.position.x,w.x);G=p("posY","position.y",z.position.y,w.y);w=p("posZ","position.z",z.position.z,w.z);var L=p("scaX",
"scaling.x",z.scaling.x,I.x),J=p("scaY","scaling.y",z.scaling.y,I.y);I=p("scaZ","scaling.z",z.scaling.z,I.z);var K=p("rotX","rotation.x",z.rotation.x,H.x),N=p("rotY","rotation.y",z.rotation.y,H.y);z=p("rotZ","rotation.z",z.rotation.z,H.z);C.animations=[m,G,w,L,J,I,K,N,z];r.s.beginAnimation(C,0,15,!1,1,function(){u.e()})}else u.e()}}function A(d,b){var l=Math.PI;l=d.name+"-"+(d.rotation.x%l).toFixed(3)+"-"+(d.rotation.y%l).toFixed(3)+"-"+(d.rotation.z%l).toFixed(3);if(void 0!==n[l])return n[l];var k=
d.getVerticesData(BABYLON.VertexBuffer.PositionKind),e=1E6,m=k.length;d=d.getWorldMatrix();for(var F=Math.max(1,3*Math.floor(m/3E3)),v=0;v<m;v+=F){var g=new BABYLON.Vector3(k[v],k[v+1],k[v+2]);g=BABYLON.Vector3.TransformCoordinates(g,d);g.y<e&&(e=g.y)}b=e-b.minimumWorld.y-.1;return n[l]=b}function D(d){for(var b=[],l=Object.keys(h.a),k=l.length,e=0;e<k;e++){var m=h.a[l[e]].mesh;!0===m.isVisible&&b.push(m)}void 0!==d&&b.push(d);return b}function f(d){for(var b=d.length,l=0;l<b;l++){var k=d[l];k.animations=
[];!0===k.isVisible&&(k.scaling=new BABYLON.Vector3(1,1,1),k.position=new BABYLON.Vector3(0,0,0),k.rotation=y.c,k.visibility=0)}}function p(d,b,l,k){d=new BABYLON.Animation(d,b,60,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);d.setKeys([{frame:0,value:l},{frame:15,value:k}]);return d}a.d(c,"a",function(){return B});a.d(c,"b",function(){return x});var u=a("0fSa"),r=a("gqHH"),h=a("EYe7"),y=a("PjGz"),B=new BABYLON.Vector3(0,0,0),q=void 0,n={}},cw8d:function(E,c,a){function x(){h.c();
r.d();u.A.na&&p.d();f.e()}function A(){h.b();if(!0===u.t.ra)if(u.A.H){u.A.H.visibility=1;var q=new BABYLON.StandardMaterial("transparentGround",u.s);q.diffuseColor=new BABYLON.Color3(1,1,1);q.specularColor=new BABYLON.Color3(0,0,0);q.emissiveColor=new BABYLON.Color3(0,0,0);q.alpha=u.i;u.A.H.material=q}else console.log("Warning: Vars.vrVars.groundMesh not defined.");B.b()}function D(q,n){if(void 0!==q.material&&null!==q.material){var d=h.a();void 0===d.ia?(d=d.ja,d=.95<d?.05:.4>d?.0025:.013636363636363637*
d-.0029545454545454545):d=d.ia;q.material.emissiveColor=new BABYLON.Color3(d,d,d);f.a(q)}q.scaling.z=-1;0<n&&(q.scaling.x=-1);h.d&&h.d.getShadowMap().renderList.push(q);y.b(q)}a.d(c,"b",function(){return x});a.d(c,"a",function(){return A});a.d(c,"c",function(){return D});var f=a("0fSa"),p=a("jIpr"),u=a("gqHH"),r=a("qmVJ"),h=a("sqbB"),y=a("TqLJ"),B=a("fcUb")},ejGh:function(E,c,a){function x(){f=D.s.activeCamera;f.keysUp=[87,38];f.keysDown=[83,40];f.keysLeft=[65,37];f.keysRight=[68,39];D.s.gravity=
new BABYLON.Vector3(0,-.1,0);f.applyGravity=!0;A();D.s.collisionsEnabled=!0;f.checkCollisions=!0;f.speed=.1;f.attachControl(D.p,!0);f._updatePosition()}function A(){f.ellipsoid=new BABYLON.Vector3(1,.5*D.o,1)}a.d(c,"b",function(){return x});a.d(c,"a",function(){return A});var D=a("gqHH"),f;new BABYLON.Vector3(0,0,0)},fRJN:function(E,c,a){(function(x){function A(){D()}function D(){function h(l){x("#"+l.id).click(function(){l.F()})}for(var y=[{aa:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n                    width="48px" height="48px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve">\n                    <g>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linejoin="round" d="M41.99,17.573v-5.209\n                            c0-0.588-0.717-1.092-1.615-1.092H25.123V8.92c0-0.336-0.449-0.672-0.987-0.672H1.077C0.449,8.248,0,8.583,0,8.92v3.444\n                            c0,0,0,0,0,0.084v25.877c0,0.588,0.717,1.092,1.615,1.092h38.671"/>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linejoin="round" d="M7.985,17.573h38.67\n                            c0.898,0,1.526,0.504,1.347,1.008l-5.295,19.744c-0.089,0.588-0.985,1.092-1.884,1.092H2.064c-0.898,0-1.526-0.504-1.347-1.008\n                            l5.294-19.744C6.19,18.077,7.088,17.573,7.985,17.573L7.985,17.573"/>\n                    </g>\n                    </svg>',
title:"open",id:"open-button",$:!1,F:function(){window.PVR_warning=!0;f.b("Load Molecule","pages/load.html")}},{aa:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                    x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="\n                            M35.5,9.8c1.7,5.4-0.6,8-1.6,8.9c-1.9,1.9-4.5,4.7-5.8,7c-1.5,2.7-4.1,12-6.8,4.4c-3.2-9.1,1.3-11.6,3.5-13.4\n                            c1.5-1.3,3.4-4.3,0.5-5.3c-4-1.3-6.1,5.3-10.7,4c-3-0.8-3.2-4.1-2.2-6.6C15.4,1.7,32.5,0.6,35.5,9.8L35.5,9.8z"/>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" d="M28.3,39.6c0-5.5-8.5-5.5-8.5,0S28.3,45.1,28.3,39.6"/>\n                  </svg>',
title:"Help",id:"help-button",$:!1,F:function(){f.b("Help: ProteinVR "+p.k,"pages/help.html",!0,!0)}},{aa:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n             \t    x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                    <path fill="none" stroke="#FFFFFF" stroke-width="1.5" d="M35.4,4.6c-3.2,0-5.8,2.4-5.8,5.8l0,0c0,0.5,0.2,1.1,0.5,1.4l-13.4,7.8\n             \t    c-1-1.4-2.6-1.8-4.1-1.8c-3.2,0-5.8,2.4-5.8,5.8l0,0c0,2.9,2.6,5.8,5.8,5.8l0,0c1.3,0,2.2-0.5,3.2-1.4l13.6,8.3\n             \t    c-0.3,0.4-0.3,0.9-0.3,1.4c0,3.4,2.7,5.8,5.9,5.8l0,0c3.2,0,5.6-2.4,5.6-5.8l0,0c0-2.9-2.4-5.9-5.6-5.9l0,0c-1.7,0-3.2,1.1-4.4,2\n             \t    l-13.1-7.3c0.5-0.9,0.7-2,0.7-2.9c0-0.5,0-1.4-0.2-2l13.3-7.3c1,0.9,2.5,1.5,4.1,1.5c3.2,0,5.9-2.5,5.9-5.4l0,0\n             \t    C41.3,6.9,38.5,4.6,35.4,4.6L35.4,4.6L35.4,4.6z"/>\n                 </svg>',
title:"Share (Leader)",id:"leader",$:!1,F:function(){u.e()}},{aa:'<svg style="position:relative; left:0.5px;" width="48px" height="48px" xmlns="http://www.w3.org/2000/svg"\n                    xmlns:svg="http://www.w3.org/2000/svg" clip-rule="evenodd">\n                    <g class="layer">\n                        <path d="m47.799999,43.649999l-47.699999,0l0,-39.749999l47.699999,0l0,39.749999zm-1.9875,-37.762499l-43.724999,0l0,35.774999l43.724999,0l0,-35.774999zm-7.95,13.9125l-1.9875,0l0,-6.441487l-22.341487,22.341487l6.441487,0l0,1.9875l-9.9375,0l0,-9.9375l1.9875,0l0,6.441487l22.341487,-22.341487l-6.441487,0l0,-1.9875l9.9375,0l0,9.9375z" fill="#ffffff" id="svg_1"/>\n                    </g>\n                  </svg>',
title:"Full Screen",id:"fullscreen-button",$:!0,F:function(){p.r.switchFullscreen(!0);x("#renderCanvas").focus()}}],B="",q=60,n=0,d=y.reverse();n<d.length;n++){var b=d[n];if(void 0===r.h||!0===b.$)B+='\n                <button\n                    title="'+b.title+'"\n                    id="'+b.id+'"\n                    class="ui-button"\n                    style="color:white;\n                        width:80px;\n                        height:50px;\n                        right:5px;\n                        position:absolute;\n                        bottom:'+
q.toString()+'px;\n                        background-color:rgba(51,51,51,0.7);\n                        border:none;\n                        outline:none;\n                        cursor:pointer;">\n                        '+b.aa+"\n                </button>",q+=55}x("body").append(B);for(B=0;B<y.length;B++)b=y[B],h(b);y=document.getElementById("babylonVRiconbtn");null!==y&&(y.style.opacity="1.0",y.style.filter="alpha(opacity=1.0)")}a.d(c,"a",function(){return A});var f=a("iC5T"),p=a("gqHH"),u=
a("mvtX"),r=a("p11u")}).call(this,a("EVdn"))},fcUb:function(E,c,a){(function(x){function A(){e.x();l.b();D();f(function(){B.a();F.b()?(e.A.C=3,e.s.getMeshByID("ground").visibility=0,e.A.ca.isVisible=!1):(d.b(),b.j());n.b();k.a()});window.addEventListener("resize",function(){e.r.resize()})}function D(){var v=BABYLON.Mesh.CreateSphere("navTargetMesh",4,.1,e.s),g=new BABYLON.StandardMaterial("myMaterial",e.s);g.diffuseColor=new BABYLON.Color3(1,0,1);v.material=g;v.Ka=2;e.y({ca:v});q.a();m.d()}function f(v){l.a("Loading the main scene...");
BABYLON.SceneLoader.LoadAssetContainer(e.u,"scene.babylon",e.s,function(g){l.c(90);e.s.executeWhenReady(function(){x.getJSON(e.u+"scene_info.json",function(t){!1===t.menuActive&&(e.A.na=!1);void 0!==t.positionOnFloor&&(e.t.pa=t.positionOnFloor);void 0!==t.infiniteDistanceSkyBox&&(e.t.la=t.infiniteDistanceSkyBox);void 0!==t.transparentGround&&(e.t.ra=t.transparentGround);g.addAllToScene();e.s.activeCamera=e.s.cameras.filter(function(C){return-1===C.name.indexOf("VR")})[0];p();u();r();h();v()})})},
function(g){g.lengthComputable&&l.a("Loading the main scene... "+Math.round(90*g.loaded/g.total).toString()+"%")})}function p(){for(var v=!1,g=0;1<e.s.lights.length;){var t=e.s.lights[g].name.toLowerCase();-1===t.indexOf("shadowlight")&&-1===t.indexOf("shadow_light")?e.s.lights[g].dispose():v?e.s.lights[g].dispose():(v=!0,g++)}}function u(){for(var v=e.s.meshes.length,g=0;g<v;g++){var t=e.s.meshes[g];"protein_box"===t.name?t.isVisible=!1:-1!==t.name.toLowerCase().indexOf("skybox")&&e.t.la&&(t.material.disableLighting=
!0,t.infiniteDistance=!0)}}function r(){for(var v=e.s.meshes.length,g=0;g<v;g++){var t=e.s.meshes[g];t.material&&t.material.emissiveTexture&&(t.material.emissiveColor=new BABYLON.Color3(1,1,1),t.material.albedoColor=new BABYLON.Color3(0,0,0),t.material.Ea=new BABYLON.Color3(0,0,0))}}function h(){for(var v=e.s.meshes.length,g=0;g<v;g++)if(e.s.meshes[g].material){var t=e.s.meshes[g];if(void 0===t.material.emissiveTexture||null===t.material.emissiveTexture)t.material.emissiveTexture=t.material.diffuseTexture,
t.material.diffuseColor=new BABYLON.Color3(0,0,0),t.material.specularColor=new BABYLON.Color3(0,0,0),t.material.emissiveColor=new BABYLON.Color3(0,0,0);m.a(t,!1);b.f({mesh:t,da:e.s})}}function y(){setTimeout(m.e,1E3);l.d();e.s.activeCamera.maxZ=250;e.s.activeCamera.minZ=0;e.r.runRenderLoop(function(){e.s.render()})}a.d(c,"a",function(){return A});a.d(c,"b",function(){return y});var B=a("1RHl"),q=a("nV79"),n=a("cw8d"),d=a("9bcR"),b=a("TqLJ"),l=a("Rr3C"),k=a("fRJN"),e=a("gqHH"),m=a("0fSa"),F=a("p11u")}).call(this,
a("EVdn"))},gg4m:function(E,c,a){function x(u){void 0===u&&(u="");var r="<p>ProteinVR has encountered an error while running in leader mode. ";D.b("Leader Error",""!==u?r+" Here are the details:</p><p><pre>"+(u+"</pre></p>"):r+"</p>",!1)}function A(){x("Leader connection destroyed. Please refresh.")}a.d(c,"a",function(){return f});a.d(c,"b",function(){return p});a.d(c,"c",function(){return x});a.d(c,"d",function(){return A});var D=a("iC5T"),f=!1,p=function(){function u(){this.D=this.P=null;this.xa();
this.Ca()}u.prototype.xa=function(){var r="act add age ago aid aim air all and any arm art ask bag ban bar bed bet big bit box bus but buy can cap car cat ceo cow cry cup day dig dna rna dog dry due ear eat egg end era etc eye fan far fee few fit fix fly for fun gap get guy hat hey hip hit hot how ice its jet job joy key kid lab law lay let lie lot low map may mix net new nod nor not now nut odd off oil old one our out owe own pan pay per pet pie pop put raw red rid row run say sea see set sit six ski sky sue sun tap tax ten the toe too top toy try two use via war way wet who why win yes yet you".split(" "),
h="pvr"+this.qa();h+=r[Math.floor(Math.random()*r.length)]+this.qa();h=h.replace(/\./g,"");this.D=new Peer(h,{debug:2,config:{iceServers:[{urls:"stun:0.peerjs.com"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:durrantlab.com/apps/protein-vr/stun"}]}})};u.prototype.Ca=function(){var r=this;this.D.on("disconnected",function(){A();!0===f&&console.log("Connection lost. Please reconnect");r.D.id=r.P;r.D.Da=r.P;r.D.Ja()});this.D.on("error",function(h){x(h)})};u.prototype.qa=function(){return Math.random().toString().replace(/\./g,
"").replace(/0/g,"").slice(0,3)};return u}()},gqHH:function(E,c,a){function x(k){n=k}function A(){h=document.getElementById("renderCanvas");y=new BABYLON.Engine(h,!0);BABYLON.Database.IDBStorageEnabled=!0;B=new BABYLON.Scene(y);window.scene=B}function D(){if(void 0===b){var k=new BABYLON.Ray(B.activeCamera.position,new BABYLON.Vector3(0,-1,0),50);b=B.pickWithRay(k,function(e){return"ground"===e.name}).distance}}function f(k){b=k}function p(k){l=k;u.b()||(q=B.createDefaultVRExperience({createDeviceOrientationCamera:!0,
useMultiview:!1}),k=document.getElementById("babylonVRiconbtn"),null!==k&&(k.style.opacity="0.0",k.style.filter="alpha(opacity=0)"),l.na=!0)}a.d(c,"k",function(){return r});a.d(c,"p",function(){return h});a.d(c,"r",function(){return y});a.d(c,"s",function(){return B});a.d(c,"z",function(){return q});a.d(c,"u",function(){return n});a.d(c,"w",function(){return x});a.d(c,"t",function(){return d});a.d(c,"o",function(){return b});a.d(c,"j",function(){return 11});a.d(c,"b",function(){return 1.5});a.d(c,
"g",function(){return 1});a.d(c,"d",function(){return 2E3});a.d(c,"a",function(){return 1.2});a.d(c,"f",function(){return 2.5});a.d(c,"e",function(){return.05});a.d(c,"h",function(){return.01});a.d(c,"n",function(){return 500});a.d(c,"m",function(){return 750});a.d(c,"l",function(){return.1});a.d(c,"c",function(){return 15});a.d(c,"i",function(){return.05});a.d(c,"A",function(){return l});a.d(c,"x",function(){return A});a.d(c,"q",function(){return D});a.d(c,"v",function(){return f});a.d(c,"y",function(){return p});
var u=a("p11u"),r="1.0.2",h,y,B,q,n="environs/day/",d={pa:!1,la:!0,ra:!1},b,l={}},iC5T:function(E,c,a){(function(x){function A(B,q,n,d,b){void 0===n&&(n=!0);void 0===b&&(b=!1);f||(f=!0,document.head.insertAdjacentHTML("beforeend","<link rel=stylesheet href=pages/css/bootstrap.min.css>"),document.body.insertAdjacentHTML("beforeend",'\n            \x3c!-- The Modal --\x3e\n            <div class="modal fade" id="msgModal" role="dialog">\n                <div class="modal-dialog" role="document">\n                    <div class="modal-content">\n\n                    \x3c!-- Modal Header --\x3e\n                    <div class="modal-header">\n                        <h4 class="modal-title">Modal Heading</h4>\n                        <button id="modal-close-button" type="button" class="close" data-dismiss="modal">&times;</button>\n                    </div>\n\n                    \x3c!-- Modal body --\x3e\n                    <div class="modal-body">\n                        \x3c!-- <div id="iframe-container" style="height:350px;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch">\n                            <iframe frameBorder="0" src="" style="width:100%;height:100%;"></iframe>\n                        </div> --\x3e\n                        <span id="msg-container"></span>\n                    </div>\n\n                    \x3c!-- Modal footer --\x3e\n                    <div id="modal-footer" class="modal-footer">\n                        <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>\n                    </div>\n                </div>\n            </div>\n            <link rel="stylesheet" type="text/css" href="pages/css/style.css">\n        '));
D(B,q,n,d,b)}function D(B,q,n,d,b){void 0===p&&(p=x("#msgModal"),u=p.find("h4.modal-title"),r=p.find("#msg-container"),h=p.find("#modal-footer"),p.on("shown.bs.modal",function(){y=!0}),p.on("hidden.bs.modal",function(){y=!1}));r.html("");u.html(B);!0===n?(void 0===d&&h.hide(),r.css("text-align","initial"),B=new XMLHttpRequest,B.onreadystatechange=function(){4===this.readyState&&200===this.status&&(r.html(this.responseText),setTimeout(function(){var l=document.createElement("script");l.src=q.replace(".html",
".html.js");document.head.appendChild(l)},0))},B.open("GET",q,!0),B.send()):(r.css("text-align","center"),r.html(q),void 0===d&&h.show());!0===d?h.show():!1===d&&h.hide();d={};!0===b&&(x("#modal-close-button").hide(),p.on("shown.bs.modal",function(){x(".modal-backdrop.show").css("opacity",1)}),d={backdrop:"static",keyboard:!1});p.modal(d)}a.d(c,"a",function(){return y});a.d(c,"b",function(){return A});var f=!1,p,u,r,h,y=!1}).call(this,a("EVdn"))},jIpr:function(E,c,a){function x(){g=[];t=[];m={Styles:k.a(),
Rotate:l.b()};void 0===C&&(C=new BABYLON.GUI.GUI3DManager(q.s));f();G=new BABYLON.TransformNode("");A();void 0===v&&u();void 0===F&&(F=new BABYLON.Sound("click-button",e.ha,q.s,null,{loop:!1,autoplay:!1,La:!0,volume:.1}));h()}function A(){function z(H){H=H.toString();g.push(new b({F:function(){},default:!1,S:H,ma:function(L){L.isVisible(!1)},level:1,name:"menu-visible-button-"+H,oa:w,U:H,color:"yellow"}))}var w=new BABYLON.GUI.SpherePanel;w.radius=q.f;w.margin=q.e;C.addControl(w);w.blockLayout=!0;
for(var I=0;16>I;I++)z(I);w.columns=4;w.linkToTransformNode(G);w.blockLayout=!1}function D(z){function w(I,H){z(I,H);for(var L=Object.keys(I),J=L.length,K=0;K<J;K++){var N=L[K],O=I[N];switch(typeof O){case "object":w(O,H.concat([N]))}}}w(m,[])}function f(){D(function(z,w){p(z,w)})}function p(z,w){0<w.length&&(z["Back \u21e6"]=function(){r(w.slice(0,w.length-1))});z["Close Menu \u00d7"]=function(){v.N()}}function u(){var z=new BABYLON.GUI.StackPanel3D;C.addControl(z);v=new b({F:function(I){I.value?
r([]):r(void 0);G.position.copyFrom(y.a());G.rotation.y=y.c()},default:!1,S:"Show Menu",level:0,name:"menu-visible-button",oa:z,U:"Hide Menu"});var w=new BABYLON.TransformNode("");z.linkToTransformNode(w);w.rotation.x=.5*Math.PI;w.position.copyFrom(B.b);w.position.y+=.1;w.rotation.y=y.c();q.s.registerBeforeRender(function(){w.position.copyFrom(B.b);w.position.y+=.1;w.rotation.y=y.c()})}function r(z){void 0!==z&&0<z.length&&(t=z,void 0===m.Last&&(m.Last=function(){console.log("Going to",t);r(t)}));
for(var w=g.length,I=0;I<w;I++)g[I].isVisible(!1);if(void 0!==z){var H=m;w=z.length;for(I=0;I<w;I++)H=H[z[I]];var L=Object.keys(H),J=["Close Menu \u00d7"],K=["Back \u21e6"],N=J.concat(K);L.sort(function(M,Q){var R=-1!==N.indexOf(M),S=-1!==N.indexOf(Q);return R&&!S?1:!R&&S?-1:M.localeCompare(Q)});var O=[];O=4>=L.length?[7,6,5,4]:8>=L.length?[7,6,5,4,11,10,9,8]:12>=L.length?[3,2,1,0,7,6,5,4,11,10,9,8]:[3,2,1,0,7,6,5,4,11,10,9,8,15,14,13,12];w=L.length;var P=function(M){var Q=L[M],R=H[Q];M=g[O[M]];M.fa(Q);
switch(typeof R){case "object":M.F=function(){r(z.concat(Q))};M.V("green");break;case "function":M.F=R,M.V("default")}-1!==J.indexOf(Q)?M.V("red"):-1!==K.indexOf(Q)&&M.V("yellow");M.isVisible(!0)};for(I=0;I<w;I++)P(I)}}function h(){function z(w,I){var H=Object.keys(w);if(3===H.length){var L=H.filter(function(P){return"Close Menu \u00d7"===P||"Back \u21e6"===P?!1:!0});if(1===L.length){H=L[0];var J=I[I.length-1],K=J+": "+H;I=I.slice(0,I.length-1).concat([K]);w=m;var N=I.slice(0,I.length-1),O=N.length;
for(L=0;L<O;L++)w=w[N[L]];w[K]=w[J][H];delete w[J];w=w[K];H=Object.keys(w)}}J=H.length;for(L=0;L<J;L++)switch(K=H[L],N=w[K],typeof N){case "object":z(N,I.concat([K]))}}z(m,[])}var y=a("vCcv"),B=a("ph2Y"),q=a("gqHH"),n=a("TqLJ"),d=new BABYLON.Vector3(.75,.75,.75),b=function(){function z(w){var I=this;this.button=new BABYLON.GUI.HolographicButton(w.name);w.oa.addControl(this.button);this.W();void 0!==w.color&&this.V(w.color);this.level=w.level;this.B=new BABYLON.GUI.TextBlock;this.B.color="white";this.B.B=
!0;this.value=w.default;this.U=w.U;this.S=w.S;this.F=w.F;this.fa();this.button.scaling=d.clone();this.J=BABYLON.Mesh.CreateSphere(w.name+"-container-mesh",2,q.a,q.s);this.J.position=this.button.node.absolutePosition;this.J.visibility=0;this.J.scaling=d.clone();this.J.F=function(){I.N()};n.a(this.J);void 0!==w.ma&&w.ma(this)}z.prototype.V=function(w){switch(w){case "default":this.button.mesh.material=this.G;break;case void 0:this.button.mesh.material=this.G;break;case "green":this.button.mesh.material=
this.I;break;case "yellow":this.button.mesh.material=this.L;break;case "red":this.button.mesh.material=this.K}};z.prototype.isVisible=function(w){if(void 0===w)return this.button.isVisible;this.button.isVisible=w;this.J.isVisible=w};z.prototype.N=function(){F.setPosition(this.J.position.clone());F.play();this.value=!this.value;this.F(this);this.fa()};z.prototype.fa=function(w){void 0===w?this.B.text=this.value?this.U:this.S:this.S=this.U=this.B.text=w;this.B.text=this.X(this.B.text);this.button.content.dispose();
this.button.content=this.B};z.prototype.X=function(w){return w.replace(/(?![^\n]{1,25}$)([^\n]{1,25})\s/g,"$1\n")};z.prototype.W=function(){this.G=this.button.mesh.material;this.I=this.button.mesh.material.clone();this.I.albedoColor=new BABYLON.Color3(.3,.35+.1,.4);this.L=this.button.mesh.material.clone();this.L.albedoColor=new BABYLON.Color3(.4,.35+.1,.4);this.K=this.button.mesh.material.clone();this.K.albedoColor=new BABYLON.Color3(.4,.35,.4)};return z}(),l=a("nKXq"),k=a("BjG7");E=a("O2BG");var e=
a.n(E);a.d(c,"b",function(){return m});a.d(c,"a",function(){return F});a.d(c,"c",function(){return v});a.d(c,"d",function(){return x});a.d(c,"e",function(){return p});var m,F=void 0,v,g,t,C,G},mvtX:function(E,c,a){function x(){y=!0;B=new q;B.ka.then(function(n){window.PVR_webRTCID=n;u.b("Leader","pages/leader.html",!0,!0)});setInterval(function(){var n=p.a(),d=p.b();B.T({type:"locrot",val:[n.x,n.y,n.z,1*d.x,1*d.y,1*d.z,1*d.w]})},100);setInterval(function(){B.T({type:"initialUrl",val:window.location.href})},
2E3)}function A(n,d,b){B.T({type:"toggleRep",val:{filters:n,repName:d,colorScheme:b}})}function D(n){B.T({type:"molAxisRotation",val:n})}function f(){B.T({type:"molUndoRot",val:void 0})}a.d(c,"a",function(){return y});a.d(c,"e",function(){return x});a.d(c,"b",function(){return A});a.d(c,"d",function(){return D});a.d(c,"c",function(){return f});var p=a("vCcv"),u=a("iC5T"),r=a("gg4m"),h=function(){function n(d,b){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,k){l.__proto__=k}||
function(l,k){for(var e in k)k.hasOwnProperty(e)&&(l[e]=k[e])};return n(d,b)}return function(d,b){function l(){this.constructor=d}n(d,b);d.prototype=null===b?Object.create(b):(l.prototype=b.prototype,new l)}}(),y=!1,B,q=function(n){function d(){var b=n.call(this)||this;b.ka=null;b.za=null;b.R=[];var l;b.za=new Promise(function(k){l=k});b.ka=new Promise(function(k){b.ea(k,l)});return b}h(d,n);d.prototype.T=function(b){!0===r.a&&console.log("Send:",b);for(var l=this.R.length,k=0;k<l;k++)this.R[k].send(b)};
d.prototype.ea=function(b,l){var k=this;this.D.on("open",function(){null===k.D.id?(r.c("Received null id from peer open."),k.D.id=k.P):k.P=k.D.id;b(k.P);!0===r.a&&console.log(k.P)});this.D.on("connection",function(e){k.R.push(e);l();!0===r.a&&console.log("Lecturer: added a connection")});this.D.on("close",function(){for(var e=k.R.length,m=0;m<e;m++)k.R[m]=null;r.d()})};return d}(r.b)},nKXq:function(E,c,a){function x(){return{"Undo Rotate":function(){D()},"X Axis":function(){A("x")},"Y Axis":function(){A("y")},
"Z Axis":function(){A("z")}}}function A(h){p.i(h,15*Math.PI/180);f.b(void 0,u.s.getMeshByName("protein_box"),!0);r.a&&r.d(h)}function D(){var h=f.a;p.f(h.x,h.y,h.z);f.b(void 0,u.s.getMeshByName("protein_box"),!0);r.a&&r.c()}a.d(c,"b",function(){return x});a.d(c,"a",function(){return A});a.d(c,"c",function(){return D});var f=a("YORc"),p=a("PjGz"),u=a("gqHH"),r=a("mvtX")},nV79:function(E,c,a){(function(x){function A(){B.b()||(D(),y.a(),setInterval(function(){var n=(new Date).getTime();void 0===q&&(q=
n);2E3<n-q&&void 0!==h.z&&(h.z.exitVR(),h.s.getEngine().exitFullscreen());q=n},1E3))}function D(){h.z.onEnteringVRObservable.add(function(){h.A.C=2;p();u.i(void 0);r.e();x(".ui-button").hide();x(".babylonVRicon").hide();y.b();window.vrHelper=h.z});h.z.onExitingVRObservable.add(function(){h.A.C=3;u.i(void 0);r.e();x(".ui-button").show();x(".babylonVRicon").show()})}function f(){var n=new BABYLON.Mesh("vrNavTargetMesh",h.s),d=new BABYLON.VertexData;d.Ia=[0,0,0];d.Ga=[0];d.applyToMesh(n);n.isVisible=
!1;return n}function p(){h.z.raySelectionPredicate=function(n){return u.c(n)};h.z.gazeTrackerMesh=f();h.z.updateGazeTrackerScale=!1;h.z.displayGaze=!0;h.z.enableGazeEvenWhenNoPointerLock=!0;h.z.enableInteractions()}a.d(c,"a",function(){return A});a.d(c,"b",function(){return p});var u=a("TqLJ"),r=a("0fSa"),h=a("gqHH"),y=a("pAUf"),B=a("p11u"),q}).call(this,a("EVdn"))},p11u:function(E,c,a){(function(x){function A(g){return(Math.round(1E5*g)/1E5).toString()}function D(){var g=[],t=d.c.x;0!==t&&g.push("rx="+
A(t));t=d.c.y;0!==t&&g.push("ry="+A(t));t=d.c.z;0!==t&&g.push("rz="+A(t));g.push("s="+q.b);void 0!==m&&(console.log("setting webrtc..."),g.push("f="+m));t=0;for(var C=[],G=Object.keys(n.a),z=G.length,w=0;w<z;w++){var I=G[w];n.a[I].mesh.isVisible&&(C.push("st"+t.toString()+"="+I),t++)}g=g.concat(C);t=k.a();C=k.b();g.push("cx="+A(t.x));g.push("cy="+A(t.y));g.push("cz="+A(t.z));g.push("crx="+A(C.x));g.push("cry="+A(C.y));g.push("crz="+A(C.z));g.push("crw="+A(C.w));g.push("e="+l.u);void 0===F&&(F=!1);
g.push("sh="+F.toString());window.history.pushState({},document.title,window.location.href.split("?")[0]+"?"+g.join("&"))}function f(){var g=window.location.href,t=g?g.split("?")[1]:window.location.search.slice(1);g={};if(t){t=t.split("#")[0];t=t.split("&");for(var C=t.length,G=0;G<C;G++){var z=t[G].split("=");g[z[0]]=void 0===z[1]?!0:z[1]}}v=g;g=v.e;void 0!==g&&l.w(g)}function p(){m=v.f;if(void 0!==m){b.a(m);l.s.activeCamera.inputs.clear();x("#help-button").hide();x("#leader").hide();x("#babylonVRiconbtn").hide();
x("#open-button").hide();var g=x("#fullscreen-button"),t=g.css("bottom");void 0!==t&&(t=+t.replace(/px/g,""),g.css("bottom",(t-60).toString()+"px"));x("#capture-clicks").remove();var C=x("#followerModeWarning");C.fadeIn(500);setTimeout(function(){C.fadeOut(500)},8E3)}g=v.rx;t=v.ry;var G=v.rz;d.f(void 0===g?0:+g,void 0===t?0:+t,void 0===G?0:+G);g=v.s;void 0!==g&&""!==g&&(4===g.length&&-1===g.indexOf(".")&&(g="https://files.rcsb.org/view/"+g.toUpperCase()+".pdb"),q.c(g));g=Object.keys(v);t=g.length;
for(G=0;G<t;G++){var z=g[G];"st"===z.slice(0,2)&&(z=u(v[z]),e.push(z))}0===e.length&&(e.push([["Protein","All"],"Cartoon","Spectrum"]),e.push([["Nucleic","All"],"Stick","Element"]),e.push([["Ligand","All"],"Stick","Element"]));g=v.cx;t=v.cy;G=v.cz;void 0!==g&&void 0!==t&&void 0!==G&&k.e(new BABYLON.Vector3(+g,+t,+G));g=v.crx;t=v.cry;G=v.crz;z=v.crw;void 0!==g&&void 0!==t&&void 0!==G&&void 0!==z&&k.f(new BABYLON.Quaternion(+g,+t,+G,+z));F=v.sh;B()}function u(g){g=g.split("--");var t=decodeURIComponent(g[g.length-
2]),C=decodeURIComponent(g[g.length-1]);return[g.slice(0,g.length-2).map(function(G){G=decodeURIComponent(G);"{"===G.charAt(0)&&(G=JSON.parse(G));return G}),t,C]}function r(){if(0<e.length){var g=e.pop();n.b(g[0],g[1],g[2],function(){r()})}}function h(){return-1!==window.location.href.indexOf("f=")}function y(){return-1!==window.location.href.indexOf("sh=t")}function B(){setInterval(function(){"block"!==x("#msgModal").css("display")&&D()},1E3)}a.d(c,"h",function(){return m});a.d(c,"f",function(){return D});
a.d(c,"d",function(){return f});a.d(c,"e",function(){return p});a.d(c,"c",function(){return u});a.d(c,"g",function(){return r});a.d(c,"b",function(){return h});a.d(c,"a",function(){return y});var q=a("qmVJ"),n=a("EYe7"),d=a("PjGz"),b=a("uBLq"),l=a("gqHH"),k=a("vCcv"),e=[],m=void 0,F=!1,v}).call(this,a("EVdn"))},pAUf:function(E,c,a){function x(){function k(e){h.A.C=1;B.b();D(e);f(e)}u.g();h.z.webVRCamera.onControllerMeshLoadedObservable.add(function(e){k(e)});h.z.onControllerMeshLoaded.add(function(e){k(e)})}
function A(){}function D(k){k.onTriggerStateChangedObservable.add(function(e){e.pressed&&(e=(new Date).getTime(),e-q>h.n&&(q=e,p.a()))})}function f(k){k.onPadStateChangedObservable.add(function(e){(l=e.pressed)&&Math.abs(d)<h.l&&Math.abs(b)<h.l&&console.log("Would reset camera view if you didn't get an error below...")});k.onPadValuesChangedObservable.add(function(e){d=e.y;b=e.x;Math.abs(b)<h.l&&Math.abs(d)<h.l?b=d=0:.5>Math.abs(b)?b=0:(b+=0<b?-.5:.5,b=2*b)});h.s.registerBeforeRender(function(){if(l){if(!r.a.equals(r.e)){var e=
y.a(),m=r.a.subtract(e);m.normalize();m=m.scale(d*h.h*h.s.getAnimationRatio());y.e(e.subtract(m))}0!==b&&(e=(new Date).getTime(),e-n<h.m||(n=e,e=h.z.webVRCamera.rotationQuaternion.toEulerAngles(),e.y+=.25*Math.sign(b)*Math.PI,h.z.webVRCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(e)))}})}a.d(c,"a",function(){return x});a.d(c,"b",function(){return A});var p=a("9bcR"),u=a("TqLJ"),r=a("ph2Y"),h=a("gqHH"),y=a("vCcv"),B=a("nV79"),q=0,n=0,d=0,b=0,l=!1},ph2Y:function(E,c,a){function x(){var n=
1.5*p.a;p.s.registerBeforeRender(function(){a:{if(3===p.A.C)var d=p.s.activeCamera.getForwardRay();else if(2===p.A.C||1===p.A.C){d=void 0;1===p.A.C?(d=p.z.rightControllerGazeTrackerMesh,d||(d=p.z.leftControllerGazeTrackerMesh)):2===p.A.C&&(d=p.z.gazeTrackerMesh);if(!d){console.log("error!");break a}d.isVisible?q.copyFrom(d.absolutePosition):q.copyFrom(h);d=f.a();d=new BABYLON.Ray(d,q.subtract(d))}else console.log("Unexpected error.");A(d)}void 0===q?(q.copyFrom(h),u.i(void 0)):10<BABYLON.Vector3.Distance(f.a(),
q)&&(q.copyFrom(h),u.i(void 0));p.A.ca.position.copyFrom(q);void 0!==u.d&&(p.A.ca.isVisible=u.d!==u.h);d=f.a();var b=D(d).pickedPoint;b&&(y=b,d.y-b.y<n?(r.c.button.isVisible=!1,r.c.J.isVisible=!1):(r.c.button.isVisible=!0,r.c.J.isVisible=!0));(b=D(q).pickedPoint)&&(B=b)})}function A(n,d){void 0===d&&(d=!0);n=p.s.pickWithRay(n,function(l){return u.c(l)});var b=n.distance;n.hit&&b<p.c?(d&&q.copyFrom(n.pickedPoint),u.i(n.pickedMesh)):(q.copyFrom(h),u.i(void 0))}function D(n){n=new BABYLON.Ray(n,new BABYLON.Vector3(0,
-1,0),50);return p.s.pickWithRay(n,function(d){return d.id===p.A.H.id})}a.d(c,"e",function(){return h});a.d(c,"b",function(){return y});a.d(c,"c",function(){return B});a.d(c,"a",function(){return q});a.d(c,"f",function(){return x});a.d(c,"d",function(){return D});var f=a("vCcv"),p=a("gqHH"),u=a("TqLJ"),r=a("jIpr"),h=new BABYLON.Vector3(-1E3,1E3,1E3),y=new BABYLON.Vector3(0,0,0),B=new BABYLON.Vector3(0,0,0),q=new BABYLON.Vector3(0,0,0)},qmVJ:function(E,c,a){function x(d){n=d}function A(){D()}function D(){B.h(function(){h.e();
B.b(n,function(d){h.f();h.b()||(f(d),u.b(p.b));h.g();y.a();"nanokid.sdf"===n&&!1===h.b()&&setTimeout(function(){r.b("Load Molecule","pages/load.html")},3E3)})})}function f(d){var b=d.selectedAtoms({});q={"Atom Name":[],Chain:[],Element:[],"Residue Index":[],"Residue Name":[],"Secondary Structure":[]};var l=b.length;for(d=0;d<l;d++){var k=b[d];q["Atom Name"].push(k.atom);q.Chain.push(k.chain);q.Element.push(k.elem);q["Residue Name"].push(k.resn);q["Residue Index"].push(k.resi);q["Secondary Structure"].push(k.ss)}b=
Object.keys(q);l=b.length;for(d=0;d<l;d++){var e=b[d];k=q;var m=e;e=q[e];for(var F={},v=[],g=0,t=e.length;g<t;++g)F.hasOwnProperty(e[g])||(v.push(e[g]),F[e[g]]=1);k[m]=v}}a.d(c,"a",function(){return q});a.d(c,"b",function(){return n});a.d(c,"c",function(){return x});a.d(c,"d",function(){return A});var p=a("jIpr"),u=a("BjG7"),r=a("iC5T"),h=a("p11u"),y=a("cw8d"),B=a("PjGz"),q={},n="nanokid.sdf"},sqbB:function(E,c,a){function x(){var r=f.s.lights[0],h=A();p.a()&&(u=new BABYLON.ShadowGenerator(4096,r),
u.useBlurExponentialShadowMap=!0,u.G=!0,u.B=h.blur,u.setDarkness(h.ja))}function A(){var r=f.s.lights[0],h=64,y=.9625,B=void 0,q=r.name.match(/blur_([0-9\.]+)/g);null!==q&&(h=+q[0].substr(5));q=r.name.match(/dark_([0-9\.]+)/g);null!==q&&(y=+q[0].substr(5));r=r.name.match(/ambient_([0-9\.]+)/g);null!==r&&(B=+r[0].substr(8));return{blur:h,ja:y,ia:B}}function D(){for(var r=f.s.meshes.length,h=0;h<r;h++){var y=f.s.meshes[h];if(-1!==y.name.toLowerCase().indexOf("shadowcatcher")||-1!==y.name.toLowerCase().indexOf("shadow_catcher"))y.material=
new BABYLON.ShadowOnlyMaterial("shadow_catch"+h.toString(),f.s),y.material.activeLight=f.s.lights[0],y.receiveShadows=!0}}a.d(c,"d",function(){return u});a.d(c,"c",function(){return x});a.d(c,"a",function(){return A});a.d(c,"b",function(){return D});var f=a("gqHH"),p=a("p11u"),u},uBLq:function(E,c,a){function x(d){q=new Float32Array(D.a().asArray());n=new Float32Array(D.b().asArray());(new B(function(b){!0===f.a&&console.log("stud1 got data",b);var l=b.val;switch(b.type){case "locrot":q=new Float32Array([l[0],
l[1],l[2]]);n=new Float32Array([l[3],l[4],l[5],l[6]]);break;case "initialUrl":-1!==window.location.href.indexOf("nanokid.sdf")&&(b=l+"&f="+y,b=b.replace(/sh=true/g,"sh=false"),top.location.href=b);break;case "toggleRep":u.b(l.filters,l.repName,l.colorScheme,void 0);break;case "molAxisRotation":r.a(l);break;case "molUndoRot":r.c()}})).Aa(d);p.s.registerBeforeRender(function(){var b=new Float32Array(D.a().asArray());b=A(b,q);b=BABYLON.Vector3.FromArray(b);D.e(b);b=new Float32Array(D.b().asArray());
b=A(b,n);b=BABYLON.Quaternion.FromArray(b);D.f(b)})}function A(d,b){for(var l=d.length,k=new Float32Array(l),e=0;e<l;e++)k[e]=b[e]-d[e];b=p.s.getAnimationRatio();var m=new Float32Array(l);for(e=0;e<l;e++)m[e]=d[e]+.02*b*k[e];return m}a.d(c,"a",function(){return x});var D=a("vCcv"),f=a("gg4m"),p=a("gqHH"),u=a("EYe7"),r=a("nKXq"),h=function(){function d(b,l){d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,e){k.__proto__=e}||function(k,e){for(var m in e)e.hasOwnProperty(m)&&(k[m]=
e[m])};return d(b,l)}return function(b,l){function k(){this.constructor=b}d(b,l);b.prototype=null===l?Object.create(l):(k.prototype=l.prototype,new k)}}(),y,B=function(d){function b(l){var k=d.call(this)||this;k.M=null;k.ya=l;k.ea();return k}h(b,d);b.prototype.Aa=function(l){var k=this;this.M&&this.M.close();this.M=this.D.connect(l,{reliable:!0});this.Ba();this.M.on("open",function(){!0===f.a&&console.log("Connected to: "+k.M.D)});y=l};b.prototype.ea=function(){var l=this;this.D.on("close",function(){l.M=
null;f.d()})};b.prototype.Ba=function(){var l=this;this.M.on("data",function(k){!0===f.a&&console.log("Received:",k);l.ya(k)});this.M.on("close",function(){f.c("Leader connection closed.")})};return b}(f.b),q=null,n=null},vCcv:function(E,c,a){function x(){var q=h.s.activeCamera,n=q.position.clone();if(2===h.A.C||1===h.A.C)q.leftCamera?n.copyFrom(q.leftCamera.globalPosition):console.log("Prob here");return n}function A(q){if(3===h.A.C){var n=h.s.activeCamera;n.position.copyFrom(q)}else if(2===h.A.C||
1===h.A.C)n=h.z.webVRCamera,n.position.copyFrom(q.subtract(u()))}function D(){if(2===h.A.C||1===h.A.C){var q=h.z.webVRCamera.deviceRotationQuaternion;return 0!==q.x?q:h.s.activeCamera.rotationQuaternion}return h.s.activeCamera.rotationQuaternion}function f(q){2===h.A.C||1===h.A.C?console.log("PROBLEM!"):(h.s.activeCamera.rotationQuaternion=q.clone(),h.s.activeCamera.rotation=h.s.activeCamera.rotationQuaternion.toEulerAngles())}function p(){if(2===h.A.C||1===h.A.C){var q=r.c.subtract(r.b),n=BABYLON.Vector3.GetAngleBetweenVectors(q,
y,B);for(0>q.z&&(n=-n);0>n;)n+=2*Math.PI;for(;n>2*Math.PI;)n-=2*Math.PI;return n+=.5*Math.PI}return h.s.activeCamera.rotation.clone().y}function u(){if(3===h.A.C)return new BABYLON.Vector3(0,0,0);var q=h.z.webVRCamera,n;q.leftCamera?n=q.leftCamera.globalPosition.subtract(q.position):n=new BABYLON.Vector3(0,0,0);return n}a.d(c,"a",function(){return x});a.d(c,"e",function(){return A});a.d(c,"b",function(){return D});a.d(c,"f",function(){return f});a.d(c,"c",function(){return p});a.d(c,"d",function(){return u});
var r=a("ph2Y"),h=a("gqHH"),y=new BABYLON.Vector3(1,0,0),B=new BABYLON.Vector3(1,0,0)}},[["/7QA",1,2]]]);}).call(this || window)
