/**
 * ProteinVR (The 3-Clause BSD License)
 * 
 * Copyright 2019 Jacob D. Durrant.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 * 
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 * 3. Neither the name of the copyright holder nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
(function(){'use strict';function T(G){var b=0;return function(){return b<G.length?{done:!1,value:G[b++]}:{done:!0}}}var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(G,b,a){G!=Array.prototype&&G!=Object.prototype&&(G[b]=a.value)},U="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;
function V(G,b){if(b){var a=U;G=G.split(".");for(var x=0;x<G.length-1;x++){var F=G[x];F in a||(a[F]={});a=a[F]}G=G[G.length-1];x=a[G];b=b(x);b!=x&&null!=b&&aa(a,G,{configurable:!0,writable:!0,value:b})}}function W(G){var b="undefined"!=typeof Symbol&&Symbol.iterator&&G[Symbol.iterator];return b?b.call(G):{next:T(G)}}
V("Promise",function(G){function b(e){this.G=0;this.N=void 0;this.B=[];var q=this.K();try{e(q.resolve,q.reject)}catch(t){q.reject(t)}}function a(){this.B=null}function x(e){return e instanceof b?e:new b(function(q){q(e)})}if(G)return G;a.prototype.G=function(e){if(null==this.B){this.B=[];var q=this;this.K(function(){q.N()})}this.B.push(e)};var F=U.setTimeout;a.prototype.K=function(e){F(e,0)};a.prototype.N=function(){for(;this.B&&this.B.length;){var e=this.B;this.B=[];for(var q=0;q<e.length;++q){var t=
e[q];e[q]=null;try{t()}catch(g){this.M(g)}}}this.B=null};a.prototype.M=function(e){this.K(function(){throw e;})};b.prototype.K=function(){function e(g){return function(v){t||(t=!0,g.call(q,v))}}var q=this,t=!1;return{resolve:e(this.Aa),reject:e(this.M)}};b.prototype.Aa=function(e){if(e===this)this.M(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof b)this.Ba(e);else{a:switch(typeof e){case "object":var q=null!=e;break a;case "function":q=!0;break a;default:q=!1}q?this.za(e):
this.ba(e)}};b.prototype.za=function(e){var q=void 0;try{q=e.then}catch(t){this.M(t);return}"function"==typeof q?this.Ca(q,e):this.ba(e)};b.prototype.M=function(e){this.ma(2,e)};b.prototype.ba=function(e){this.ma(1,e)};b.prototype.ma=function(e,q){if(0!=this.G)throw Error("Cannot settle("+e+", "+q+"): Promise already settled in state"+this.G);this.G=e;this.N=q;this.ya()};b.prototype.ya=function(){if(null!=this.B){for(var e=0;e<this.B.length;++e)B.G(this.B[e]);this.B=null}};var B=new a;b.prototype.Ba=
function(e){var q=this.K();e.ea(q.resolve,q.reject)};b.prototype.Ca=function(e,q){var t=this.K();try{e.call(q,t.resolve,t.reject)}catch(g){t.reject(g)}};b.prototype.then=function(e,q){function t(w,d){return"function"==typeof w?function(l){try{g(w(l))}catch(f){v(f)}}:d}var g,v,y=new b(function(w,d){g=w;v=d});this.ea(t(e,g),t(q,v));return y};b.prototype.catch=function(e){return this.then(void 0,e)};b.prototype.ea=function(e,q){function t(){switch(g.G){case 1:e(g.N);break;case 2:q(g.N);break;default:throw Error("Unexpected state: "+
g.G);}}var g=this;null==this.B?B.G(t):this.B.push(t)};b.resolve=x;b.reject=function(e){return new b(function(q,t){t(e)})};b.race=function(e){return new b(function(q,t){for(var g=W(e),v=g.next();!v.done;v=g.next())x(v.value).ea(q,t)})};b.all=function(e){var q=W(e),t=q.next();return t.done?x([]):new b(function(g,v){function y(l){return function(f){w[l]=f;d--;0==d&&g(w)}}var w=[],d=0;do w.push(void 0),d++,x(t.value).ea(y(w.length-1),v),t=q.next();while(!t.done)})};return b});
V("Array.prototype.find",function(G){return G?G:function(b,a){a:{var x=this;x instanceof String&&(x=String(x));for(var F=x.length,B=0;B<F;B++){var e=x[B];if(b.call(a,e,B,x)){b=e;break a}}b=void 0}return b}});var X;if("function"==typeof Object.setPrototypeOf)X=Object.setPrototypeOf;else{var Y;a:{var ba={na:!0},Z={};try{Z.__proto__=ba;Y=Z.na;break a}catch(G){}Y=!1}X=Y?function(G,b){G.__proto__=b;if(G.__proto__!==b)throw new TypeError(G+" is not extensible");return G}:null}var ca=X;
V("Object.setPrototypeOf",function(G){return G||ca});V("Math.sign",function(G){return G?G:function(b){b=Number(b);return 0===b||isNaN(b)?b:0<b?1:-1}});
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"/7QA":function(G,b,a){function x(q){e.b({title:"Welcome",content:'\n    <div class="media">\n        <img src="icon-512.png" style="max-width: 25%;" class="mr-3" alt="ProtienVR Logo">\n        <div class="media-body">\n            <h5 class="mt-0">Welcome to ProteinVR '+F.k+'</h5>\n            <p>Brought to you by the <a href="http://durrantlab.com" target="_blank">Durrant Lab</a>.</p>\n            <p>Please authorize access to your device\'s orientation sensors to continue.</p>\n        </div>\n    </div>',J:!1,
ca:"Authorize",W:function(){q()}})}a.r(b);G=a("fcUb");a("SYky");b=a("p11u");var F=a("gqHH"),B=a("VNi4"),e=a("iC5T");console.log("ProteinVR "+F.k);document.title="ProteinVR "+F.k;(function(){"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("service-worker.js",{scope:"./"}).then(function(q){console.log("SW registered: ",q)}).catch(function(q){console.log("SW registration failed: ",q)})})})();b.f();(function(){B.a("DeviceOrientationAuthorizedIfNeeded",
[],function(q){"function"===typeof DeviceMotionEvent.requestPermission?x(function(){DeviceOrientationEvent.requestPermission().then(function(t){"granted"==t&&q()}).catch(console.error)}):q()})})();G.a();(function(){-1!==window.location.href.indexOf("durrantlab")&&setTimeout(function(){(function(t,g,v,y,w,d,l){t.GoogleAnalyticsObject=w;t[w]=t[w]||function(){(t[w].q=t[w].q||[]).push(arguments)};t[w].Ma=(new Date).getTime();d=g.createElement(v);l=g.getElementsByTagName(v)[0];d.async=1;d.src=y;l.parentNode.insertBefore(d,
l)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create","UA-144382730-1",{name:"proteinvr"});var q=window.location.href;-1!==q.indexOf("?")&&(q=q.split("?")[0]+"?PARAMS_REMOVED");ga("proteinvr.send",{hitType:"event",eventCategory:"proteinvr",eventAction:"pageview",eventLabel:q})},0)})()},"0fSa":function(G,b,a){function x(){y.a("OptimizeScene",["LoadBabylonScene"],function(w){g.t.autoClear=!1;g.t.autoClearDepthAndStencil=!1;var d=g.t.meshes.length;new BABYLON.Color3(0,
0,0);for(var l=0;l<d;l++){var f=g.t.meshes[l];-1!==f.name.indexOf("baked")&&void 0!==f.material&&f.freezeWorldMatrix()}d=!1;for(l=0;1<g.t.lights.length;)f=g.t.lights[l].name.toLowerCase(),-1===f.indexOf("shadowlight")&&-1===f.indexOf("shadow_light")?g.t.lights[l].dispose():d?g.t.lights[l].dispose():(d=!0,l++);d=g.t.meshes.length;for(l=0;l<d;l++)f=g.t.meshes[l],"protein_box"===f.name?f.isVisible=!1:-1!==f.name.toLowerCase().indexOf("skybox")&&g.u.ra&&(f.material.disableLighting=!0,f.infiniteDistance=
!0);d=g.t.meshes.length;for(l=0;l<d;l++)f=g.t.meshes[l],f.material&&f.material.emissiveTexture&&(f.material.emissiveColor=new BABYLON.Color3(1,1,1),f.material.albedoColor=new BABYLON.Color3(0,0,0),f.material.Ka=new BABYLON.Color3(0,0,0));d=g.t.meshes.length;for(l=0;l<d;l++)if(g.t.meshes[l].material){f=g.t.meshes[l];if(void 0===f.material.emissiveTexture||null===f.material.emissiveTexture&&"navTargetMesh"!==f.name)f.material.emissiveTexture=f.material.diffuseTexture,f.material.diffuseColor=new BABYLON.Color3(0,
0,0),f.material.specularColor=new BABYLON.Color3(0,0,0),f.material.emissiveColor=new BABYLON.Color3(0,0,0);B(f,!1);v.f({mesh:f,scene:g.t})}w()})}function F(w){if(void 0!==w){var d=w.getVerticesData(BABYLON.VertexBuffer.PositionKind);null===d?d=null:d=d.length/3}else d=0;null===d||100>d||(d=1+Math.floor(d/g.d),1<d&&w.subdivide(d))}function B(w,d){void 0===d&&(d=!0);d&&w.material.freeze()}function e(){t.d&&(g.t.lights[0].autoUpdateExtends=!0,t.d.getShadowMap().refreshRate=BABYLON.RenderTargetTexture.REFRESHRATE_RENDER_ONCE,
g.t.lights[0].autoUpdateExtends=!1)}function q(w){null!==w&&w.dispose()}a.d(b,"d",function(){return x});a.d(b,"b",function(){return F});a.d(b,"a",function(){return B});a.d(b,"e",function(){return e});a.d(b,"c",function(){return q});var t=a("sqbB"),g=a("gqHH"),v=a("TqLJ"),y=a("VNi4")},"1RHl":function(G,b,a){function x(){e.a("SetupCamera",["LoadBabylonScene"],function(){q=F.t.cameras.filter(function(g){return-1===g.name.indexOf("XR")&&-1===g.name.indexOf("VR")&&""!==g.name})[0];var t=new BABYLON.DeviceOrientationCamera("DevOr_camera",
q.position.clone(),F.t,!0);t.rotation=q.rotation.clone();F.t.activeCamera=t;F.t.activeCamera.rotationQuaternion=BABYLON.Quaternion.FromEulerVector(q.rotation);F.q();B.c()})}a.d(b,"a",function(){return x});var F=a("gqHH"),B=a("ejGh"),e=a("VNi4"),q},"9bcR":function(G,b,a){(function(x){function F(){p.a("SetupNavigation",["LoadBabylonScene"],function(z){h.b()?(f.A.C=3,f.t.getMeshByID("ground").visibility=0,f.A.V.isVisible=!1):(D.a(),f.A.H=f.t.getMeshByID("ground"),null===f.A.H&&alert("No mesh named ground"),
f.A.H.checkCollisions=!0,f.A.H.visibility=0,l.b(f.A.H),m.f({da:q,mesh:f.A.H}),f.A.C=3,e(),c.g(),v(),B());z()})}function B(){H=w.a();f.t.registerBeforeRender(function(){var z=w.a();null===c.d(z).pickedMesh&&E===f.t.activeCamera.id?w.e(H):(H=z,E=f.t.activeCamera.id)})}function e(){x("body").keydown(function(z){!1===u.a&&(z="undefined"==typeof z.which?z.keyCode:z.which,32===z?q():77===z?r.c.ka():27===z&&C.a())})}function q(){if(!h.b()){var z=(new Date).getTime();if(!(250>z-I))switch(I=z,m.e()){case 2:t();
break;case 4:g();break;case 3:m.d.D()}}}function t(z,A){void 0===z&&(z=void 0);void 0===A&&(A=void 0);void 0===A&&(A=function(){});f.A.V.isVisible=!1;var K=new BABYLON.Animation("animationCameraTeleportation","position",90,BABYLON.Animation.ANIMATIONTYPE_VECTOR3,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT),J=w.a();void 0===z&&(z=new BABYLON.Vector3(c.a.x,c.a.y+f.o,c.a.z));var L=w.d();z=z.subtract(L);J=J.subtract(L);K.setKeys([{frame:0,value:J},{frame:f.j,value:z}]);var O=f.t.activeCamera;O.animations=
[];O.animations.push(K);f.t.beginAnimation(O,0,f.j,!1,1,function(){f.A.V.isVisible=!0;O.animations=[];A()})}function g(){var z=c.c,A=w.a(),K=c.a.subtract(A),J=K.length(),L;.1*J<f.g?L=c.a.subtract(K.normalize().scale(f.g)):.1*J>f.b?L=c.a.subtract(K.normalize().scale(f.b)):.1*J<f.b&&(L=A.add(K.scale(.9)));L.y=c.a.y;L.y-z.y<.5*f.a+.1&&(L.y=z.y+.5*f.a+.1);f.w(c.a.y-z.y);t(L,function(){d.b()})}function v(){k=x("#capture-clicks");k.click(function(){q()});setInterval(y,500)}function y(){if(!0!==n){var z=
f.t.activeCamera.inputs.attached.deviceOrientation;(z=z?0!==z._alpha||0!==z._beta||0!==z._gamma:!1)&&!n?(n=!0,k.show(),console.log("Device orientation sensor detected...")):!z&&n&&(n=!1,k.hide())}}a.d(b,"b",function(){return F});a.d(b,"a",function(){return q});var w=a("vCcv"),d=a("ejGh"),l=a("0fSa"),f=a("gqHH"),m=a("TqLJ"),c=a("ph2Y"),h=a("p11u"),r=a("jIpr"),u=a("iC5T"),D=a("vMIs"),p=a("VNi4"),C=a("nV79"),H,E="",I=0,k=void 0,n=!1}).call(this,a("EVdn"))},BjG7:function(G,b,a){function x(){function c(D){function p(E){var I=
d[C][E];h.Components[C][I]=q({},C,function(k,n){g.b([C,I],k,n)})}var C=w[D];h.Components[C]={};D=d[C].length;for(var H=0;H<D;H++)p(H)}for(var h={Components:{},Selections:{},Clear:function(){for(var D=Object.keys(g.a),p=D.length,C=0;C<p;C++)g.a[D[C]].mesh.isVisible=!1},"Remove Existing":{}},r=w.length,u=0;u<r;u++)c(u);return h}function F(c){if(!v.b()){c.Styles["Remove Existing"]={};y.e(c.Styles["Remove Existing"],["Styles","Remove Existing"]);for(var h=Object.keys(g.a),r=h.length,u=function(p){var C=
h[p];!0===g.a[C].mesh.isVisible&&(p=C.replace(/--/g," "),p=p.replace(/{/g,"").replace(/}/g,"").replace(/"/g,""),c.Styles["Remove Existing"][p]=function(){setTimeout(function(){var H=v.e(C);g.b(H[0],H[1],"Hide")},0)})},D=0;D<r;D++)u(D)}}function B(c){function h(E,I,k,n){function z(J){J=A[J];if(1===J.length){var L=J[0];void 0===L?(L="N/A",I[L]=function(){}):(I[L]={},I[L]=q(I[L],E,function(N,Q){var M={};M[r[E]]=L;g.b([M],N,Q)},n.concat([L])))}else{var O="["+J[0].toString()+"-"+J[J.length-1].toString()+
"]";I[O]={};h(E,I[O],J,n.concat([O]))}}k.sort(function(J,L){J=isNaN(+J)?J:+J;L=isNaN(+L)?L:+L;return J<L?-1:J>L?1:0});var A=e(k,14);k=A.length;for(var K=0;K<k;K++)z(K);y.e(I,n)}c.Styles.Selections={};y.e(c.Styles.Selections,["Styles","Selections"]);for(var r={"Atom Name":"atom",Chain:"chain",Element:"elem","Residue Index":"resi","Residue Name":"resn","Secondary Structure":"ss"},u=Object.keys(t.a),D=u.length,p=0;p<D;p++){var C=u[p],H=t.a[C];c.Styles.Selections[C]={};h(C,c.Styles.Selections[C],H,["Styles",
"Selections",C])}}function e(c,h){if(2>h)return[c];var r=c.length,u=[],D=0,p;if(0===r%h)for(p=Math.floor(r/h);D<r;)u.push(c.slice(D,D+=p));else for(;D<r;)p=Math.ceil((r-D)/h--),u.push(c.slice(D,D+=p));return u}function q(c,h,r,u){function D(H){function E(z){var A=f[z];c[k].Colors[A]=function(){r(k,A)}}function I(z){var A=m[z];c[k]["Color Schemes"][A]=function(){r(k,A)}}var k=p[H];c[k]={Colors:{},"Color Schemes":{}};H=m.length;for(var n=0;n<H;n++)I(n);H=f.length;for(n=0;n<H;n++)E(n);c[k].Hide=function(){r(k,
"Hide")};void 0!==u&&(H=u.concat([k]),y.e(c[k],H),H=u.concat([k,"Colors"]),n=c[k].Colors,y.e(n,H),H=u.concat([k,"Color Schemes"]),n=c[k]["Color Schemes"],y.e(n,H))}var p=void 0===l[h]?l.Protein:l[h];h=p.length;for(var C=0;C<h;C++)D(C);void 0!==u&&y.e(c,u);return c}a.d(b,"a",function(){return x});a.d(b,"c",function(){return F});a.d(b,"b",function(){return B});var t=a("qmVJ"),g=a("EYe7"),v=a("p11u"),y=a("jIpr"),w=["Protein","Ligand","Ligand Context","Water","Nucleic"],d={Ligand:["All"],"Ligand Context":["All"],
Nucleic:["All"],Protein:["All","Hydrophobic","Hydrophilic","Charged","Aromatic"],Water:["All"]};G=["Stick","Sphere","Surface"];var l={Ligand:G,"Ligand Context":["Cartoon"].concat(G),Nucleic:G,Protein:["Cartoon"].concat(G),Water:G},f="White Red Blue Green Orange Yellow Purple".split(" "),m=["Element","Amino Acid","Chain","Nucleic","Spectrum"]},EYe7:function(G,b,a){function x(r,u,D,p){void 0===p&&(p=void 0);f.a&&f.b(r,u,D);var C=B(r,u,D);void 0===p&&(p=function(){});if("Hide"===D){D=Object.keys(m);
r=D.length;for(var H=0;H<r;H++){var E=m[D[H]];E.P===C.P&&(E.mesh.isVisible=!1,console.log("Hiding existing mesh..."))}d.b(void 0,w.t.getMeshByName("protein_box"));q()}else void 0!==m[C.ia]?(m[C.ia].mesh.isVisible=!0,console.log("showing existing mesh..."),d.b(void 0,w.t.getMeshByName("protein_box")),q()):(l.e(),D=h[D],r={and:r.map(function(I){return void 0!==c[I]?c[I]:I})},"surface"===u.toLowerCase()?l.a(D,r,function(){F(C,u,p)}):(H={},H[u.toLowerCase()]=D,l.g(r,H),F(C,u,p)))}function F(r,u,D){l.d(!0,
u,function(p){for(var C=Object.keys(m),H=C.length,E=0;E<H;E++){var I=C[E],k=m[I];k.P===r.P&&(t.c(k.mesh),delete m[I],console.log("deleting old mesh..."))}void 0!==p&&("Surface"===u&&(p.material.backFaceCulling=!1),m[r.ia]={P:r.P,mesh:p});q();D()})}function B(r,u,D){r.sort();r=r.map(function(p){return"string"===typeof p?p:JSON.stringify(p)});return{P:r.join("--")+"--"+u,ia:r.join("--")+"--"+u+"--"+D}}function e(r){for(var u=r.map(function(H){return H}),D=r.length,p=0;p<D;p++){var C=r[p];u.push(C.toUpperCase());
u.push(C.toLowerCase())}return u=u.filter(function(H,E){return u.indexOf(H)>=E})}function q(){y.h();v.c(g.b)}a.d(b,"a",function(){return m});a.d(b,"b",function(){return x});var t=a("0fSa"),g=a("jIpr"),v=a("BjG7"),y=a("p11u"),w=a("gqHH"),d=a("YORc"),l=a("PjGz"),f=a("mvtX"),m={},c={All:{},Protein:{resn:e("ALA ARG ASP ASN ASX CYS GLN GLU GLX GLY HIS HSP HYP ILE LEU LYS MET PCA PHE PRO TRP TYR VAL GLU SER THR MSE".split(" "))},Acidic:{resn:e(["ASP","GLU"])},Cyclic:{resn:e(["HIS","PHE","PRO","TRP","TYR"])},
Aliphatic:{resn:e(["ALA","GLY","ILE","LEU","VAL"])},Aromatic:{resn:e(["HIS","PHE","TRP","TYR"])},Basic:{resn:e(["ARG","HIS","LYS","HSP"])},Charged:{resn:e("ASP GLU ARG HIS LYS HSP".split(" "))},Hydrophobic:{resn:e("ALA LEU VAL ILE PRO PHE MET TRP".split(" "))},Neutral:{resn:e("VAL PHE GLN TYR HIS CYS MET TRP ASX GLX PCA HYP".split(" "))},Nucleic:{resn:e("ADE A GUA G CYT C THY T URA U DA DG DC DT".split(" "))},Purine:{resn:e(["ADE","A","GUA","G"])},Pyrimidine:{resn:e("CYT C THY T URA U".split(" "))},
Ions:{resn:e("AL BA CA CAL CD CES CLA CL CO CS CU CU1 CUA HG IN IOD K MG MN3 MO3 MO4 MO5 MO6 NA NAW OC7 PB POT PT RB SOD TB TL WO4 YB ZN ZN1 ZN2".split(" "))},Water:{resn:e(["WAT","HOH","TIP","TIP3"])}};c.Ligand={not:{or:[c.Protein,c.Nucleic,c.Ions,c.Water]}};c["Ligand Context"]={byres:!0,within:{distance:4,sel:c.Ligand}};var h={"Amino Acid":{colorscheme:"amino"},Blue:{color:"blue"},Chain:{colorscheme:"chain"},Element:{colorscheme:"default"},Green:{color:"green"},Nucleic:{colorscheme:"nucleic"},Orange:{color:"orange"},
Purple:{color:"purple"},Red:{color:"red"},Spectrum:{color:"spectrum"},White:{color:"white"},Yellow:{color:"yellow"}}},O2BG:function(G,b,a){G.La=a.p+"cf4bd43cd8dade4b62f7e691f5d0f8cc.mp3"},PjGz:function(G,b,a){(function(x,F){function B(A){var K=x("#mol-container");K&&K.remove();x("body").append('<div\n        id="mol-container"\n        class="mol-container"\n        style="display:none;"></div>');C=x("#mol-container");H={backgroundColor:"white"};p=F.createViewer(C,H);A()}function e(){z&&(z=!1,p=null,
B(function(){p.addModel(k,"pdb",{keepH:!0})}));p.setStyle({},{})}function q(A,K){x.ajax(A,{success:function(J){k=J;n="pdb";"sdf"===A.slice(A.length-3).toLowerCase()&&(n="sdf");J=p.addModel(J,n,{keepH:!0});K(J)},error:function(J,L,O){J="<p>Could not load molecule: "+A+"</p>";J=J+("<p><pre>"+O+'</pre></p><p>(<a href="')+(window.location.href.split("?")[0]+'">Click to restart...</a>)</p>');r.b({title:"Error Loading Molecule",content:J,J:!1,I:!1,U:!0})}})}function t(A,K){void 0!==A.and&&1===Object.keys(A).length&&
"{}"===JSON.stringify(A.and[0])&&2===A.and.length&&(A=A.and[1]);0!==p.selectedAtoms(A).length&&(p.setStyle(A,K),p.render())}function g(A,K,J){0!==p.selectedAtoms(K).length&&(z=!0,p.addSurface(F.SurfaceType.MS,A,K,void 0,void 0,function(){J()}))}function v(A,K,J){void 0===J&&(J=function(){});m.r.hideLoadingUI();A&&y(function(){w(K,function(){var L=new BABYLON.StandardMaterial("Material",m.t);L.diffuseColor=new BABYLON.Color3(1,1,1);L.emissiveColor=new BABYLON.Color3(0,0,0);L.specularColor=new BABYLON.Color3(0,
0,0);for(var O=[],N=u.length,Q=0;Q<N;Q++){var M=u[Q],P=[];BABYLON.VertexData.ComputeNormals(M.coors,M.trisIdxs,P);var R=new BABYLON.VertexData;R.positions=M.coors;R.indices=M.trisIdxs;R.normals=P;R.colors=M.colors;M=new BABYLON.Mesh("mesh_3dmol_tmp"+Q,m.t);R.applyToMesh(M);M.material=L;O.push(M)}if(0<O.length){var S=BABYLON.Mesh.MergeMeshes(O,!0,!0);S.name="MeshFrom3DMol"+Math.random().toString();S.id=S.name;c.b(S,123456789)}L=S;void 0!==L&&h.b(L,m.t.getMeshByName("protein_box"));J(L);u=[]})})}function y(A){try{E=
p.exportVRML()}catch(K){console.log("Error that you should try to debug!",K)}A()}function w(A,K){u=[];if("undefined"!==typeof Worker)I.onmessage=function(J){J=J.data;var L=J.chunk;J=J.status;if(void 0!==L){for(var O=L[0],N=L[1],Q=L[2];u.length<=O;)u.push({coors:new Float32Array(0),colors:new Float32Array(0),trisIdxs:new Uint32Array(0)});L=u[O];O=[u[O][N],Q];var M=0;Q=O.length;for(var P=0;P<Q;P++){var R=O[P];M+=R.length}M=new ("trisIdxs"===N?Uint32Array:Float32Array)(M);var S=0;for(P=0;P<Q;P++)R=O[P],
M.set(R,S),S+=R.length;L[N]=M}switch(J){case "more":I.postMessage({cmd:"sendDataChunk",data:void 0});break;case "done":K();break;default:console.log("Error here!")}},I.postMessage({cmd:"start",data:E,removeExtraPts:"Stick"===A});else throw r.b({title:"Browser Error",content:"Your browser does not support web workers. Please use a more\n            modern browser when running ProteinVR.",J:!1}),Error("Browser does not support web workers.");}function d(A,K){D[A]+=K;f.h()}function l(A,K,J){D=new BABYLON.Vector3(A,
K,J)}a.d(b,"c",function(){return D});a.d(b,"h",function(){return B});a.d(b,"e",function(){return e});a.d(b,"b",function(){return q});a.d(b,"g",function(){return t});a.d(b,"a",function(){return g});a.d(b,"d",function(){return v});a.d(b,"i",function(){return d});a.d(b,"f",function(){return l});var f=a("p11u"),m=a("gqHH"),c=a("cw8d"),h=a("YORc"),r=a("iC5T"),u=[],D=new BABYLON.Vector3(0,0,0),p,C,H,E,I=new Worker("vrmlWebWorker.js"),k="",n="pdb",z=!1}).call(this,a("EVdn"),a("VS3o"))},Rr3C:function(G,b,
a){function x(){document.getElementById("loadingContainer").outerHTML=""}function F(g){e();q.r.displayLoadingUI();q.r.loadingUIText=g}function B(g){var v=g;clearInterval(t);t=setInterval(function(){v+=.02*(99-v);q.r.displayLoadingUI();q.r.loadingUIText="Loading the main scene... "+v.toFixed(0)+"%<br /><br />(Loading too slow? Reload page, use Incognito<br />mode, or clear browser cache.)"},100)}function e(){clearInterval(t)}a.d(b,"b",function(){return x});a.d(b,"a",function(){return F});a.d(b,"c",
function(){return B});a.d(b,"d",function(){return e});var q=a("gqHH"),t},TqLJ:function(G,b,a){function x(p){D=p}function F(){f.a("SetupPickables",["LoadBabylonScene"],function(p){m.b()||c.push(d.A.H);p()})}function B(p){c.push(p);h.push(p);w.b(p);g({mesh:p,da:function(){p.D()}})}function e(p){c.push(p);r.push(p);w.b(p);g({mesh:p})}function q(p){return p.id===d.A.H.id?!0:p.isVisible?-1!==c.indexOf(p):!1}function t(){return void 0===D?1:D.name===d.A.H.name?2:-1!==h.indexOf(D)?3:-1!==r.indexOf(D)?4:
D.name===u.name?5:1}function g(p){void 0===p.da&&(p.da=l.a);void 0===p.scene&&(p.scene=d.t);void 0!==p.mesh&&(p.mesh.actionManager=new BABYLON.ActionManager(p.scene),p.mesh.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger,function(){3===d.A.C&&p.da()})))}function v(){if(-1===d.t.meshes.map(function(C){return C.name}).indexOf("padNavSphereAroundCamera")){u=BABYLON.Mesh.CreateSphere("padNavSphereAroundCamera",4,d.c-1,d.t);u.flipFaces(!0);var p=new BABYLON.StandardMaterial("padNavSphereAroundCameraMat",
d.t);p.diffuseColor=new BABYLON.Color3(1,1,1);p.specularColor=new BABYLON.Color3(0,0,0);p.B=null;u.material=p;u.visibility=0;d.t.registerBeforeRender(function(){u.position=y.a()});c.push(u)}}a.d(b,"h",function(){return u});a.d(b,"j",function(){return x});a.d(b,"d",function(){return D});a.d(b,"i",function(){return F});a.d(b,"a",function(){return B});a.d(b,"b",function(){return e});a.d(b,"c",function(){return q});a.d(b,"e",function(){return t});a.d(b,"f",function(){return g});a.d(b,"g",function(){return v});
var y=a("vCcv"),w=a("0fSa"),d=a("gqHH"),l=a("9bcR"),f=a("VNi4"),m=a("p11u"),c=[],h=[],r=[],u,D},VNi4:function(G,b,a){function x(e,q,t){if(void 0===B[e])throw Error("Promise not registered: "+e);for(var g=q.length,v=0;v<g;v++){var y=q[v];if(void 0===B[y])throw Error("Promise not registered: "+y);}B[e]=F(q).then(function(){return new Promise(function(w){t(w)})})}function F(e){var q=e.map(function(t){return B[t]});if(-1!==q.indexOf(null))throw Error("Trying to wait for a promise that hasn't been defined yet! One of these: "+
e.toString());return Promise.all(q)}a.d(b,"a",function(){return x});var B={DeviceOrientationAuthorizedIfNeeded:null,SceneLoaded:null,InitVR:null,SetupVRListeners:null,LoadBabylonScene:null,OptimizeScene:null,SetupCamera:null,SetupNavigation:null,SetupPickables:null,LoadMolecule:null,SetupMenus:null,FinalizeScene:null}},Vusd:function(G,b,a){(function(x){function F(){q.b({title:"Menu",content:'<div class="accrd" id="accordion-menu2d"></div>',J:!1,I:!0,U:!1,ha:!1,fa:!0}).then(function(){B("#accordion-menu2d",
t.b,[],0)})}function B(v,y,w,d){void 0===d&&(d=0);v=x(v);var l="",f=w.map(function(E){return e(E)}).join("-");l+='<div class="accrd" id="accordion-'+f+'">';for(var m=Object.keys(y),c=m.length,h=0;h<c;h++){var r=m[h];if(-1===["Close Menu \u00d7","Back \u21e6","Last","Exit VR \u00d7"].indexOf(r)){var u=y[r],D=f+(""===f?"":"-")+e(r),p="btn-"+D,C="collapse-"+D,H="background-color: rgb("+(10*Math.sin(d)+245+", "+(10*Math.sin(d+2)+245)+", "+(10*Math.sin(d+4)+245)+");");l+='\n            <div class="card">\n                <div id="'+
p+'"\n                  class="btn btn-sm menu2d-btn"\n                  data-toggle="collapse"\n                  data-target="#'+C+'"\n                  aria-expanded="false"\n                  aria-controls="'+C+'"\n                  style="font-size:'+(150-10*d)+"%; "+H+";\"\n                  data-clickpath='"+JSON.stringify(w.concat([r]))+"'\n                  data-depth='"+(d+1)+"'\n                  title=\""+r+'">\n                    '+r+"\n                </div>";switch(typeof u){case "object":l+=
'\n                    <div id="'+C+'" class="collapse" aria-labelledby="'+D+'" data-parent="#accordion-'+f+'">\n                        <div class="card-body pad10" style="'+H+'">\n                        </div> \x3c!-- card body --\x3e\n                    </div>';break;default:g[p]=u}l+="</div>"}}v.html(l+"</div>");v.find(".menu2d-btn").click(function(){var E=x(this),I=E.attr("id");if(void 0!==g[I])void 0!==g[I]?(g[I](),-1!==I.indexOf("-RemoveExisting-")&&E.hide()):console.warn("Function not defined: "+
I);else{var k=E.data("clickpath");I=k.map(function(A){return e(A)});var n=E.data("depth"),z=t.b;for(E=0;E<k.length;E++)z=z[k[E]];B("#collapse-"+I.join("-")+" .card-body",z,k,n);x(".inpath").removeClass("inpath");k=I.length;for(E=0;E<k;E++)x("#btn-"+I.slice(0,I.length-E).join("-")).addClass("inpath")}})}function e(v){v=v.replace(/'/g,"PRIME").replace(/\//g,"");var y="abcdefghijklmnopqrstuvwxyz".split("");y=y.concat(y.map(function(f){return f.toUpperCase()})).concat("0123456789".split(""));for(var w=
"",d=0;d<v.length;d++){var l=v.substring(d,d+1);-1!==y.indexOf(l)&&(w+=l)}return w}a.d(b,"a",function(){return F});var q=a("iC5T"),t=a("jIpr"),g={}}).call(this,a("EVdn"))},YORc:function(G,b,a){function x(f,m,c){void 0===c&&(c=!1);var h=B(f);void 0===d&&(d=y.c.clone());f=h.map(function(N){return{mesh:N,position:N.position.clone(),rotation:d.clone(),scaling:N.scaling.clone()}});d=y.c.clone();if(0!==h.length){e(h);g.t.render();var r=m.getBoundingInfo().boundingBox,u=Object.keys(r.maximumWorld).map(function(N){return r.maximumWorld[N]-
r.minimumWorld[N]}),D=0,p,C,H,E=h.length,I=function(N){N=h[N];var Q=N.getBoundingInfo().boundingBox,M=Object.keys(Q.maximumWorld).map(function(R){return Q.maximumWorld[R]-Q.minimumWorld[R]}),P=M[0]*M[1]*M[2];P>D&&(D=P,p=Q,C=M,H=N)};for(m=0;m<E;m++)I(m);m=u.map(function(N,Q){return N/C[Q]});m=Math.min.apply(null,m);I=new BABYLON.Vector3(m,m,m);for(m=0;m<E;m++)u=h[m],u.scaling=I;g.t.render();I=p.centerWorld.subtract(r.centerWorld);for(m=0;m<E;m++)u=h[m],u.position=u.position.subtract(I);g.t.render();
I=0;g.u.va&&(I=F(H,r));for(m=0;m<E;m++)u=h[m],u.position.y=u.position.y-I,u.visibility=1;w=f[0].rotation.clone();if(!0===c)for(c=f.length,m=0;m<c;m++){var k=f[m];E=k.mesh;var n=E.position.clone(),z=E.scaling.clone(),A=E.rotation.clone();u=q("posX","position.x",k.position.x,n.x);I=q("posY","position.y",k.position.y,n.y);n=q("posZ","position.z",k.position.z,n.z);var K=q("scaX","scaling.x",k.scaling.x,z.x),J=q("scaY","scaling.y",k.scaling.y,z.y);z=q("scaZ","scaling.z",k.scaling.z,z.z);var L=q("rotX",
"rotation.x",k.rotation.x,A.x),O=q("rotY","rotation.y",k.rotation.y,A.y);k=q("rotZ","rotation.z",k.rotation.z,A.z);E.animations=[u,I,n,K,J,z,L,O,k];g.t.beginAnimation(E,0,15,!1,1,function(){t.e()})}else t.e()}}function F(f,m){var c=Math.PI;c=f.name+"-"+(f.rotation.x%c).toFixed(3)+"-"+(f.rotation.y%c).toFixed(3)+"-"+(f.rotation.z%c).toFixed(3);if(void 0!==l[c])return l[c];var h=f.getVerticesData(BABYLON.VertexBuffer.PositionKind),r=1E6,u=h.length;f=f.getWorldMatrix();for(var D=Math.max(1,3*Math.floor(u/
3E3)),p=0;p<u;p+=D){var C=new BABYLON.Vector3(h[p],h[p+1],h[p+2]);C=BABYLON.Vector3.TransformCoordinates(C,f);C.y<r&&(r=C.y)}m=r-m.minimumWorld.y-.1;return l[c]=m}function B(f){for(var m=[],c=Object.keys(v.a),h=c.length,r=0;r<h;r++){var u=v.a[c[r]].mesh;!0===u.isVisible&&m.push(u)}void 0!==f&&m.push(f);return m}function e(f){for(var m=f.length,c=0;c<m;c++){var h=f[c];h.animations=[];!0===h.isVisible&&(h.scaling=new BABYLON.Vector3(1,1,1),h.position=new BABYLON.Vector3(0,0,0),h.rotation=y.c,h.visibility=
0)}}function q(f,m,c,h){f=new BABYLON.Animation(f,m,60,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE);f.setKeys([{frame:0,value:c},{frame:15,value:h}]);return f}a.d(b,"a",function(){return w});a.d(b,"b",function(){return x});var t=a("0fSa"),g=a("gqHH"),v=a("EYe7"),y=a("PjGz"),w=new BABYLON.Vector3(0,0,0),d=void 0,l={}},cw8d:function(G,b,a){function x(){v.a("LoadMolecule",["LoadBabylonScene","SetupMenus"],function(y){t.c();return q.d().then(function(){t.b();if(!0===
e.u.xa)if(e.A.H){e.A.H.visibility=1;var w=new BABYLON.StandardMaterial("transparentGround",e.t);w.diffuseColor=new BABYLON.Color3(1,1,1);w.specularColor=new BABYLON.Color3(0,0,0);w.emissiveColor=new BABYLON.Color3(0,0,0);w.alpha=e.i;e.A.H.material=w}else console.log("Warning: Vars.vrVars.groundMesh not defined.");B.e();y()})})}function F(y,w){if(void 0!==y.material&&null!==y.material){var d=t.a();void 0===d.oa?(d=d.pa,d=.95<d?.05:.4>d?.0025:.013636363636363637*d-.0029545454545454545):d=d.oa;y.material.emissiveColor=
new BABYLON.Color3(d,d,d);B.a(y)}y.scaling.z=-1;0<w&&(y.scaling.x=-1);t.d&&t.d.getShadowMap().renderList.push(y);g.b(y)}a.d(b,"a",function(){return x});a.d(b,"b",function(){return F});var B=a("0fSa"),e=a("gqHH"),q=a("qmVJ"),t=a("sqbB"),g=a("TqLJ"),v=a("VNi4")},ejGh:function(G,b,a){function x(){e=B.t.activeCamera;e.keysUp=[87,38];e.keysDown=[83,40];e.keysLeft=[65,37];e.keysRight=[68,39];B.t.gravity=new BABYLON.Vector3(0,-.1,0);e.applyGravity=!0;F();B.t.collisionsEnabled=!0;e.checkCollisions=!0;e.speed=
.1;e.attachControl(B.p,!0);e._updatePosition()}function F(){e.ellipsoid=new BABYLON.Vector3(1,.5*B.o,1)}a.d(b,"a",function(){return e});a.d(b,"c",function(){return x});a.d(b,"b",function(){return F});var B=a("gqHH"),e},fRJN:function(G,b,a){(function(x){function F(){B()}function B(){function w(u){x("#"+u.id).click(function(){u.D()})}for(var d=[{Z:'<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n                    width="48px" height="48px" viewBox="0 0 48 48" enable-background="new 0 0 48 48" xml:space="preserve">\n                    <g>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linejoin="round" d="M41.99,17.573v-5.209\n                            c0-0.588-0.717-1.092-1.615-1.092H25.123V8.92c0-0.336-0.449-0.672-0.987-0.672H1.077C0.449,8.248,0,8.583,0,8.92v3.444\n                            c0,0,0,0,0,0.084v25.877c0,0.588,0.717,1.092,1.615,1.092h38.671"/>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linejoin="round" d="M7.985,17.573h38.67\n                            c0.898,0,1.526,0.504,1.347,1.008l-5.295,19.744c-0.089,0.588-0.985,1.092-1.884,1.092H2.064c-0.898,0-1.526-0.504-1.347-1.008\n                            l5.294-19.744C6.19,18.077,7.088,17.573,7.985,17.573L7.985,17.573"/>\n                    </g>\n                    </svg>',
title:"Open Molecule",id:"open-button",Y:!1,D:function(){window.PVR_warning=!0;q.b({title:"Load Molecule",content:"pages/load.html"})}},{Z:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                      x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                      <g>\n                          <path id="rect9967" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M17.678,35.173h27.476\n                              c1.434,0,2.598,1.136,2.598,2.539l0,0c0,1.4-1.164,2.538-2.598,2.538H17.678c-1.434,0-2.596-1.138-2.596-2.538l0,0\n                              C15.082,36.309,16.244,35.173,17.678,35.173z"/>\n                          <path id="rect9969" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M8.676,35.013H2.743\n                              c-1.434,0-2.597,1.176-2.597,2.62l0,0c0,1.441,1.163,2.617,2.597,2.617h5.933c1.435,0,2.598-1.176,2.598-2.617l0,0\n                              C11.274,36.188,10.11,35.013,8.676,35.013z"/>\n                          <path id="svg_60" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M17.533,26.506H45.01\n                              c1.434,0,2.597,1.134,2.597,2.538l0,0c0,1.406-1.163,2.542-2.597,2.542H17.533c-1.434,0-2.597-1.136-2.597-2.542l0,0\n                              C14.936,27.64,16.099,26.506,17.533,26.506z"/>\n                          <path id="svg_61" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M8.529,26.349H2.596\n                              C1.162,26.349,0,27.52,0,28.966l0,0c0,1.445,1.162,2.62,2.596,2.62h5.933c1.434,0,2.598-1.175,2.598-2.62l0,0\n                              C11.127,27.52,9.963,26.349,8.529,26.349z"/>\n                          <path id="svg_63" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M17.533,17.049H45.01\n                              c1.434,0,2.597,1.138,2.597,2.537l0,0c0,1.405-1.163,2.54-2.597,2.54H17.533c-1.434,0-2.597-1.135-2.597-2.54l0,0\n                              C14.936,18.187,16.099,17.049,17.533,17.049z"/>\n                          <path id="svg_64" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M8.529,16.891H2.596\n                              C1.162,16.891,0,18.059,0,19.507l0,0c0,1.45,1.162,2.625,2.596,2.625h5.933c1.434,0,2.598-1.175,2.598-2.625l0,0\n                              C11.127,18.059,9.963,16.891,8.529,16.891z"/>\n                          <path id="svg_66" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M17.793,8.605h27.476\n                              c1.435,0,2.598,1.136,2.598,2.54l0,0c0,1.402-1.163,2.54-2.598,2.54H17.793c-1.435,0-2.597-1.138-2.597-2.54l0,0\n                              C15.196,9.742,16.358,8.605,17.793,8.605z"/>\n                          <path id="svg_67" fill="none" stroke="#FFFFFF" stroke-width="1.75" stroke-miterlimit="10" d="M8.789,8.447H2.855\n                              c-1.434,0-2.597,1.172-2.597,2.619l0,0c0,1.447,1.163,2.622,2.597,2.622h5.933c1.435,0,2.598-1.175,2.598-2.622l0,0\n                              C11.387,9.619,10.224,8.447,8.789,8.447z"/>\n                      </g>\n                 </svg>\n       ',
title:"Menu",id:"menu-button",Y:!1,D:function(){y.a()}},{Z:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n                    x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="\n                            M35.5,9.8c1.7,5.4-0.6,8-1.6,8.9c-1.9,1.9-4.5,4.7-5.8,7c-1.5,2.7-4.1,12-6.8,4.4c-3.2-9.1,1.3-11.6,3.5-13.4\n                            c1.5-1.3,3.4-4.3,0.5-5.3c-4-1.3-6.1,5.3-10.7,4c-3-0.8-3.2-4.1-2.2-6.6C15.4,1.7,32.5,0.6,35.5,9.8L35.5,9.8z"/>\n                        <path fill="none" stroke="#FFFFFF" stroke-width="2" stroke-miterlimit="10" d="M28.3,39.6c0-5.5-8.5-5.5-8.5,0S28.3,45.1,28.3,39.6"/>\n                  </svg>',
title:"Help",id:"help-button",Y:!1,D:function(){q.b({title:"Help: ProteinVR "+t.k,content:"pages/help.html",J:!0,I:!0})}},{Z:'<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n             \t    x="0px" y="0px" width="48px" height="48px" viewBox="0 0 48 48" xml:space="preserve">\n                    <path fill="none" stroke="#FFFFFF" stroke-width="1.5" d="M35.4,4.6c-3.2,0-5.8,2.4-5.8,5.8l0,0c0,0.5,0.2,1.1,0.5,1.4l-13.4,7.8\n             \t    c-1-1.4-2.6-1.8-4.1-1.8c-3.2,0-5.8,2.4-5.8,5.8l0,0c0,2.9,2.6,5.8,5.8,5.8l0,0c1.3,0,2.2-0.5,3.2-1.4l13.6,8.3\n             \t    c-0.3,0.4-0.3,0.9-0.3,1.4c0,3.4,2.7,5.8,5.9,5.8l0,0c3.2,0,5.6-2.4,5.6-5.8l0,0c0-2.9-2.4-5.9-5.6-5.9l0,0c-1.7,0-3.2,1.1-4.4,2\n             \t    l-13.1-7.3c0.5-0.9,0.7-2,0.7-2.9c0-0.5,0-1.4-0.2-2l13.3-7.3c1,0.9,2.5,1.5,4.1,1.5c3.2,0,5.9-2.5,5.9-5.4l0,0\n             \t    C41.3,6.9,38.5,4.6,35.4,4.6L35.4,4.6L35.4,4.6z"/>\n                 </svg>',
title:"Share (Leader)",id:"leader",Y:!1,D:function(){g.e()}},{Z:'<svg style="position:relative; left:0.5px;" width="48px" height="48px" xmlns="http://www.w3.org/2000/svg"\n                    xmlns:svg="http://www.w3.org/2000/svg" clip-rule="evenodd">\n                    <g class="layer">\n                        <path d="m47.799999,43.649999l-47.699999,0l0,-39.749999l47.699999,0l0,39.749999zm-1.9875,-37.762499l-43.724999,0l0,35.774999l43.724999,0l0,-35.774999zm-7.95,13.9125l-1.9875,0l0,-6.441487l-22.341487,22.341487l6.441487,0l0,1.9875l-9.9375,0l0,-9.9375l1.9875,0l0,6.441487l22.341487,-22.341487l-6.441487,0l0,-1.9875l9.9375,0l0,9.9375z" fill="#ffffff" id="svg_1"/>\n                    </g>\n                  </svg>',
title:"Full Screen",id:"fullscreen-button",Y:!0,D:function(){t.r.switchFullscreen(!0);x("#renderCanvas").focus()}}],l="",f=60,m=0,c=d.reverse();m<c.length;m++){var h=c[m];v.b()&&!0!==h.Y||(l+='\n                <button\n                    title="'+h.title+'"\n                    id="'+h.id+'"\n                    class="ui-button"\n                    style="color:white;\n                        width:80px;\n                        height:50px;\n                        right:5px;\n                        position:absolute;\n                        bottom:'+
f.toString()+'px;\n                        background-color:rgba(51,51,51,0.7);\n                        border:none;\n                        outline:none;\n                        cursor:pointer;">\n                        '+h.Z+"\n                </button>",f+=55)}h=x(".babylonVRicon");0!==h.length?h.closest("div").wrap('<div id="btnsWrapper"></div>'):x("body").append('<div id="btnsWrapper"></div>');var r=x("#btnsWrapper");r.css("height",f.toString()+"px");x(r).append(l);window.addEventListener("resize",
function(){e(r,f)});e(r,f);for(l=0;l<d.length;l++)h=d[l],w(h);d=document.getElementById("babylonVRiconbtn");null!==d&&(d.style.opacity="1.0",d.style.filter="alpha(opacity=1.0)")}function e(w,d){var l=1;window.innerHeight<d&&(l=window.innerHeight/d);w.css("transform","scale("+l.toString()+")")}a.d(b,"a",function(){return F});var q=a("iC5T"),t=a("gqHH"),g=a("mvtX"),v=a("p11u"),y=a("Vusd")}).call(this,a("EVdn"))},fcUb:function(G,b,a){(function(x){function F(){m.a("SceneLoaded",["DeviceOrientationAuthorizedIfNeeded"],
function(r){l.y();d.b();B();q();f.d();g.a();w.b();c.i();h.a();y.a();t();window.addEventListener("resize",function(){l.r.resize()});r()})}function B(){var r=BABYLON.Mesh.CreateSphere("navTargetMesh",4,.1,l.t),u=new BABYLON.StandardMaterial("navTargetMeshMaterial",l.t);u.emissiveColor=new BABYLON.Color3(.1,.1,.1);u.diffuseColor=new BABYLON.Color3(.8,.8,.8);r.material=u;r.renderingGroupId=2;e(u);l.s({V:r});v.b()}function e(r){var u=new BABYLON.Color3(.2,.2,.2),D=new BABYLON.Color3(.8,.8,.8);setInterval(function(){r.diffuseColor=
.2===r.diffuseColor.r?D:u},1E3)}function q(){m.a("LoadBabylonScene",["InitVR"],function(r){d.a("Loading the main scene...");BABYLON.SceneLoader.LoadAssetContainer(l.v,"scene.babylon",l.t,function(u){d.c(90);l.t.executeWhenReady(function(){x.getJSON(l.v+"scene_info.json",function(D){!1===D.menuActive&&(l.A.ta=!1);void 0!==D.positionOnFloor&&(l.u.va=D.positionOnFloor);void 0!==D.infiniteDistanceSkyBox&&(l.u.ra=D.infiniteDistanceSkyBox);void 0!==D.transparentGround&&(l.u.xa=D.transparentGround);u.addAllToScene();
r()})})},function(u){u.lengthComputable&&d.a("Loading the main scene... "+Math.round(90*u.loaded/u.total).toString()+"%")})})}function t(){m.a("FinalizeScene",["LoadBabylonScene","LoadMolecule"],function(r){setTimeout(f.e,1E3);d.d();l.t.activeCamera.maxZ=250;l.t.activeCamera.minZ=0;l.r.runRenderLoop(function(){l.t.render()});r()})}a.d(b,"a",function(){return F});var g=a("1RHl"),v=a("nV79"),y=a("cw8d"),w=a("9bcR"),d=a("Rr3C"),l=a("gqHH"),f=a("0fSa"),m=a("VNi4"),c=a("TqLJ"),h=a("tMjE")}).call(this,
a("EVdn"))},gg4m:function(G,b,a){function x(t){void 0===t&&(t="");var g="<p>ProteinVR has encountered an error while running in leader mode. ";B.b({title:"Leader Error",content:""!==t?g+" Here are the details:</p><p><pre>"+(t+"</pre></p>"):g+"</p>",J:!1})}function F(){x("Leader connection destroyed. Please refresh.")}a.d(b,"a",function(){return e});a.d(b,"b",function(){return q});a.d(b,"c",function(){return x});a.d(b,"d",function(){return F});var B=a("iC5T"),e=!1,q=function(){function t(){this.F=
this.R=null;this.Da();this.Ia()}t.prototype.Da=function(){var g="act add age ago aid aim air all and any arm art ask bag ban bar bed bet big bit box bus but buy can cap car cat ceo cow cry cup day dig dna rna dog dry due ear eat egg end era etc eye fan far fee few fit fix fly for fun gap get guy hat hey hip hit hot how ice its jet job joy key kid lab law lay let lie lot low map may mix net new nod nor not now nut odd off oil old one our out owe own pan pay per pet pie pop put raw red rid row run say sea see set sit six ski sky sue sun tap tax ten the toe too top toy try two use via war way wet who why win yes yet you".split(" "),
v="pvr"+this.wa();v+=g[Math.floor(Math.random()*g.length)]+this.wa();v=v.replace(/\./g,"");this.F=new Peer(v,{debug:2,config:{iceServers:[{urls:"stun:0.peerjs.com"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:durrantlab.com/apps/protein-vr/stun"}]}})};t.prototype.Ia=function(){var g=this;this.F.on("disconnected",function(){F();!0===e&&console.log("Connection lost. Please reconnect");g.F.id=g.R;g.F.Ja=g.R;g.F.Na()});this.F.on("error",function(v){x(v)})};t.prototype.wa=function(){return Math.random().toString().replace(/\./g,
"").replace(/0/g,"").slice(0,3)};return t}()},gqHH:function(G,b,a){function x(r){f=r}function F(){y=document.getElementById("renderCanvas");w=new BABYLON.Engine(y,!0);BABYLON.Database.IDBStorageEnabled=!0;d=new BABYLON.Scene(w);window.scene=d}function B(){if(void 0===c){var r=new BABYLON.Ray(d.activeCamera.position,new BABYLON.Vector3(0,-1,0),50);c=d.pickWithRay(r,function(u){return"ground"===u.name}).distance}}function e(r){c=r}function q(r){g.a("InitVR",[],function(u){h=r;if(t.b())u();else{var D=
{disableTeleportation:!0,ignoreNativeCameraTransformation:!1,createDefaultXRExperienceAsync:{canvasElement:y,canvasOptions:{framebufferScaleFactor:1,antialias:!0}}};BABYLON.WebXRMotionControllerManager.BaseRepositoryUrl="js/";window.engine=w;d.createDefaultXRExperienceAsync(D).then(function(p){l=p;window.vrHelper=l;l.baseExperience.sessionManager.onXRSessionInit.add(function(){if(!1===window.webXRPolyfill.nativeWebXR){var C=Math.min(window.innerWidth/2880,window.innerHeight/1600);1>C&&t.a()&&w.setHardwareScalingLevel(C);
console.log("Using WebXR polyfill.")}});p=document.getElementById("babylonVRiconbtn");null!==p&&(p.style.opacity="0.0",p.style.filter="alpha(opacity=0)");h.ta=!0;u();return Promise.resolve()})}})}a.d(b,"k",function(){return v});a.d(b,"p",function(){return y});a.d(b,"r",function(){return w});a.d(b,"t",function(){return d});a.d(b,"z",function(){return l});a.d(b,"v",function(){return f});a.d(b,"x",function(){return x});a.d(b,"u",function(){return m});a.d(b,"o",function(){return c});a.d(b,"j",function(){return 11});
a.d(b,"b",function(){return 1.5});a.d(b,"g",function(){return 1});a.d(b,"d",function(){return 2E3});a.d(b,"a",function(){return 1.2});a.d(b,"f",function(){return 2.5});a.d(b,"e",function(){return.05});a.d(b,"h",function(){return.01});a.d(b,"n",function(){return 500});a.d(b,"m",function(){return 750});a.d(b,"l",function(){return.5});a.d(b,"c",function(){return 15});a.d(b,"i",function(){return.05});a.d(b,"A",function(){return h});a.d(b,"y",function(){return F});a.d(b,"q",function(){return B});a.d(b,
"w",function(){return e});a.d(b,"s",function(){return q});var t=a("p11u"),g=a("VNi4"),v="1.0.4",y,w,d,l,f="environs/day/",m={va:!1,ra:!0,xa:!1},c,h={}},iC5T:function(G,b,a){(function(x){function F(c){c.J=void 0===c.J?!0:c.J;c.I=void 0===c.I?void 0:c.I;c.U=void 0===c.U?!1:c.U;c.ha=void 0===c.ha?!0:c.ha;c.fa=void 0===c.fa?!1:c.fa;c.W=void 0===c.W?void 0:c.W;c.ca=void 0===c.ca?"Close":c.ca;return c}function B(c){c=F(c);l=c.ha;m=c.fa;return new Promise(function(h){f=h;q?e(c):(q=!0,document.head.insertAdjacentHTML("beforeend",
"<link rel=stylesheet href=pages/css/bootstrap.min.css>"),document.body.insertAdjacentHTML("beforeend",'\n                \x3c!-- The Modal --\x3e\n                <div class="modal fade" id="msgModal" role="dialog">\n                    <div class="modal-dialog" role="document">\n                        <div class="modal-content">\n\n                        \x3c!-- Modal Header --\x3e\n                        <div class="modal-header">\n                            <h4 class="modal-title">Modal Heading</h4>\n                            <button id="modal-close-button" type="button" class="close" data-dismiss="modal">&times;</button>\n                        </div>\n\n                        \x3c!-- Modal body --\x3e\n                        <div class="modal-body">\n                            \x3c!-- <div id="iframe-container" style="height:350px;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch">\n                                <iframe frameBorder="0" src="" style="width:100%;height:100%;"></iframe>\n                            </div> --\x3e\n                            <span id="msg-container"></span>\n                        </div>\n\n                        \x3c!-- Modal footer --\x3e\n                        <div id="modal-footer" class="modal-footer">\n                            <button type="button" class="btn btn-primary modal-close-btn" data-dismiss="modal">'+
c.ca+'</button>\n                        </div>\n                    </div>\n                </div>\n                <link rel="stylesheet" type="text/css" href="pages/css/style.css">\n            '),e(c))})}function e(c){void 0===t&&(t=x("#msgModal"),v=t.find(".modal-dialog"),g=t.find("h4.modal-title"),y=t.find("#msg-container"),w=t.find("#modal-footer"),t.on("hidden.bs.modal",function(){d=!1}),x(".modal-header").on("mousedown",function(r){var u=x(this),D=r.pageX-u.offset().left,p=r.pageY-u.offset().top;
x("body").on("mousemove.draggable",function(C){u.closest(".modal-dialog").offset({left:C.pageX-D,top:C.pageY-p})});x("body").one("mouseup",function(){x("body").off("mousemove.draggable")});u.closest(".modal").one("bs.modal.hide",function(){x("body").off("mousemove.draggable")})}),t.on("shown.bs.modal",function(){d=!0;f()}));y.html("");g.html(c.title);if(!0===c.J){void 0===c.I&&w.hide();y.css("text-align","initial");var h=new XMLHttpRequest;h.onreadystatechange=function(){4===this.readyState&&200===
this.status&&(y.html(this.responseText),setTimeout(function(){var r=document.createElement("script");r.src=c.content.replace(".html",".html.js");document.head.appendChild(r)},0))};h.open("GET",c.content,!0);h.send()}else y.css("text-align","center"),y.html(c.content),void 0===c.I&&w.show();!0===c.I?w.show():!1===c.I&&w.hide();h={};!0===c.U&&(x("#modal-close-button").hide(),t.on("shown.bs.modal",function(){x(".modal-backdrop.show").css("opacity",1)}),h={backdrop:"static",keyboard:!1});t.modal(h);void 0!==
c.W&&(h=x(".modal-close-btn"),h.unbind("click"),h.click(function(){c.W()}));h=x(".modal-backdrop");!0===l?h.css("background-color","rgb(0,0,0)"):h.css("background-color","transparent");!0===m?v.addClass("skinny-modal"):v.removeClass("skinny-modal")}a.d(b,"a",function(){return d});a.d(b,"b",function(){return B});var q=!1,t,g,v,y,w,d=!1,l=!0,f,m=!1}).call(this,a("EVdn"))},jIpr:function(G,b,a){function x(){C=[];H=[];u={Styles:h.a(),Rotate:c.b()};void 0===E&&(E=new BABYLON.GUI.GUI3DManager(d.t));v();
e();I=new BABYLON.TransformNode("");F();void 0===p&&t();void 0===D&&(D=new BABYLON.Sound("click-button",r.na,d.t,null,{loop:!1,autoplay:!1,Oa:!0,volume:.1}))}function F(){function k(A){A=A.toString();C.push(new m({D:function(){},default:!1,T:A,sa:function(K){K.isVisible(!1)},level:1,name:"menu-visible-button-"+A,ua:n,$:A,color:"yellow"}))}var n=new BABYLON.GUI.SpherePanel;n.radius=d.f;n.margin=d.e;E.addControl(n);n.blockLayout=!0;for(var z=0;16>z;z++)k(z);n.columns=4;n.linkToTransformNode(I);n.blockLayout=
!1}function B(k){function n(z,A){k(z,A);for(var K=Object.keys(z),J=K.length,L=0;L<J;L++){var O=K[L],N=z[O];switch(typeof N){case "object":n(N,A.concat([O]))}}}n(u,[])}function e(){B(function(k,n){q(k,n)})}function q(k,n){0<n.length&&(k["Back \u21e6"]=function(){g(n.slice(0,n.length-1))});k["Close Menu \u00d7"]=function(){p.ka()}}function t(){var k=new BABYLON.GUI.StackPanel3D;E.addControl(k);p=new m({D:function(z){z.value?g([]):g(void 0);I.position.copyFrom(y.a());I.rotation.y=y.c()},default:!1,T:"Show Menu",
level:0,name:"menu-visible-button",ua:k,$:"Hide Menu"});p.button.position.y=.75;p.button.position.z=.75;var n=new BABYLON.TransformNode("");k.linkToTransformNode(n);n.rotation.x=.5*Math.PI;n.position.copyFrom(w.b);n.position.y+=.1;n.rotation.y=y.c();n.rotation.x=.4*Math.PI;d.t.registerBeforeRender(function(){n.position.copyFrom(w.b);n.position.y+=.1;n.rotation.y=y.c()})}function g(k){void 0!==k&&0<k.length&&(H=k,void 0===u.Last&&(u.Last=function(){console.log("Going to",H);g(H)}));for(var n=C.length,
z=0;z<n;z++)C[z].isVisible(!1);if(void 0!==k){var A=u;n=k.length;for(z=0;z<n;z++)A=A[k[z]];var K=Object.keys(A),J=["Close Menu \u00d7","Exit VR \u00d7"],L=["Back \u21e6"],O=J.concat(L);K.sort(function(M,P){var R=-1!==O.indexOf(M),S=-1!==O.indexOf(P);return R&&!S?1:!R&&S?-1:M.localeCompare(P)});var N=[];N=4>=K.length?[7,6,5,4]:8>=K.length?[7,6,5,4,11,10,9,8]:12>=K.length?[3,2,1,0,7,6,5,4,11,10,9,8]:[3,2,1,0,7,6,5,4,11,10,9,8,15,14,13,12];n=K.length;var Q=function(M){var P=K[M],R=A[P];M=C[N[M]];M.la(P);
switch(typeof R){case "object":M.D=function(){g(k.concat(P))};M.aa("green");break;case "function":M.D=R,M.aa("default")}-1!==J.indexOf(P)?M.aa("red"):-1!==L.indexOf(P)&&M.aa("yellow");M.isVisible(!0)};for(z=0;z<n;z++)Q(z)}}function v(){function k(n,z){var A=Object.keys(n);if(1===A.length){A=A[0];var K=z[z.length-1],J=K+": "+A;z=z.slice(0,z.length-1).concat([J]);n=u;for(var L=z.slice(0,z.length-1),O=L.length,N=0;N<O;N++)n=n[L[N]];n[J]=n[K][A];delete n[K];n=n[J];A=Object.keys(n)}K=A.length;for(N=0;N<
K;N++)switch(J=A[N],L=n[J],typeof L){case "object":k(L,z.concat([J]))}}k(u,[])}var y=a("vCcv"),w=a("ph2Y"),d=a("gqHH"),l=a("TqLJ"),f=new BABYLON.Vector3(.75,.75,.75),m=function(){function k(n){var z=this;this.button=new BABYLON.GUI.HolographicButton(n.name);n.ua.addControl(this.button);this.ba();void 0!==n.color&&this.aa(n.color);this.level=n.level;this.B=new BABYLON.GUI.TextBlock;this.B.color="white";this.B.B=!0;this.value=n.default;this.$=n.$;this.T=n.T;this.D=n.D;this.la();this.button.scaling=
f.clone();this.L=BABYLON.Mesh.CreateSphere(n.name+"-container-mesh",2,d.a,d.t);this.L.position=this.button.node.absolutePosition;this.L.visibility=0;this.L.scaling=f.clone();this.L.D=function(){z.ka()};l.a(this.L);void 0!==n.sa&&n.sa(this)}k.prototype.aa=function(n){switch(n){case "default":this.button.mesh.material=this.G;break;case void 0:this.button.mesh.material=this.G;break;case "green":this.button.mesh.material=this.K;break;case "yellow":this.button.mesh.material=this.N;break;case "red":this.button.mesh.material=
this.M}};k.prototype.isVisible=function(n){if(void 0===n)return this.button.isVisible;this.button.isVisible=n;this.L.isVisible=n};k.prototype.ka=function(){D.setPosition(this.L.position.clone());D.play();this.value=!this.value;this.D(this);this.la()};k.prototype.la=function(n){void 0===n?this.B.text=this.value?this.$:this.T:this.T=this.$=this.B.text=n;this.B.text=this.wrap(this.B.text,25);this.button.content.dispose();this.button.content=this.B};k.prototype.wrap=function(n,z){return n.replace(new RegExp("(?![^\\n]{1,"+
z+"}$)([^\\n]{1,"+z+"})\\s","g"),"$1\n")};k.prototype.ba=function(){this.G=this.button.mesh.material;this.K=this.button.mesh.material.clone();this.K.albedoColor=new BABYLON.Color3(.3,.35+.1,.4);this.N=this.button.mesh.material.clone();this.N.albedoColor=new BABYLON.Color3(.4,.35+.1,.4);this.M=this.button.mesh.material.clone();this.M.albedoColor=new BABYLON.Color3(.4,.35,.4)};return k}(),c=a("nKXq"),h=a("BjG7");G=a("O2BG");var r=a.n(G);a.d(b,"b",function(){return u});a.d(b,"a",function(){return D});
a.d(b,"c",function(){return p});a.d(b,"d",function(){return x});a.d(b,"e",function(){return q});var u,D=void 0,p,C,H,E,I},mvtX:function(G,b,a){function x(){y=!0;w=new d;w.qa.then(function(l){window.PVR_webRTCID=l;t.b({title:"Leader",content:"pages/leader.html",J:!0,I:!0})});setInterval(function(){var l=q.a(),f=q.b();w.X({type:"locrot",val:[l.x,l.y,l.z,1*f.x,1*f.y,1*f.z,1*f.w]})},100);setInterval(function(){w.X({type:"initialUrl",val:window.location.href})},2E3)}function F(l,f,m){w.X({type:"toggleRep",
val:{filters:l,repName:f,colorScheme:m}})}function B(l){w.X({type:"molAxisRotation",val:l})}function e(){w.X({type:"molUndoRot",val:void 0})}a.d(b,"a",function(){return y});a.d(b,"e",function(){return x});a.d(b,"b",function(){return F});a.d(b,"d",function(){return B});a.d(b,"c",function(){return e});var q=a("vCcv"),t=a("iC5T"),g=a("gg4m"),v=function(){function l(f,m){l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,h){c.__proto__=h}||function(c,h){for(var r in h)h.hasOwnProperty(r)&&
(c[r]=h[r])};return l(f,m)}return function(f,m){function c(){this.constructor=f}l(f,m);f.prototype=null===m?Object.create(m):(c.prototype=m.prototype,new c)}}(),y=!1,w,d=function(l){function f(){var m=l.call(this)||this;m.qa=null;m.Fa=null;m.S=[];var c;m.Fa=new Promise(function(h){c=h});m.qa=new Promise(function(h){m.ja(h,c)});return m}v(f,l);f.prototype.X=function(m){!0===g.a&&console.log("Send:",m);for(var c=this.S.length,h=0;h<c;h++)this.S[h].send(m)};f.prototype.ja=function(m,c){var h=this;this.F.on("open",
function(){null===h.F.id?(g.c("Received null id from peer open."),h.F.id=h.R):h.R=h.F.id;m(h.R);!0===g.a&&console.log(h.R)});this.F.on("connection",function(r){h.S.push(r);c();!0===g.a&&console.log("Lecturer: added a connection")});this.F.on("close",function(){for(var r=h.S.length,u=0;u<r;u++)h.S[u]=null;g.d()})};return f}(g.b)},nKXq:function(G,b,a){function x(){return{"Undo Rotate":function(){B()},"X Axis":function(){F("x")},"Y Axis":function(){F("y")},"Z Axis":function(){F("z")}}}function F(v){q.i(v,
15*Math.PI/180);e.b(void 0,t.t.getMeshByName("protein_box"),!0);g.a&&g.d(v)}function B(){var v=e.a;q.f(v.x,v.y,v.z);e.b(void 0,t.t.getMeshByName("protein_box"),!0);g.a&&g.c()}a.d(b,"b",function(){return x});a.d(b,"a",function(){return F});a.d(b,"c",function(){return B});var e=a("YORc"),q=a("PjGz"),t=a("gqHH"),g=a("mvtX")},nV79:function(G,b,a){(function(x){function F(){d.a("SetupVRListeners",["InitVR"],function(c){y.b()||void 0===g.z.baseExperience||(e(),v.a(),setInterval(function(){var h=(new Date).getTime();
void 0===m&&(m=h);2E3<h-m&&B();m=h},1E3));c()})}function B(){void 0!==g.z&&(g.z.baseExperience.state===BABYLON.WebXRState.IN_XR&&g.z.baseExperience.exitXRAsync(),g.t.getEngine().exitFullscreen())}function e(){g.z.baseExperience.onStateChangedObservable.add(function(c){switch(c){case BABYLON.WebXRState.ENTERING_XR:y.d(!1);break;case BABYLON.WebXRState.IN_XR:y.d(!0);g.z.baseExperience.camera.position=f.a.position.clone();g.r.resize();g.A.C=2;l.h();q.j(void 0);t.e();x(".ui-button").hide();w.b["Exit VR \u00d7"]=
function(){B()};break;case BABYLON.WebXRState.EXITING_XR:y.d(!0);break;case BABYLON.WebXRState.NOT_IN_XR:y.d(!0),g.r.resize(),g.A.C=3,q.j(void 0),t.e(),l.h(),x(".ui-button").show(),x(".babylonVRicon").show(),delete w.b["Exit VR \u00d7"]}})}a.d(b,"b",function(){return F});a.d(b,"a",function(){return B});var q=a("TqLJ"),t=a("0fSa"),g=a("gqHH"),v=a("pAUf"),y=a("p11u"),w=a("jIpr"),d=a("VNi4"),l=a("ph2Y"),f=a("ejGh"),m}).call(this,a("EVdn"))},p11u:function(G,b,a){(function(x){function F(k){I=k}function B(k){return(Math.round(1E5*
k)/1E5).toString()}function e(){if(!1!==I){var k=[],n=c.c.x;0!==n&&k.push("rx="+B(n));n=c.c.y;0!==n&&k.push("ry="+B(n));n=c.c.z;0!==n&&k.push("rz="+B(n));k.push("s="+f.b);void 0!==p&&(console.log("setting webrtc..."),k.push("f="+p));n=0;for(var z=[],A=Object.keys(m.a),K=A.length,J=0;J<K;J++){var L=A[J];m.a[L].mesh.isVisible&&(z.push("st"+n.toString()+"="+L),n++)}k=k.concat(z);n=u.a();z=u.b();k.push("cx="+B(n.x));k.push("cy="+B(n.y));k.push("cz="+B(n.z));k.push("crx="+B(z.x));k.push("cry="+B(z.y));
k.push("crz="+B(z.z));k.push("crw="+B(z.w));k.push("e="+r.v);void 0===C&&(C=!1);k.push("sh="+C.toString());void 0===H&&(H=!0);k.push("hs="+H.toString());window.history.pushState({},document.title,window.location.href.split("?")[0]+"?"+k.join("&"))}}function q(){var k=window.location.href,n=k?k.split("?")[1]:window.location.search.slice(1);k={};if(n){n=n.split("#")[0];n=n.split("&");for(var z=n.length,A=0;A<z;A++){var K=n[A].split("=");k[K[0]]=void 0===K[1]?!0:K[1]}}E=k;k=E.e;void 0!==k&&r.x(k)}function t(){p=
E.f;if(void 0!==p){h.a(p);r.t.activeCamera.inputs.clear();x("#help-button").hide();x("#leader").hide();x("#babylonVRiconbtn").hide();x("#open-button").hide();var k=x("#fullscreen-button"),n=k.css("bottom");void 0!==n&&(n=+n.replace(/px/g,""),k.css("bottom",(n-60).toString()+"px"));x("#capture-clicks").remove();var z=x("#followerModeWarning");z.fadeIn(500);setTimeout(function(){z.fadeOut(500)},8E3)}k=E.rx;n=E.ry;var A=E.rz;c.f(void 0===k?0:+k,void 0===n?0:+n,void 0===A?0:+A);k=E.s;void 0!==k&&""!==
k&&(4===k.length&&-1===k.indexOf(".")&&(k="https://files.rcsb.org/view/"+k.toUpperCase()+".pdb"),f.c(k));k=Object.keys(E);n=k.length;for(A=0;A<n;A++){var K=k[A];"st"===K.slice(0,2)&&(K=g(E[K]),D.push(K))}0===D.length&&(D.push([["Protein","All"],"Cartoon","Spectrum"]),D.push([["Nucleic","All"],"Stick","Element"]),D.push([["Ligand","All"],"Stick","Element"]));k=E.cx;n=E.cy;A=E.cz;void 0!==k&&void 0!==n&&void 0!==A&&u.e(new BABYLON.Vector3(+k,+n,+A));k=E.crx;n=E.cry;A=E.crz;K=E.crw;void 0!==k&&void 0!==
n&&void 0!==A&&void 0!==K&&u.f(new BABYLON.Quaternion(+k,+n,+A,+K));C=E.sh;H=E.hs;l()}function g(k){k=k.split("--");var n=decodeURIComponent(k[k.length-2]),z=decodeURIComponent(k[k.length-1]);return[k.slice(0,k.length-2).map(function(A){A=decodeURIComponent(A);"{"===A.charAt(0)&&(A=JSON.parse(A));return A}),n,z]}function v(){if(0<D.length){var k=D.pop();m.b(k[0],k[1],k[2],function(){v()})}}function y(){return-1!==window.location.href.indexOf("f=")}function w(){return-1!==window.location.href.indexOf("sh=t")}
function d(){return-1!==window.location.href.indexOf("hs=t")}function l(){setInterval(function(){"block"!==x("#msgModal").css("display")&&e()},1E3)}a.d(b,"d",function(){return F});a.d(b,"h",function(){return e});a.d(b,"f",function(){return q});a.d(b,"g",function(){return t});a.d(b,"e",function(){return g});a.d(b,"i",function(){return v});a.d(b,"b",function(){return y});a.d(b,"c",function(){return w});a.d(b,"a",function(){return d});var f=a("qmVJ"),m=a("EYe7"),c=a("PjGz"),h=a("uBLq"),r=a("gqHH"),u=
a("vCcv"),D=[],p=void 0,C=!1,H=!0,E,I=!0}).call(this,a("EVdn"))},pAUf:function(G,b,a){function x(){d.z.input.onControllerAddedObservable.add(function(p){p.onMeshLoadedObservable.add(function(C){C=[C];for(var H=0;H<C.length;){var E=C[H];if(E.material&&E.material.albedoTexture){var I=new BABYLON.StandardMaterial(E.name+"Material",d.t);I.diffuseTexture=E.material.albedoTexture;E.material=I}C=C.concat(E.getChildren());H++}});p.onMotionControllerInitObservable.add(function(C){u[B(C.handness)]=p;g(C);y.g();
d.A.C=1;q(C);t(C)});F()})}function F(){d.z.input.onControllerAddedObservable.add(function(){d.z.baseExperience.sessionManager.session.onselect=function(p){-1!==p.inputSource.targetRayMode.toUpperCase().indexOf("GAZE")&&v.a()}})}function B(p){switch(p){case "left":return"left";case "right":return"right";default:return"other"}}function e(p,C){p=p.map(function(E){return E.toUpperCase()});var H=C.getComponentIds().filter(function(E){for(var I=p.length,k=0;k<I;k++)if(-1!==E.toUpperCase().indexOf(p[k]))return!0;
return!1});H=H.sort().filter(function(E,I,k){return 0===I||E!==k[I-1]});H=H.map(function(E){return C.getComponent(E)});0===H.length&&console.log("WARNING: No controller components matched keyword(s). Keywords: "+p.join(" ")+". Components detected: "+C.getComponentIds().join(" "));return H}function q(p){for(var C=e(["TRIGGER","BUTTON","SQUEEZE"],p),H=C.length,E=0;E<H;E++)C[E].onButtonStateChangedObservable.add(function(I){I.changes.pressed&&I.pressed&&!g(p)&&(I=(new Date).getTime(),I-f>d.n&&(f=I,v.a()))})}
function t(p){for(var C=e(["PAD","STICK"],p),H=C.length,E=0;E<H;E++){var I=C[E];I.onAxisValueChangedObservable.add(function(k){g(p)||Math.abs(k.x)>d.l&&Math.abs(k.y)<d.l||(c=3*k.y,r=!0)});I.onButtonStateChangedObservable.add(function(k){!g(p)&&k.changes.pressed&&k.pressed&&(h=k.axes.x,h+=0<h?-.5:.5,h=2*h,r=!0)})}d.t.registerBeforeRender(function(){if(r){if(!w.a.equals(w.e)){var k=l.a(),n=w.a.subtract(k);n.normalize();n=n.scale(c*d.h*d.t.getAnimationRatio());l.e(k.subtract(n))}0!==h&&(k=(new Date).getTime(),
k-m<d.m||(m=k,d.t.activeCamera.rotationQuaternion.multiplyInPlace(BABYLON.Quaternion.FromEulerAngles(0,.25*Math.sign(h)*Math.PI,0))));h=c=0;r=!1}})}function g(p){if(D===p.handness)return!1;var C=u[B(p.handness)];w.f(function(){var H=new BABYLON.Ray(new BABYLON.Vector3,new BABYLON.Vector3);C.getWorldPointerRayToRef(H);return H});D=p.handness;return!0}a.d(b,"a",function(){return x});var v=a("9bcR"),y=a("TqLJ"),w=a("ph2Y"),d=a("gqHH"),l=a("vCcv"),f=0,m=0,c=0,h=0,r=!1,u={left:void 0,right:void 0,other:void 0},
D=""},ph2Y:function(G,b,a){function x(c){m=c}function F(){m=function(){return g.t.activeCamera.getForwardRay()}}function B(){var c=1.5*g.a;F();g.t.registerBeforeRender(function(){e();void 0===f?(f.copyFrom(w),v.j(void 0)):10<BABYLON.Vector3.Distance(t.a(),f)&&(f.copyFrom(w),v.j(void 0));g.A.V.position.copyFrom(f);void 0!==v.d&&(g.A.V.isVisible=v.d!==v.h);var h=t.a(),r=q(h).pickedPoint;r&&(d=r,h.y-r.y<c?(y.c.button.isVisible=!1,y.c.L.isVisible=!1):(y.c.button.isVisible=!0,y.c.L.isVisible=!0,window.btn=
y.c));(r=q(f).pickedPoint)&&(l=r)})}function e(c){void 0===c&&(c=!0);var h=m();h=g.t.pickWithRay(h,function(u){return v.c(u)});var r=h.distance;h.hit&&r<g.c?(c&&f.copyFrom(h.pickedPoint),v.j(h.pickedMesh)):(f.copyFrom(w),v.j(void 0))}function q(c){c=new BABYLON.Ray(c,new BABYLON.Vector3(0,-1,0),50);return g.t.pickWithRay(c,function(h){return h.id===g.A.H.id})}a.d(b,"e",function(){return w});a.d(b,"b",function(){return d});a.d(b,"c",function(){return l});a.d(b,"a",function(){return f});a.d(b,"f",function(){return x});
a.d(b,"h",function(){return F});a.d(b,"g",function(){return B});a.d(b,"d",function(){return q});var t=a("vCcv"),g=a("gqHH"),v=a("TqLJ"),y=a("jIpr"),w=new BABYLON.Vector3(-1E3,1E3,1E3),d=new BABYLON.Vector3(0,0,0),l=new BABYLON.Vector3(0,0,0),f=new BABYLON.Vector3(0,0,0),m},qmVJ:function(G,b,a){function x(l){d=l}function F(){return new Promise(function(l){B(l)})}function B(l){y.h(function(){v.g();y.b(d,function(f){v.h();v.b()||(e(f),t.b(q.b));v.i();"nanokid.sdf"===d&&!1===v.b()&&setTimeout(function(){g.b({title:"Load Molecule",
content:"pages/load.html"})},3E3);l()})})}function e(l){var f=l.selectedAtoms({});w={"Atom Name":[],Chain:[],Element:[],"Residue Index":[],"Residue Name":[],"Secondary Structure":[]};var m=f.length;for(l=0;l<m;l++){var c=f[l];w["Atom Name"].push(c.atom);w.Chain.push(c.chain);w.Element.push(c.elem);w["Residue Name"].push(c.resn);w["Residue Index"].push(c.resi);w["Secondary Structure"].push(c.ss)}f=Object.keys(w);m=f.length;for(l=0;l<m;l++){var h=f[l];c=w;var r=h;h=w[h];for(var u={},D=[],p=0,C=h.length;p<
C;++p)u.hasOwnProperty(h[p])||(D.push(h[p]),u[h[p]]=1);c[r]=D}}a.d(b,"a",function(){return w});a.d(b,"b",function(){return d});a.d(b,"c",function(){return x});a.d(b,"d",function(){return F});var q=a("jIpr"),t=a("BjG7"),g=a("iC5T"),v=a("p11u"),y=a("PjGz"),w={},d="nanokid.sdf"},sqbB:function(G,b,a){function x(){var g=e.t.lights[0],v=F();q.c()&&(t=new BABYLON.ShadowGenerator(4096,g),t.useBlurExponentialShadowMap=!0,t.G=!0,t.B=v.blur,t.setDarkness(v.pa))}function F(){var g=e.t.lights[0],v=64,y=.9625,
w=void 0,d=g.name.match(/blur_([0-9\.]+)/g);null!==d&&(v=+d[0].substr(5));d=g.name.match(/dark_([0-9\.]+)/g);null!==d&&(y=+d[0].substr(5));g=g.name.match(/ambient_([0-9\.]+)/g);null!==g&&(w=+g[0].substr(8));return{blur:v,pa:y,oa:w}}function B(){for(var g=e.t.meshes.length,v=0;v<g;v++){var y=e.t.meshes[v];if(-1!==y.name.toLowerCase().indexOf("shadowcatcher")||-1!==y.name.toLowerCase().indexOf("shadow_catcher"))y.material=new BABYLON.ShadowOnlyMaterial("shadow_catch"+v.toString(),e.t),y.material.activeLight=
e.t.lights[0],y.receiveShadows=!0}}a.d(b,"d",function(){return t});a.d(b,"c",function(){return x});a.d(b,"a",function(){return F});a.d(b,"b",function(){return B});var e=a("gqHH"),q=a("p11u"),t},tMjE:function(G,b,a){function x(){F.a("SetupMenus",["LoadBabylonScene","InitVR"],function(t){B.A.ta&&e.d();q.a();t()})}a.d(b,"a",function(){return x});var F=a("VNi4"),B=a("gqHH"),e=a("jIpr"),q=a("fRJN")},uBLq:function(G,b,a){function x(f){d=new Float32Array(B.a().asArray());l=new Float32Array(B.b().asArray());
(new w(function(m){!0===e.a&&console.log("stud1 got data",m);var c=m.val;switch(m.type){case "locrot":d=new Float32Array([c[0],c[1],c[2]]);l=new Float32Array([c[3],c[4],c[5],c[6]]);break;case "initialUrl":-1!==window.location.href.indexOf("nanokid.sdf")&&(m=c+"&f="+y,m=m.replace(/sh=true/g,"sh=false"),top.location.href=m);break;case "toggleRep":t.b(c.filters,c.repName,c.colorScheme,void 0);break;case "molAxisRotation":g.a(c);break;case "molUndoRot":g.c()}})).Ga(f);q.t.registerBeforeRender(function(){var m=
new Float32Array(B.a().asArray());m=F(m,d);m=BABYLON.Vector3.FromArray(m);B.e(m);m=new Float32Array(B.b().asArray());m=F(m,l);m=BABYLON.Quaternion.FromArray(m);B.f(m)})}function F(f,m){for(var c=f.length,h=new Float32Array(c),r=0;r<c;r++)h[r]=m[r]-f[r];m=q.t.getAnimationRatio();var u=new Float32Array(c);for(r=0;r<c;r++)u[r]=f[r]+.02*m*h[r];return u}a.d(b,"a",function(){return x});var B=a("vCcv"),e=a("gg4m"),q=a("gqHH"),t=a("EYe7"),g=a("nKXq"),v=function(){function f(m,c){f=Object.setPrototypeOf||
{__proto__:[]}instanceof Array&&function(h,r){h.__proto__=r}||function(h,r){for(var u in r)r.hasOwnProperty(u)&&(h[u]=r[u])};return f(m,c)}return function(m,c){function h(){this.constructor=m}f(m,c);m.prototype=null===c?Object.create(c):(h.prototype=c.prototype,new h)}}(),y,w=function(f){function m(c){var h=f.call(this)||this;h.O=null;h.Ea=c;h.ja();return h}v(m,f);m.prototype.Ga=function(c){var h=this;this.O&&this.O.close();this.O=this.F.connect(c,{reliable:!0});this.Ha();this.O.on("open",function(){!0===
e.a&&console.log("Connected to: "+h.O.F)});y=c};m.prototype.ja=function(){var c=this;this.F.on("close",function(){c.O=null;e.d()})};m.prototype.Ha=function(){var c=this;this.O.on("data",function(h){!0===e.a&&console.log("Received:",h);c.Ea(h)});this.O.on("close",function(){e.c("Leader connection closed.")})};return m}(e.b),d=null,l=null},vCcv:function(G,b,a){function x(){var d=v.t.activeCamera,l=d.position.clone();if(2===v.A.C||1===v.A.C)d.leftCamera?l.copyFrom(d.leftCamera.globalPosition):console.log("Prob here");
return l}function F(d){if(3===v.A.C){var l=v.t.activeCamera;l.position.copyFrom(d)}else if(2===v.A.C||1===v.A.C)l=v.t.activeCamera,l.position.copyFrom(d.subtract(t()))}function B(){if(2===v.A.C||1===v.A.C){var d=v.z.baseExperience.camera.rotationQuaternion;return 0!==d.x?d:v.t.activeCamera.rotationQuaternion}return v.t.activeCamera.rotationQuaternion}function e(d){2===v.A.C||1===v.A.C?console.log("PROBLEM!"):(v.t.activeCamera.rotationQuaternion=d.clone(),v.t.activeCamera.rotation=v.t.activeCamera.rotationQuaternion.toEulerAngles())}
function q(){if(2===v.A.C||1===v.A.C){var d=g.c.subtract(g.b),l=BABYLON.Vector3.GetAngleBetweenVectors(d,y,w);for(0>d.z&&(l=-l);0>l;)l+=2*Math.PI;for(;l>2*Math.PI;)l-=2*Math.PI;return l+=.5*Math.PI}return v.t.activeCamera.rotation.clone().y}function t(){if(3===v.A.C)return new BABYLON.Vector3(0,0,0);var d=v.t.activeCamera,l;d.leftCamera?l=d.leftCamera.globalPosition.subtract(d.position):l=new BABYLON.Vector3(0,0,0);return l}a.d(b,"a",function(){return x});a.d(b,"e",function(){return F});a.d(b,"b",
function(){return B});a.d(b,"f",function(){return e});a.d(b,"c",function(){return q});a.d(b,"d",function(){return t});var g=a("ph2Y"),v=a("gqHH"),y=new BABYLON.Vector3(1,0,0),w=new BABYLON.Vector3(1,0,0)},vMIs:function(G,b,a){function x(){BABYLON.SceneLoader.ImportMeshAsync(null,"environs/arrow/","arrow.babylon",F.t).then(function(e){var q=e.meshes[0];q.scaling=new BABYLON.Vector3(.2,.2,.2);e=new BABYLON.StandardMaterial("arrowMat",F.t);e.diffuseColor=new BABYLON.Color3(.3,.35,.4);e.specularColor=
new BABYLON.Color3(0,0,0);e.emissiveColor=new BABYLON.Color3(.3,.35,.4);q.material=e;var t=null;F.t.registerBeforeRender(function(){if(null===t&&(t=F.t.getMeshByName("protein_box"),null===t))return;q.position=B.b;q.lookAt(t.position)})})}a.d(b,"a",function(){return x});var F=a("gqHH"),B=a("ph2Y")}},[["/7QA",1,2]]]);}).call(this || window)
